var Uc=Object.defineProperty;var qc=(t,e,n)=>e in t?Uc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var eo=(t,e,n)=>(qc(t,typeof e!="symbol"?e+"":e,n),n),Ns=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var E=(t,e,n)=>(Ns(t,e,"read from private field"),n?n.call(t):e.get(t)),k=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},D=(t,e,n,r)=>(Ns(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var to=(t,e,n,r)=>({set _(s){D(t,e,s,n)},get _(){return E(t,e,r)}}),oe=(t,e,n)=>(Ns(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Rs;const Xr=window,qn=Xr.trustedTypes,no=qn?qn.createPolicy("lit-html",{createHTML:t=>t}):void 0,ei="$lit$",At=`lit$${(Math.random()+"").slice(9)}$`,ea="?"+At,Mc=`<${ea}>`,Wt=document,tr=()=>Wt.createComment(""),nr=t=>t===null||typeof t!="object"&&typeof t!="function",ta=Array.isArray,Pc=t=>ta(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",Us=`[ 	
\f\r]`,Kn=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,ro=/-->/g,so=/>/g,Vt=RegExp(`>|${Us}(?:([^\\s"'>=/]+)(${Us}*=${Us}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),io=/'/g,oo=/"/g,na=/^(?:script|style|textarea|title)$/i,Dc=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),Lc=Dc(1),rr=Symbol.for("lit-noChange"),he=Symbol.for("lit-nothing"),ao=new WeakMap,Ft=Wt.createTreeWalker(Wt,129,null,!1);function ra(t,e){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return no!==void 0?no.createHTML(e):e}const Vc=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":"",o=Kn;for(let c=0;c<n;c++){const a=t[c];let u,l,d=-1,f=0;for(;f<a.length&&(o.lastIndex=f,l=o.exec(a),l!==null);)f=o.lastIndex,o===Kn?l[1]==="!--"?o=ro:l[1]!==void 0?o=so:l[2]!==void 0?(na.test(l[2])&&(s=RegExp("</"+l[2],"g")),o=Vt):l[3]!==void 0&&(o=Vt):o===Vt?l[0]===">"?(o=s??Kn,d=-1):l[1]===void 0?d=-2:(d=o.lastIndex-l[2].length,u=l[1],o=l[3]===void 0?Vt:l[3]==='"'?oo:io):o===oo||o===io?o=Vt:o===ro||o===so?o=Kn:(o=Vt,s=void 0);const h=o===Vt&&t[c+1].startsWith("/>")?" ":"";i+=o===Kn?a+Mc:d>=0?(r.push(u),a.slice(0,d)+ei+a.slice(d)+At+h):a+At+(d===-2?(r.push(void 0),c):h)}return[ra(t,i+(t[n]||"<?>")+(e===2?"</svg>":"")),r]};let ti=class sa{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const c=e.length-1,a=this.parts,[u,l]=Vc(e,n);if(this.el=sa.createElement(u,r),Ft.currentNode=this.el.content,n===2){const d=this.el.content,f=d.firstChild;f.remove(),d.append(...f.childNodes)}for(;(s=Ft.nextNode())!==null&&a.length<c;){if(s.nodeType===1){if(s.hasAttributes()){const d=[];for(const f of s.getAttributeNames())if(f.endsWith(ei)||f.startsWith(At)){const h=l[o++];if(d.push(f),h!==void 0){const y=s.getAttribute(h.toLowerCase()+ei).split(At),b=/([.?@])?(.*)/.exec(h);a.push({type:1,index:i,name:b[2],strings:y,ctor:b[1]==="."?jc:b[1]==="?"?Hc:b[1]==="@"?Gc:ms})}else a.push({type:6,index:i})}for(const f of d)s.removeAttribute(f)}if(na.test(s.tagName)){const d=s.textContent.split(At),f=d.length-1;if(f>0){s.textContent=qn?qn.emptyScript:"";for(let h=0;h<f;h++)s.append(d[h],tr()),Ft.nextNode(),a.push({type:2,index:++i});s.append(d[f],tr())}}}else if(s.nodeType===8)if(s.data===ea)a.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(At,d+1))!==-1;)a.push({type:7,index:i}),d+=At.length-1}i++}}static createElement(e,n){const r=Wt.createElement("template");return r.innerHTML=e,r}};function Mn(t,e,n=t,r){var s,i,o,c;if(e===rr)return e;let a=r!==void 0?(s=n._$Co)===null||s===void 0?void 0:s[r]:n._$Cl;const u=nr(e)?void 0:e._$litDirective$;return(a==null?void 0:a.constructor)!==u&&((i=a==null?void 0:a._$AO)===null||i===void 0||i.call(a,!1),u===void 0?a=void 0:(a=new u(t),a._$AT(t,n,r)),r!==void 0?((o=(c=n)._$Co)!==null&&o!==void 0?o:c._$Co=[])[r]=a:n._$Cl=a),a!==void 0&&(e=Mn(t,a._$AS(t,e.values),a,r)),e}let kc=class{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var n;const{el:{content:r},parts:s}=this._$AD,i=((n=e==null?void 0:e.creationScope)!==null&&n!==void 0?n:Wt).importNode(r,!0);Ft.currentNode=i;let o=Ft.nextNode(),c=0,a=0,u=s[0];for(;u!==void 0;){if(c===u.index){let l;u.type===2?l=new wi(o,o.nextSibling,this,e):u.type===1?l=new u.ctor(o,u.name,u.strings,this,e):u.type===6&&(l=new Zc(o,this,e)),this._$AV.push(l),u=s[++a]}c!==(u==null?void 0:u.index)&&(o=Ft.nextNode(),c++)}return Ft.currentNode=Wt,i}v(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}},wi=class ia{constructor(e,n,r,s){var i;this.type=2,this._$AH=he,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cp=(i=s==null?void 0:s.isConnected)===null||i===void 0||i}get _$AU(){var e,n;return(n=(e=this._$AM)===null||e===void 0?void 0:e._$AU)!==null&&n!==void 0?n:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=Mn(this,e,n),nr(e)?e===he||e==null||e===""?(this._$AH!==he&&this._$AR(),this._$AH=he):e!==this._$AH&&e!==rr&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):Pc(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==he&&nr(this._$AH)?this._$AA.nextSibling.data=e:this.$(Wt.createTextNode(e)),this._$AH=e}g(e){var n;const{values:r,_$litType$:s}=e,i=typeof s=="number"?this._$AC(e):(s.el===void 0&&(s.el=ti.createElement(ra(s.h,s.h[0]),this.options)),s);if(((n=this._$AH)===null||n===void 0?void 0:n._$AD)===i)this._$AH.v(r);else{const o=new kc(i,this),c=o.u(this.options);o.v(r),this.$(c),this._$AH=o}}_$AC(e){let n=ao.get(e.strings);return n===void 0&&ao.set(e.strings,n=new ti(e)),n}T(e){ta(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new ia(this.k(tr()),this.k(tr()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){var r;for((r=this._$AP)===null||r===void 0||r.call(this,!1,!0,n);e&&e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var n;this._$AM===void 0&&(this._$Cp=e,(n=this._$AP)===null||n===void 0||n.call(this,e))}},ms=class{constructor(e,n,r,s,i){this.type=1,this._$AH=he,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=he}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=Mn(this,e,n,0),o=!nr(e)||e!==this._$AH&&e!==rr,o&&(this._$AH=e);else{const c=e;let a,u;for(e=i[0],a=0;a<i.length-1;a++)u=Mn(this,c[r+a],n,a),u===rr&&(u=this._$AH[a]),o||(o=!nr(u)||u!==this._$AH[a]),u===he?e=he:e!==he&&(e+=(u??"")+i[a+1]),this._$AH[a]=u}o&&!s&&this.j(e)}j(e){e===he?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},jc=class extends ms{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===he?void 0:e}};const Fc=qn?qn.emptyScript:"";let Hc=class extends ms{constructor(){super(...arguments),this.type=4}j(e){e&&e!==he?this.element.setAttribute(this.name,Fc):this.element.removeAttribute(this.name)}},Gc=class extends ms{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){var r;if((e=(r=Mn(this,e,n,0))!==null&&r!==void 0?r:he)===rr)return;const s=this._$AH,i=e===he&&s!==he||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,o=e!==he&&(s===he||i);i&&this.element.removeEventListener(this.name,this,s),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var n,r;typeof this._$AH=="function"?this._$AH.call((r=(n=this.options)===null||n===void 0?void 0:n.host)!==null&&r!==void 0?r:this.element,e):this._$AH.handleEvent(e)}},Zc=class{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Mn(this,e)}};const co=Xr.litHtmlPolyfillSupport;co==null||co(ti,wi),((Rs=Xr.litHtmlVersions)!==null&&Rs!==void 0?Rs:Xr.litHtmlVersions=[]).push("2.8.0");const Kc=(t,e,n)=>{var r,s;const i=(r=n==null?void 0:n.renderBefore)!==null&&r!==void 0?r:e;let o=i._$litPart$;if(o===void 0){const c=(s=n==null?void 0:n.renderBefore)!==null&&s!==void 0?s:null;i._$litPart$=o=new wi(e.insertBefore(tr(),c),c,void 0,n??{})}return o._$AI(t),o};var fo;(function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"})(fo||(fo={}));var Pn;(function(t){t.Replied="replied",t.Rejected="rejected"})(Pn||(Pn={}));function Yc(t){return t!=null&&"reject_code"in t}function zc(t){return t!=null&&"certificate"in t}const Wr="abcdefghijklmnopqrstuvwxyz234567",Dn=Object.create(null);for(let t=0;t<Wr.length;t++)Dn[Wr[t]]=t;Dn[0]=Dn.o;Dn[1]=Dn.i;function Xc(t){let e=0,n=0,r="";function s(i){return e<0?n|=i>>-e:n=i<<e&248,e>3?(e-=8,1):(e<4&&(r+=Wr[n>>3],e+=5),0)}for(let i=0;i<t.length;)i+=s(t[i]);return r+(e<0?Wr[n>>3]:"")}function Wc(t){let e=0,n=0;const r=new Uint8Array(t.length*4/3|0);let s=0;function i(o){let c=Dn[o.toLowerCase()];if(c===void 0)throw new Error(`Invalid character: ${JSON.stringify(o)}`);c<<=3,n|=c>>>e,e+=5,e>=8&&(r[s++]=n,e-=8,e>0?n=c<<5-e&255:n=0)}for(const o of t)i(o);return r.slice(0,s)}const Qc=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Jc(t){let e=-1;for(let n=0;n<t.length;n++){const s=(t[n]^e)&255;e=Qc[s]^e>>>8}return(e^-1)>>>0}const fn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Or(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ef(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Pe(t,...e){if(!Or(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function uo(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function tf(t,e){Pe(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function sr(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function qs(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function We(t,e){return t<<32-e|t>>>e}const oa=(()=>typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function")(),nf=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function J(t){if(Pe(t),oa)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=nf[t[n]];return e}const st={_0:48,_9:57,A:65,F:70,a:97,f:102};function lo(t){if(t>=st._0&&t<=st._9)return t-st._0;if(t>=st.A&&t<=st.F)return t-(st.A-10);if(t>=st.a&&t<=st.f)return t-(st.a-10)}function $r(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(oa)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=lo(t.charCodeAt(i)),c=lo(t.charCodeAt(i+1));if(o===void 0||c===void 0){const a=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+i)}r[s]=o*16+c}return r}function ne(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function aa(t){return typeof t=="string"&&(t=ne(t)),Pe(t),t}function z(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Pe(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}class rf{}function xi(t){const e=r=>t().update(aa(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function ca(t=32){if(fn&&typeof fn.getRandomValues=="function")return fn.getRandomValues(new Uint8Array(t));if(fn&&typeof fn.randomBytes=="function")return Uint8Array.from(fn.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function sf(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),c=Number(n&i),a=r?4:0,u=r?0:4;t.setUint32(e+a,o,r),t.setUint32(e+u,c,r)}function of(t,e,n){return t&e^~t&n}function af(t,e,n){return t&e^t&n^e&n}class fa extends rf{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=qs(this.buffer)}update(e){uo(this),e=aa(e),Pe(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const c=Math.min(s-this.pos,i-o);if(c===s){const a=qs(e);for(;s<=i-o;o+=s)this.process(a,o);continue}r.set(e.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){uo(this),tf(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,sr(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;sf(r,s-8,BigInt(this.length*8),i),this.process(r,0);const c=qs(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=a/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)c.setUint32(4*d,l[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:c}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=c,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const pt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),mt=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),we=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Pr=BigInt(2**32-1),ho=BigInt(32);function cf(t,e=!1){return e?{h:Number(t&Pr),l:Number(t>>ho&Pr)}:{h:Number(t>>ho&Pr)|0,l:Number(t&Pr)|0}}function ff(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:c}=cf(t[i],e);[r[i],s[i]]=[o,c]}return[r,s]}const yo=(t,e,n)=>t>>>n,bo=(t,e,n)=>t<<32-n|e>>>n,un=(t,e,n)=>t>>>n|e<<32-n,dn=(t,e,n)=>t<<32-n|e>>>n,Dr=(t,e,n)=>t<<64-n|e>>>n-32,Lr=(t,e,n)=>t>>>n-32|e<<64-n;function it(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const uf=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),df=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,lf=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),hf=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,yf=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),bf=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,pf=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gt=new Uint32Array(64);class ua extends fa{constructor(e=32){super(64,e,8,!1),this.A=pt[0]|0,this.B=pt[1]|0,this.C=pt[2]|0,this.D=pt[3]|0,this.E=pt[4]|0,this.F=pt[5]|0,this.G=pt[6]|0,this.H=pt[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:c,H:a}=this;return[e,n,r,s,i,o,c,a]}set(e,n,r,s,i,o,c,a){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=c|0,this.H=a|0}process(e,n){for(let d=0;d<16;d++,n+=4)gt[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const f=gt[d-15],h=gt[d-2],y=We(f,7)^We(f,18)^f>>>3,b=We(h,17)^We(h,19)^h>>>10;gt[d]=b+gt[d-7]+y+gt[d-16]|0}let{A:r,B:s,C:i,D:o,E:c,F:a,G:u,H:l}=this;for(let d=0;d<64;d++){const f=We(c,6)^We(c,11)^We(c,25),h=l+f+of(c,a,u)+pf[d]+gt[d]|0,b=(We(r,2)^We(r,13)^We(r,22))+af(r,s,i)|0;l=u,u=a,a=c,c=o+h|0,o=i,i=s,s=r,r=h+b|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,c=c+this.E|0,a=a+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(r,s,i,o,c,a,u,l)}roundClean(){sr(gt)}destroy(){this.set(0,0,0,0,0,0,0,0),sr(this.buffer)}}class mf extends ua{constructor(){super(28),this.A=mt[0]|0,this.B=mt[1]|0,this.C=mt[2]|0,this.D=mt[3]|0,this.E=mt[4]|0,this.F=mt[5]|0,this.G=mt[6]|0,this.H=mt[7]|0}}const da=(()=>ff(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),gf=(()=>da[0])(),wf=(()=>da[1])(),wt=new Uint32Array(80),xt=new Uint32Array(80);class xf extends fa{constructor(e=64){super(128,e,16,!1),this.Ah=we[0]|0,this.Al=we[1]|0,this.Bh=we[2]|0,this.Bl=we[3]|0,this.Ch=we[4]|0,this.Cl=we[5]|0,this.Dh=we[6]|0,this.Dl=we[7]|0,this.Eh=we[8]|0,this.El=we[9]|0,this.Fh=we[10]|0,this.Fl=we[11]|0,this.Gh=we[12]|0,this.Gl=we[13]|0,this.Hh=we[14]|0,this.Hl=we[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:c,Dl:a,Eh:u,El:l,Fh:d,Fl:f,Gh:h,Gl:y,Hh:b,Hl:g}=this;return[e,n,r,s,i,o,c,a,u,l,d,f,h,y,b,g]}set(e,n,r,s,i,o,c,a,u,l,d,f,h,y,b,g){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=c|0,this.Dl=a|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=f|0,this.Gh=h|0,this.Gl=y|0,this.Hh=b|0,this.Hl=g|0}process(e,n){for(let m=0;m<16;m++,n+=4)wt[m]=e.getUint32(n),xt[m]=e.getUint32(n+=4);for(let m=16;m<80;m++){const v=wt[m-15]|0,A=xt[m-15]|0,T=un(v,A,1)^un(v,A,8)^yo(v,A,7),S=dn(v,A,1)^dn(v,A,8)^bo(v,A,7),R=wt[m-2]|0,w=xt[m-2]|0,B=un(R,w,19)^Dr(R,w,61)^yo(R,w,6),U=dn(R,w,19)^Lr(R,w,61)^bo(R,w,6),C=lf(S,U,xt[m-7],xt[m-16]),x=hf(C,T,B,wt[m-7],wt[m-16]);wt[m]=x|0,xt[m]=C|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:c,Cl:a,Dh:u,Dl:l,Eh:d,El:f,Fh:h,Fl:y,Gh:b,Gl:g,Hh:p,Hl:_}=this;for(let m=0;m<80;m++){const v=un(d,f,14)^un(d,f,18)^Dr(d,f,41),A=dn(d,f,14)^dn(d,f,18)^Lr(d,f,41),T=d&h^~d&b,S=f&y^~f&g,R=yf(_,A,S,wf[m],xt[m]),w=bf(R,p,v,T,gf[m],wt[m]),B=R|0,U=un(r,s,28)^Dr(r,s,34)^Dr(r,s,39),C=dn(r,s,28)^Lr(r,s,34)^Lr(r,s,39),x=r&i^r&c^i&c,I=s&o^s&a^o&a;p=b|0,_=g|0,b=h|0,g=y|0,h=d|0,y=f|0,{h:d,l:f}=it(u|0,l|0,w|0,B|0),u=c|0,l=a|0,c=i|0,a=o|0,i=r|0,o=s|0;const $=uf(B,C,I);r=df($,w,U,x),s=$|0}({h:r,l:s}=it(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=it(this.Bh|0,this.Bl|0,i|0,o|0),{h:c,l:a}=it(this.Ch|0,this.Cl|0,c|0,a|0),{h:u,l}=it(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:f}=it(this.Eh|0,this.El|0,d|0,f|0),{h,l:y}=it(this.Fh|0,this.Fl|0,h|0,y|0),{h:b,l:g}=it(this.Gh|0,this.Gl|0,b|0,g|0),{h:p,l:_}=it(this.Hh|0,this.Hl|0,p|0,_|0),this.set(r,s,i,o,c,a,u,l,d,f,h,y,b,g,p,_)}roundClean(){sr(wt,xt)}destroy(){sr(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Oe=xi(()=>new ua),_f=xi(()=>new mf),Ef=xi(()=>new xf),Vr="__principal__",vf=2,po=4,If="aaaaa-aa";let X=class hn{static anonymous(){return new this(new Uint8Array([po]))}static managementCanister(){return this.fromText(If)}static selfAuthenticating(e){const n=_f(e);return new this(new Uint8Array([...n,vf]))}static from(e){if(typeof e=="string")return hn.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new hn(e);if(hn.isPrincipal(e))return new hn(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(e){return new this($r(e))}static fromText(e){let n=e;if(e.includes(Vr)){const o=JSON.parse(e);Vr in o&&(n=o[Vr])}const r=n.toLowerCase().replace(/-/g,"");let s=Wc(r);s=s.slice(4,s.length);const i=new this(s);if(i.toText()!==n)throw new Error(`Principal "${i.toText()}" does not have a valid checksum (original value "${n}" may not be a valid Principal ID).`);return i}static fromUint8Array(e){return new this(e)}static isPrincipal(e){return e instanceof hn||typeof e=="object"&&e!==null&&"_isPrincipal"in e&&e._isPrincipal===!0&&"_arr"in e&&e._arr instanceof Uint8Array}constructor(e){this._arr=e,this._isPrincipal=!0}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===po}toUint8Array(){return this._arr}toHex(){return J(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,Jc(this._arr));const r=new Uint8Array(e),s=new Uint8Array([...r,...this._arr]),o=Xc(s).match(/.{1,5}/g);if(!o)throw new Error;return o.join("-")}toString(){return this.toText()}toJSON(){return{[Vr]:this.toText()}}compareTo(e){for(let n=0;n<Math.min(this._arr.length,e._arr.length);n++){if(this._arr[n]<e._arr[n])return"lt";if(this._arr[n]>e._arr[n])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const n=this.compareTo(e);return n=="lt"||n=="eq"}gtEq(e){const n=this.compareTo(e);return n=="gt"||n=="eq"}};var ht;(function(t){t.Trust="Trust",t.Protocol="Protocol",t.Reject="Reject",t.Transport="Transport",t.External="External",t.Limit="Limit",t.Input="Input",t.Unknown="Unknown"})(ht||(ht={}));class G{constructor(e=!1){this.isCertified=e}toString(){let e=this.toErrorMessage();return this.requestContext&&(e+=`
Request context:
  Request ID (hex): ${this.requestContext.requestId?J(this.requestContext.requestId):"undefined"}
  Sender pubkey (hex): ${J(this.requestContext.senderPubKey)}
  Sender signature (hex): ${J(this.requestContext.senderSignature)}
  Ingress expiry: ${this.requestContext.ingressExpiry.toString()}`),this.callContext&&(e+=`
Call context:
  Canister ID: ${this.callContext.canisterId.toText()}
  Method name: ${this.callContext.methodName}
  HTTP details: ${JSON.stringify(this.callContext.httpDetails,null,2)}`),e}}class ut extends Error{get code(){return this.cause.code}set code(e){this.cause.code=e}get kind(){return this.cause.kind}set kind(e){this.cause.kind=e}get isCertified(){return this.code.isCertified}constructor(e,n){super(e.toString()),this.name="AgentError",this.cause={code:e,kind:n},Object.setPrototypeOf(this,ut.prototype)}hasCode(e){return this.code instanceof e}toString(){return`${this.name} (${this.kind}): ${this.message}`}}class rn extends ut{static fromCode(e){return new this(e)}}class qe extends rn{constructor(e){super(e,ht.Trust),this.name="TrustError",Object.setPrototypeOf(this,qe.prototype)}}class re extends rn{constructor(e){super(e,ht.Protocol),this.name="ProtocolError",Object.setPrototypeOf(this,re.prototype)}}class xn extends rn{constructor(e){super(e,ht.Reject),this.name="RejectError",Object.setPrototypeOf(this,xn.prototype)}}class Qr extends rn{constructor(e){super(e,ht.Transport),this.name="TransportError",Object.setPrototypeOf(this,Qr.prototype)}}class Ae extends rn{constructor(e){super(e,ht.External),this.name="ExternalError",Object.setPrototypeOf(this,Ae.prototype)}}class Q extends rn{constructor(e){super(e,ht.Input),this.name="InputError",Object.setPrototypeOf(this,Q.prototype)}}class Be extends rn{constructor(e){super(e,ht.Unknown),this.name="UnknownError",Object.setPrototypeOf(this,Be.prototype)}}class _n extends G{constructor(e,n){super(),this.reason=e,this.error=n,this.name="CertificateVerificationErrorCode",Object.setPrototypeOf(this,_n.prototype)}toErrorMessage(){let e=this.reason;return this.error&&(e+=`: ${Rr(this.error)}`),`Certificate verification error: "${e}"`}}class ir extends G{constructor(e,n,r,s,i){super(),this.maxAgeInMinutes=e,this.certificateTime=n,this.currentTime=r,this.timeDiffMsecs=s,this.ageType=i,this.name="CertificateTimeErrorCode",Object.setPrototypeOf(this,ir.prototype)}toErrorMessage(){return`Certificate is signed more than ${this.maxAgeInMinutes} minutes in the ${this.ageType}. Certificate time: ${this.certificateTime.toISOString()} Current time: ${this.currentTime.toISOString()} Clock drift: ${this.timeDiffMsecs}ms`}}class _i extends G{constructor(){super(),this.name="CertificateHasTooManyDelegationsErrorCode",Object.setPrototypeOf(this,_i.prototype)}toErrorMessage(){return"Certificate has too many delegations"}}class gs extends G{constructor(e,n){super(),this.canisterId=e,this.subnetId=n,this.name="CertificateNotAuthorizedErrorCode",Object.setPrototypeOf(this,gs.prototype)}toErrorMessage(){return`The certificate contains a delegation that does not include the canister ${this.canisterId.toText()} in the canister_ranges field. Subnet ID: ${this.subnetId.toText()}`}}class Ln extends G{constructor(e,n){super(),this.message=e,this.lookupStatus=n,this.name="LookupErrorCode",Object.setPrototypeOf(this,Ln.prototype)}toErrorMessage(){return`${this.message}. Lookup status: ${this.lookupStatus}`}}class ws extends G{constructor(e){super(),this.message=e,this.name="MalformedLookupFoundValueErrorCode",Object.setPrototypeOf(this,ws.prototype)}toErrorMessage(){return this.message}}class Ei extends G{constructor(e){super(),this.message=e,this.name="MissingLookupValueErrorCode",Object.setPrototypeOf(this,Ei.prototype)}toErrorMessage(){return this.message}}class xs extends G{constructor(e,n){super(),this.expectedLength=e,this.actualLength=n,this.name="DerKeyLengthMismatchErrorCode",Object.setPrototypeOf(this,xs.prototype)}toErrorMessage(){return`BLS DER-encoded public key must be ${this.expectedLength} bytes long, but is ${this.actualLength} bytes long`}}class vi extends G{constructor(e,n){super(),this.expectedPrefix=e,this.actualPrefix=n,this.name="DerPrefixMismatchErrorCode",Object.setPrototypeOf(this,vi.prototype)}toErrorMessage(){return`BLS DER-encoded public key is invalid. Expected the following prefix: ${J(this.expectedPrefix)}, but got ${J(this.actualPrefix)}`}}class Ii extends G{constructor(e,n){super(),this.expectedLength=e,this.actualLength=n,this.name="DerDecodeLengthMismatchErrorCode",Object.setPrototypeOf(this,Ii.prototype)}toErrorMessage(){return`DER payload mismatch: Expected length ${this.expectedLength}, actual length: ${this.actualLength}`}}class yt extends G{constructor(e){super(),this.error=e,this.name="DerDecodeErrorCode",Object.setPrototypeOf(this,yt.prototype)}toErrorMessage(){return`Failed to decode DER: ${this.error}`}}class _s extends G{constructor(e){super(),this.error=e,this.name="DerEncodeErrorCode",Object.setPrototypeOf(this,_s.prototype)}toErrorMessage(){return`Failed to encode DER: ${this.error}`}}class Ai extends G{constructor(e,n){super(),this.error=e,this.input=n,this.name="CborDecodeErrorCode",Object.setPrototypeOf(this,Ai.prototype)}toErrorMessage(){return`Failed to decode CBOR: ${Rr(this.error)}, input: ${J(this.input)}`}}class Bi extends G{constructor(e,n){super(),this.error=e,this.value=n,this.name="CborEncodeErrorCode",Object.setPrototypeOf(this,Bi.prototype)}toErrorMessage(){return`Failed to encode CBOR: ${Rr(this.error)}, input: ${this.value}`}}class or extends G{constructor(e,n,r){super(),this.message=e,this.requestId=n,this.status=r,this.name="TimeoutWaitingForResponseErrorCode",Object.setPrototypeOf(this,or.prototype)}toErrorMessage(){let e=`${this.message}
`;return this.requestId&&(e+=`  Request ID: ${J(this.requestId)}
`),this.status&&(e+=`  Request status: ${this.status}
`),e}}class Ti extends G{constructor(e,n,r){super(),this.maxIngressExpiryInMinutes=e,this.requestId=n,this.retryTimes=r,this.name="CertificateOutdatedErrorCode",Object.setPrototypeOf(this,Ti.prototype)}toErrorMessage(){let e=`Certificate is stale (over ${this.maxIngressExpiryInMinutes} minutes). Is the computer's clock synchronized?
  Request ID: ${J(this.requestId)}
`;return this.retryTimes!==void 0&&(e+=`  Retried ${this.retryTimes} times.`),e}}class Es extends G{constructor(e,n,r,s){super(!0),this.requestId=e,this.rejectCode=n,this.rejectMessage=r,this.rejectErrorCode=s,this.name="CertifiedRejectErrorCode",Object.setPrototypeOf(this,Es.prototype)}toErrorMessage(){return`The replica returned a rejection error:
  Request ID: ${J(this.requestId)}
  Reject code: ${this.rejectCode}
  Reject text: ${this.rejectMessage}
  Error code: ${this.rejectErrorCode}
`}}class Si extends G{constructor(e,n,r,s,i){super(),this.requestId=e,this.rejectCode=n,this.rejectMessage=r,this.rejectErrorCode=s,this.signatures=i,this.name="UncertifiedRejectErrorCode",Object.setPrototypeOf(this,Si.prototype)}toErrorMessage(){return`The replica returned a rejection error:
  Request ID: ${J(this.requestId)}
  Reject code: ${this.rejectCode}
  Reject text: ${this.rejectMessage}
  Error code: ${this.rejectErrorCode}
`}}class Ci extends G{constructor(e,n,r,s){super(),this.requestId=e,this.rejectCode=n,this.rejectMessage=r,this.rejectErrorCode=s,this.name="UncertifiedRejectUpdateErrorCode",Object.setPrototypeOf(this,Ci.prototype)}toErrorMessage(){return`The replica returned a rejection error:
  Request ID: ${J(this.requestId)}
  Reject code: ${this.rejectCode}
  Reject text: ${this.rejectMessage}
  Error code: ${this.rejectErrorCode}
`}}class Oi extends G{constructor(e){super(),this.requestId=e,this.name="RequestStatusDoneNoReplyErrorCode",Object.setPrototypeOf(this,Oi.prototype)}toErrorMessage(){return`Call was marked as done but we never saw the reply:
  Request ID: ${J(this.requestId)}
`}}class Fn extends G{constructor(e){super(),this.shouldFetchRootKey=e,this.name="MissingRootKeyErrorCode",Object.setPrototypeOf(this,Fn.prototype)}toErrorMessage(){return this.shouldFetchRootKey===void 0?"Agent is missing root key":`Agent is missing root key and the shouldFetchRootKey value is set to ${this.shouldFetchRootKey}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`}}class $i extends G{constructor(e){super(),this.value=e,this.name="HashValueErrorCode",Object.setPrototypeOf(this,$i.prototype)}toErrorMessage(){return`Attempt to hash a value of unsupported type: ${this.value}`}}class Qn extends G{constructor(e){super(),this.error=e,this.name="HttpDefaultFetchErrorCode",Object.setPrototypeOf(this,Qn.prototype)}toErrorMessage(){return this.error}}class kt extends G{constructor(){super(),this.name="IdentityInvalidErrorCode",Object.setPrototypeOf(this,kt.prototype)}toErrorMessage(){return"This identity has expired due this application's security policy. Please refresh your authentication."}}class pn extends G{constructor(e,n){super(),this.message=e,this.providedIngressExpiryInMinutes=n,this.name="IngressExpiryInvalidErrorCode",Object.setPrototypeOf(this,pn.prototype)}toErrorMessage(){return`${this.message}. Provided ingress expiry time is ${this.providedIngressExpiryInMinutes} minutes.`}}class Ni extends G{constructor(){super(),this.name="CreateHttpAgentErrorCode",Object.setPrototypeOf(this,Ni.prototype)}toErrorMessage(){return"Failed to create agent from provided agent"}}class Ri extends G{constructor(e){super(),this.error=e,this.name="MalformedSignatureErrorCode",Object.setPrototypeOf(this,Ri.prototype)}toErrorMessage(){return`Query response contained a malformed signature: ${this.error}`}}class Ui extends G{constructor(){super(),this.name="MissingSignatureErrorCode",Object.setPrototypeOf(this,Ui.prototype)}toErrorMessage(){return"Query response did not contain any node signatures"}}class qi extends G{constructor(){super(),this.name="MalformedPublicKeyErrorCode",Object.setPrototypeOf(this,qi.prototype)}toErrorMessage(){return"Read state response contained a malformed public key"}}class Mi extends G{constructor(e){super(),this.nodeId=e,this.name="QuerySignatureVerificationFailedErrorCode",Object.setPrototypeOf(this,Mi.prototype)}toErrorMessage(){return`Query signature verification failed. Node ID: ${this.nodeId}`}}class Ke extends G{constructor(e){super(),this.error=e,this.name="UnexpectedErrorCode",Object.setPrototypeOf(this,Ke.prototype)}toErrorMessage(){return`Unexpected error: ${Rr(this.error)}`}}class Nr extends G{constructor(e){super(),this.error=e,this.name="HashTreeDecodeErrorCode",Object.setPrototypeOf(this,Nr.prototype)}toErrorMessage(){return`Failed to decode certificate: ${this.error}`}}class Jr extends G{constructor(e,n,r,s){super(),this.status=e,this.statusText=n,this.headers=r,this.bodyText=s,this.name="HttpErrorCode",Object.setPrototypeOf(this,Jr.prototype)}toErrorMessage(){let e=`HTTP request failed:
  Status: ${this.status} (${this.statusText})
  Headers: ${JSON.stringify(this.headers)}
`;return this.bodyText&&(e+=`  Body: ${this.bodyText}
`),e}}class es extends G{constructor(){super(),this.name="HttpV3ApiNotSupportedErrorCode",Object.setPrototypeOf(this,es.prototype)}toErrorMessage(){return"HTTP request failed: v3 API is not supported"}}class ts extends G{constructor(e){super(),this.error=e,this.name="HttpFetchErrorCode",Object.setPrototypeOf(this,ts.prototype)}toErrorMessage(){return`Failed to fetch HTTP request: ${Rr(this.error)}`}}class ns extends G{constructor(e){super(),this.receivedCanisterId=e,this.name="MissingCanisterIdErrorCode",Object.setPrototypeOf(this,ns.prototype)}toErrorMessage(){return`Canister ID is required, but received ${typeof this.receivedCanisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`}}class Pi extends G{constructor(e){super(),this.request=e,this.name="InvalidReadStateRequestErrorCode",Object.setPrototypeOf(this,Pi.prototype)}toErrorMessage(){return`Invalid read state request: ${this.request}`}}class rs extends G{constructor(e){super(),this.error=e,this.name="ExpiryJsonDeserializeErrorCode",Object.setPrototypeOf(this,rs.prototype)}toErrorMessage(){return`Failed to deserialize expiry: ${this.error}`}}function Rr(t){if(t instanceof Error)return t.stack??t.message;try{return JSON.stringify(t)}catch{return String(t)}}const En=new Error("unreachable");function Y(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.byteLength,0));let n=0;for(const r of t)e.set(r,n),n+=r.byteLength;return e}class Hn{save(){return this._view}restore(e){if(!(e instanceof Uint8Array))throw new Error("Checkpoint must be a Uint8Array");this._view=e}constructor(e,n=(e==null?void 0:e.byteLength)||0){if(e&&!(e instanceof Uint8Array))try{e=la(e)}catch{throw new Error("Buffer must be a Uint8Array")}if(n<0||!Number.isInteger(n))throw new Error("Length must be a non-negative integer");if(e&&n>e.byteLength)throw new Error("Length cannot exceed buffer length");this._buffer=e||new Uint8Array(0),this._view=new Uint8Array(this._buffer.buffer,0,n)}get buffer(){return this._view.slice()}get byteLength(){return this._view.byteLength}read(e){const n=this._view.subarray(0,e);return this._view=this._view.subarray(e),n.slice()}readUint8(){if(this._view.byteLength===0)return;const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){if(!(e instanceof Uint8Array))throw new Error("Buffer must be a Uint8Array");const n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+e.byteLength>=this._buffer.byteLength?this.alloc(e.byteLength):this._view=new Uint8Array(this._buffer.buffer,this._view.byteOffset,this._view.byteLength+e.byteLength),this._view.set(e,n)}get end(){return this._view.byteLength===0}alloc(e){if(e<=0||!Number.isInteger(e))throw new Error("Amount must be a positive integer");const n=new Uint8Array((this._buffer.byteLength+e)*1.2|0),r=new Uint8Array(n.buffer,0,this._view.byteLength+e);r.set(this._view),this._buffer=n,this._view=r}}function la(t){if(!t)throw new Error("Input cannot be null or undefined");return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):Array.isArray(t)?new Uint8Array(t):"buffer"in t?la(t.buffer):new Uint8Array(t)}function Af(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return t[n]-e[n];return 0}function Bf(t){if(!(t instanceof Uint8Array))throw new Error("Input must be a Uint8Array");return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Tf(t){const n=new TextEncoder().encode(t);let r=0;for(const s of n)r=(r*223+s)%2**32;return r}function Te(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return Tf(t)}function ha(t){const e=BigInt(t);if(t<=0)throw new RangeError("Input must be positive");return e.toString(2).length-1}function ni(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}function ya(){throw new Error("unexpected end of buffer")}function Qt(t,e){return t.byteLength<e&&ya(),t.read(e)}function Jt(t){const e=t.readUint8();return e===void 0&&ya(),e}function te(t){if(typeof t=="number"&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:ha(t))+1,n=new Hn(new Uint8Array(e),0);for(;;){const r=Number(t&BigInt(127));if(t/=BigInt(128),t===BigInt(0)){n.write(new Uint8Array([r]));break}else n.write(new Uint8Array([r|128]))}return n.buffer}function le(t){let e=BigInt(1),n=BigInt(0),r;do r=Jt(t),n+=BigInt(r&127).valueOf()*e,e*=BigInt(128);while(r>=128);return n}function ue(t){typeof t=="number"&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const n=(t===BigInt(0)?0:ha(t))+1,r=new Hn(new Uint8Array(n),0);for(;;){const i=s(t);if(t/=BigInt(128),e&&t===BigInt(0)&&i&64||!e&&t===BigInt(0)&&!(i&64)){r.write(new Uint8Array([i]));break}else r.write(new Uint8Array([i|128]))}function s(i){const o=i%BigInt(128);return Number(e?BigInt(128)-o-BigInt(1):o)}return r.buffer}function Et(t){const e=new Uint8Array(t.buffer);let n=0;for(;n<e.byteLength;n++)if(e[n]<128){if(!(e[n]&64))return le(t);break}const r=new Uint8Array(Qt(t,n+1));let s=BigInt(0);for(let i=r.byteLength-1;i>=0;i--)s=s*BigInt(128)+BigInt(128-(r[i]&127)-1);return-s-BigInt(1)}function Sf(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return ba(t,e)}function ba(t,e){t=BigInt(t);const n=new Hn(new Uint8Array(Math.min(1,e)),0);let r=0,s=BigInt(256),i=BigInt(0),o=Number(t%s);for(n.write(new Uint8Array([o]));++r<e;)t<0&&i===BigInt(0)&&o!==0&&(i=BigInt(1)),o=Number((t/s-i)%BigInt(256)),n.write(new Uint8Array([o])),s*=BigInt(256);return n.buffer}function pa(t,e){if(e<=0||!Number.isInteger(e))throw new Error("Byte length must be a positive integer");let n=BigInt(Jt(t)),r=BigInt(1),s=0;for(;++s<e;){r*=BigInt(256);const i=BigInt(Jt(t));n=n+r*i}return n}function Cf(t,e){if(e<=0||!Number.isInteger(e))throw new Error("Byte length must be a positive integer");let n=pa(t,e);const r=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return n>=r&&(n-=r*BigInt(2)),n}var K;(function(t){t[t.Null=-1]="Null",t[t.Bool=-2]="Bool",t[t.Nat=-3]="Nat",t[t.Int=-4]="Int",t[t.Float32=-13]="Float32",t[t.Float64=-14]="Float64",t[t.Text=-15]="Text",t[t.Reserved=-16]="Reserved",t[t.Empty=-17]="Empty",t[t.Opt=-18]="Opt",t[t.Vector=-19]="Vector",t[t.Record=-20]="Record",t[t.Variant=-21]="Variant",t[t.Func=-22]="Func",t[t.Service=-23]="Service",t[t.Principal=-24]="Principal"})(K||(K={}));const Hr="DIDL",mo=400;function ar(t,e,n){return t.map((r,s)=>n(r,e[s]))}class Of{constructor(){this._typs=[],this._idx=new Map,this._idxRefCount=new Map}has(e){return this._idx.has(e.name)}add(e,n){const r=this._typs.length;this._idx.set(e.name,r),this._idxRefCount.set(r,1),this._typs.push(n)}merge(e,n){const r=this._idx.get(e.name),s=this._idx.get(n);if(r===void 0)throw new Error("Missing type index for "+e);if(s===void 0)throw new Error("Missing type index for "+n);this._typs[r]=this._typs[s];const i=this._getIdxRefCount(r),o=this._getIdxRefCount(s);this._idxRefCount.set(r,i+o),this._idx.set(n,r),this._idxRefCount.set(s,0),this._compactFromEnd()}_getIdxRefCount(e){return this._idxRefCount.get(e)||0}_compactFromEnd(){for(;this._typs.length>0;){const e=this._typs.length-1;if(this._getIdxRefCount(e)>0)break;this._typs.pop(),this._idxRefCount.delete(e)}}encode(){const e=te(this._typs.length),n=Y(...this._typs);return Y(e,n)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return ue(this._idx.get(e)||0)}}class $f{visitType(e,n){throw new Error("Not implemented")}visitPrimitive(e,n){return this.visitType(e,n)}visitEmpty(e,n){return this.visitPrimitive(e,n)}visitBool(e,n){return this.visitPrimitive(e,n)}visitNull(e,n){return this.visitPrimitive(e,n)}visitReserved(e,n){return this.visitPrimitive(e,n)}visitText(e,n){return this.visitPrimitive(e,n)}visitNumber(e,n){return this.visitPrimitive(e,n)}visitInt(e,n){return this.visitNumber(e,n)}visitNat(e,n){return this.visitNumber(e,n)}visitFloat(e,n){return this.visitPrimitive(e,n)}visitFixedInt(e,n){return this.visitNumber(e,n)}visitFixedNat(e,n){return this.visitNumber(e,n)}visitPrincipal(e,n){return this.visitPrimitive(e,n)}visitConstruct(e,n){return this.visitType(e,n)}visitVec(e,n,r){return this.visitConstruct(e,r)}visitOpt(e,n,r){return this.visitConstruct(e,r)}visitRecord(e,n,r){return this.visitConstruct(e,r)}visitTuple(e,n,r){const s=n.map((i,o)=>[`_${o}_`,i]);return this.visitRecord(e,s,r)}visitVariant(e,n,r){return this.visitConstruct(e,r)}visitRec(e,n,r){return this.visitConstruct(n,r)}visitFunc(e,n){return this.visitConstruct(e,n)}visitService(e,n){return this.visitConstruct(e,n)}}var j;(function(t){t.EmptyClass="__IDL_EmptyClass__",t.UnknownClass="__IDL_UnknownClass__",t.BoolClass="__IDL_BoolClass__",t.NullClass="__IDL_NullClass__",t.ReservedClass="__IDL_ReservedClass__",t.TextClass="__IDL_TextClass__",t.IntClass="__IDL_IntClass__",t.NatClass="__IDL_NatClass__",t.FloatClass="__IDL_FloatClass__",t.FixedIntClass="__IDL_FixedIntClass__",t.FixedNatClass="__IDL_FixedNatClass__",t.VecClass="__IDL_VecClass__",t.OptClass="__IDL_OptClass__",t.RecordClass="__IDL_RecordClass__",t.TupleClass="__IDL_TupleClass__",t.VariantClass="__IDL_VariantClass__",t.RecClass="__IDL_RecClass__",t.PrincipalClass="__IDL_PrincipalClass__",t.FuncClass="__IDL_FuncClass__",t.ServiceClass="__IDL_ServiceClass__"})(j||(j={}));class vs{display(){return this.name}valueToString(e){return ie(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class Ve extends vs{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class Dt extends vs{checkType(e){if(e instanceof De){const n=e.getType();if(typeof n>"u")throw new Error("type mismatch with uninitialized type");return n}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class Di extends Ve{get typeName(){return j.EmptyClass}static[Symbol.hasInstance](e){return e.typeName===j.EmptyClass}accept(e,n){return e.visitEmpty(this,n)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return ue(K.Empty)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class ma extends vs{get typeName(){return j.UnknownClass}static[Symbol.hasInstance](e){return e.typeName===j.UnknownClass}checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,n){throw e.visitType(this,n)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,n){let r=n.decodeValue(e,n);Object(r)!==r&&(r=Object(r));let s;return n instanceof De?s=()=>n.getType():s=()=>n,Object.defineProperty(r,"type",{value:s,writable:!0,enumerable:!1,configurable:!0}),r}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class ga extends Ve{get typeName(){return j.BoolClass}static[Symbol.hasInstance](e){return e.typeName===j.BoolClass}accept(e,n){return e.visitBool(this,n)}covariant(e){if(typeof e=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return ue(K.Bool)}decodeValue(e,n){switch(this.checkType(n),Jt(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class cr extends Ve{get typeName(){return j.NullClass}static[Symbol.hasInstance](e){return e.typeName===j.NullClass}accept(e,n){return e.visitNull(this,n)}covariant(e){if(e===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(){return new Uint8Array(0)}encodeType(){return ue(K.Null)}decodeValue(e,n){return this.checkType(n),null}get name(){return"null"}}class Pt extends Ve{get typeName(){return j.ReservedClass}static[Symbol.hasInstance](e){return e.typeName===j.ReservedClass}accept(e,n){return e.visitReserved(this,n)}covariant(e){return!0}encodeValue(){return new Uint8Array(0)}encodeType(){return ue(K.Reserved)}decodeValue(e,n){return n.name!==this.name&&n.decodeValue(e,n),null}get name(){return"reserved"}}class wa extends Ve{get typeName(){return j.TextClass}static[Symbol.hasInstance](e){return e.typeName===j.TextClass}accept(e,n){return e.visitText(this,n)}covariant(e){if(typeof e=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){const n=new TextEncoder().encode(e),r=te(n.byteLength);return Y(r,n)}encodeType(){return ue(K.Text)}decodeValue(e,n){this.checkType(n);const r=le(e),s=Qt(e,Number(r));return new TextDecoder("utf8",{fatal:!0}).decode(s)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class Li extends Ve{get typeName(){return j.IntClass}static[Symbol.hasInstance](e){return e.typeName===j.IntClass}accept(e,n){return e.visitInt(this,n)}covariant(e){if(typeof e=="bigint"||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){return ue(e)}encodeType(){return ue(K.Int)}decodeValue(e,n){return this.checkType(n),Et(e)}get name(){return"int"}valueToString(e){return e.toString()}}class Vi extends Ve{get typeName(){return j.NatClass}static[Symbol.hasInstance](e){return e.typeName===j.NatClass}accept(e,n){return e.visitNat(this,n)}covariant(e){if(typeof e=="bigint"&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){return te(e)}encodeType(){return ue(K.Nat)}decodeValue(e,n){return this.checkType(n),le(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class ki extends Ve{get typeName(){return j.FloatClass}static[Symbol.hasInstance](e){return e.typeName===j.FloatClass}constructor(e){if(super(),this._bits=e,e!==32&&e!==64)throw new Error("not a valid float type")}accept(e,n){return e.visitFloat(this,n)}covariant(e){if(typeof e=="number"||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){const n=new ArrayBuffer(this._bits/8),r=new DataView(n);return this._bits===32?r.setFloat32(0,e,!0):r.setFloat64(0,e,!0),new Uint8Array(n)}encodeType(){const e=this._bits===32?K.Float32:K.Float64;return ue(e)}decodeValue(e,n){this.checkType(n);const r=Qt(e,this._bits/8),s=Bf(r);return this._bits===32?s.getFloat32(0,!0):s.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class en extends Ve{get typeName(){return j.FixedIntClass}static[Symbol.hasInstance](e){return e.typeName===j.FixedIntClass}constructor(e){super(),this._bits=e}accept(e,n){return e.visitFixedInt(this,n)}covariant(e){const n=ni(this._bits-1)*BigInt(-1),r=ni(this._bits-1)-BigInt(1);let s=!1;if(typeof e=="bigint")s=e>=n&&e<=r;else if(Number.isInteger(e)){const i=BigInt(e);s=i>=n&&i<=r}else s=!1;if(s)return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){return ba(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return ue(-9-e)}decodeValue(e,n){this.checkType(n);const r=Cf(e,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class Mt extends Ve{get typeName(){return j.FixedNatClass}static[Symbol.hasInstance](e){return e.typeName===j.FixedNatClass}constructor(e){super(),this._bits=e}accept(e,n){return e.visitFixedNat(this,n)}covariant(e){const n=ni(this._bits);let r=!1;if(typeof e=="bigint"&&e>=BigInt(0)?r=e<n:Number.isInteger(e)&&e>=0?r=BigInt(e)<n:r=!1,r)return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){return Sf(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return ue(-5-e)}decodeValue(e,n){this.checkType(n);const r=pa(e,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class Vn extends Dt{get typeName(){return j.VecClass}static[Symbol.hasInstance](e){return e.typeName===j.VecClass}constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof Mt&&e._bits===8&&(this._blobOptimization=!0)}accept(e,n){return e.visitVec(this,this._type,n)}covariant(e){const n=this._type instanceof Mt?this._type._bits:this._type instanceof en?this._type._bits:0;if(ArrayBuffer.isView(e)&&n==e.BYTES_PER_ELEMENT*8||Array.isArray(e)&&e.every((r,s)=>{try{return this._type.covariant(r)}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${s} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){const n=te(e.length);if(this._blobOptimization)return Y(n,new Uint8Array(e));if(ArrayBuffer.isView(e))if(e instanceof Int16Array||e instanceof Uint16Array){const s=new DataView(new ArrayBuffer(e.length*2));for(let i=0;i<e.length;i++)e instanceof Int16Array?s.setInt16(i*2,e[i],!0):s.setUint16(i*2,e[i],!0);return Y(n,new Uint8Array(s.buffer))}else if(e instanceof Int32Array||e instanceof Uint32Array){const s=new DataView(new ArrayBuffer(e.length*4));for(let i=0;i<e.length;i++)e instanceof Int32Array?s.setInt32(i*4,e[i],!0):s.setUint32(i*4,e[i],!0);return Y(n,new Uint8Array(s.buffer))}else if(e instanceof BigInt64Array||e instanceof BigUint64Array){const s=new DataView(new ArrayBuffer(e.length*8));for(let i=0;i<e.length;i++)e instanceof BigInt64Array?s.setBigInt64(i*8,e[i],!0):s.setBigUint64(i*8,e[i],!0);return Y(n,new Uint8Array(s.buffer))}else return Y(n,new Uint8Array(e.buffer,e.byteOffset,e.byteLength));const r=new Hn(new Uint8Array(n.byteLength+e.length),0);r.write(n);for(const s of e){const i=this._type.encodeValue(s);r.write(new Uint8Array(i))}return r.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const n=ue(K.Vector),r=this._type.encodeType(e);e.add(this,Y(n,r))}decodeValue(e,n){const r=this.checkType(n);if(!(r instanceof Vn))throw new Error("Not a vector type");const s=Number(le(e));if(this._type instanceof Mt){if(this._type._bits==8)return new Uint8Array(e.read(s));if(this._type._bits==16){const o=e.read(s*2);return new Uint16Array(o.buffer,o.byteOffset,s)}if(this._type._bits==32){const o=e.read(s*4);return new Uint32Array(o.buffer,o.byteOffset,s)}if(this._type._bits==64)return new BigUint64Array(e.read(s*8).buffer)}if(this._type instanceof en){if(this._type._bits==8)return new Int8Array(e.read(s));if(this._type._bits==16){const o=e.read(s*2),c=new DataView(o.buffer,o.byteOffset,o.byteLength),a=new Int16Array(s);for(let u=0;u<s;u++)a[u]=c.getInt16(u*2,!0);return a}if(this._type._bits==32){const o=e.read(s*4),c=new DataView(o.buffer,o.byteOffset,o.byteLength),a=new Int32Array(s);for(let u=0;u<s;u++)a[u]=c.getInt32(u*4,!0);return a}if(this._type._bits==64){const o=e.read(s*8),c=new DataView(o.buffer,o.byteOffset,o.byteLength),a=new BigInt64Array(s);for(let u=0;u<s;u++)a[u]=c.getBigInt64(u*8,!0);return a}}const i=[];for(let o=0;o<s;o++)i.push(this._type.decodeValue(e,r._type));return i}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map(r=>this._type.valueToString(r)).join("; ")+"}"}}class bt extends Dt{get typeName(){return j.OptClass}static[Symbol.hasInstance](e){return e.typeName===j.OptClass}constructor(e){super(),this._type=e}accept(e,n){return e.visitOpt(this,this._type,n)}covariant(e){try{if(Array.isArray(e)&&(e.length===0||e.length===1&&this._type.covariant(e[0])))return!0}catch(n){throw new Error(`Invalid ${this.display()} argument: ${ie(e)} 

-> ${n.message}`)}throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){return e.length===0?new Uint8Array([0]):Y(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const n=ue(K.Opt),r=this._type.encodeType(e);e.add(this,Y(n,r))}decodeValue(e,n){if(n instanceof cr)return[];if(n instanceof Pt)return[];let r=n;if(n instanceof De){const s=n.getType();if(typeof s>"u")throw new Error("type mismatch with uninitialized type");r=s}if(r instanceof bt)switch(Jt(e)){case 0:return[];case 1:{const s=e.save();try{return[this._type.decodeValue(e,r._type)]}catch{return e.restore(s),r._type.decodeValue(e,r._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof cr||this._type instanceof bt||this._type instanceof Pt)return r.decodeValue(e,r),[];{const s=e.save();try{return[this._type.decodeValue(e,n)]}catch{return e.restore(s),r.decodeValue(e,n),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return e.length===0?"null":`opt ${this._type.valueToString(e[0])}`}}class tn extends Dt{get typeName(){return j.RecordClass}static[Symbol.hasInstance](e){return e.typeName===j.RecordClass||e.typeName===j.TupleClass}constructor(e={}){super(),this._fields=Object.entries(e).sort((n,r)=>Te(n[0])-Te(r[0]))}accept(e,n){return e.visitRecord(this,this._fields,n)}tryAsTuple(){const e=[];for(let n=0;n<this._fields.length;n++){const[r,s]=this._fields[n];if(r!==`_${n}_`)return null;e.push(s)}return e}covariant(e){if(typeof e=="object"&&this._fields.every(([n,r])=>{if(!e.hasOwnProperty(n))throw new Error(`Record is missing key "${n}".`);try{return r.covariant(e[n])}catch(s){throw new Error(`Invalid ${this.display()} argument: 

field ${n} -> ${s.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){const n=this._fields.map(([s])=>e[s]),r=ar(this._fields,n,([,s],i)=>s.encodeValue(i));return Y(...r)}_buildTypeTableImpl(e){this._fields.forEach(([i,o])=>o.buildTypeTable(e));const n=ue(K.Record),r=te(this._fields.length),s=this._fields.map(([i,o])=>Y(te(Te(i)),o.encodeType(e)));e.add(this,Y(n,r,Y(...s)))}decodeValue(e,n){const r=this.checkType(n);if(!(r instanceof tn))throw new Error("Not a record type");const s={};let i=0,o=0;for(;o<r._fields.length;){const[c,a]=r._fields[o];if(i>=this._fields.length){a.decodeValue(e,a),o++;continue}const[u,l]=this._fields[i],d=Te(this._fields[i][0]),f=Te(c);if(d===f)s[u]=l.decodeValue(e,a),i++,o++;else if(f>d)if(l instanceof bt||l instanceof Pt)s[u]=[],i++;else throw new Error("Cannot find required field "+u);else a.decodeValue(e,a),o++}for(const[c,a]of this._fields.slice(i))if(a instanceof bt||a instanceof Pt)s[c]=[];else throw new Error("Cannot find required field "+c);return s}get fieldsAsObject(){const e={};for(const[n,r]of this._fields)e[Te(n)]=r;return e}get name(){return`record {${this._fields.map(([n,r])=>n+":"+r.name).join("; ")}}`}display(){return`record {${this._fields.map(([n,r])=>n+":"+r.display()).join("; ")}}`}valueToString(e){const n=this._fields.map(([s])=>e[s]);return`record {${ar(this._fields,n,([s,i],o)=>s+"="+i.valueToString(o)).join("; ")}}`}}class Is extends tn{get typeName(){return j.TupleClass}static[Symbol.hasInstance](e){return e.typeName===j.TupleClass}constructor(e){const n={};e.forEach((r,s)=>n["_"+s+"_"]=r),super(n),this._components=e}accept(e,n){return e.visitTuple(this,this._components,n)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every((n,r)=>{try{return n.covariant(e[r])}catch(s){throw new Error(`Invalid ${this.display()} argument: 

index ${r} -> ${s.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){const n=ar(this._components,e,(r,s)=>r.encodeValue(s));return Y(...n)}decodeValue(e,n){const r=this.checkType(n);if(!(r instanceof Is))throw new Error("not a tuple type");if(r._components.length<this._components.length)throw new Error("tuple mismatch");const s=[];for(const[i,o]of r._components.entries())i>=this._components.length?o.decodeValue(e,o):s.push(this._components[i].decodeValue(e,o));return s}display(){return`record {${this._components.map(n=>n.display()).join("; ")}}`}valueToString(e){return`record {${ar(this._components,e,(r,s)=>r.valueToString(s)).join("; ")}}`}}class kn extends Dt{get typeName(){return j.VariantClass}static[Symbol.hasInstance](e){return e.typeName===j.VariantClass}constructor(e={}){super(),this._fields=Object.entries(e).sort((n,r)=>Te(n[0])-Te(r[0]))}accept(e,n){return e.visitVariant(this,this._fields,n)}covariant(e){if(typeof e=="object"&&Object.entries(e).length===1&&this._fields.every(([n,r])=>{try{return!e.hasOwnProperty(n)||r.covariant(e[n])}catch(s){throw new Error(`Invalid ${this.display()} argument: 

variant ${n} -> ${s.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){for(let n=0;n<this._fields.length;n++){const[r,s]=this._fields[n];if(e.hasOwnProperty(r)){const i=te(n),o=s.encodeValue(e[r]);return Y(i,o)}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach(([,i])=>{i.buildTypeTable(e)});const n=ue(K.Variant),r=te(this._fields.length),s=this._fields.map(([i,o])=>Y(te(Te(i)),o.encodeType(e)));e.add(this,Y(n,r,...s))}decodeValue(e,n){const r=this.checkType(n);if(!(r instanceof kn))throw new Error("Not a variant type");const s=Number(le(e));if(s>=r._fields.length)throw Error("Invalid variant index: "+s);const[i,o]=r._fields[s];for(const[c,a]of this._fields)if(Te(i)===Te(c)){const u=a.decodeValue(e,o);return{[c]:u}}throw new Error("Cannot find field hash "+i)}get name(){return`variant {${this._fields.map(([n,r])=>n+":"+r.name).join("; ")}}`}display(){return`variant {${this._fields.map(([n,r])=>n+(r.name==="null"?"":`:${r.display()}`)).join("; ")}}`}valueToString(e){for(const[n,r]of this._fields)if(e.hasOwnProperty(n)){const s=r.valueToString(e[n]);return s==="null"?`variant {${n}}`:`variant {${n}=${s}}`}throw new Error("Variant has no data: "+e)}get alternativesAsObject(){const e={};for(const[n,r]of this._fields)e[Te(n)]=r;return e}}const ls=class ls extends Dt{constructor(){super(...arguments),this._id=ls._counter++}get typeName(){return j.RecClass}static[Symbol.hasInstance](e){return e.typeName===j.RecClass}accept(e,n){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,n)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,n){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,n)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}};ls._counter=0;let De=ls;function ji(t){if(Jt(t)!==1)throw new Error("Cannot decode principal");const n=Number(le(t));return X.fromUint8Array(new Uint8Array(Qt(t,n)))}class xa extends Ve{get typeName(){return j.PrincipalClass}static[Symbol.hasInstance](e){return e.typeName===j.PrincipalClass}accept(e,n){return e.visitPrincipal(this,n)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){const n=e.toUint8Array(),r=te(n.byteLength);return Y(new Uint8Array([1]),r,n)}encodeType(){return ue(K.Principal)}decodeValue(e,n){return this.checkType(n),ji(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class fr extends Dt{get typeName(){return j.FuncClass}static[Symbol.hasInstance](e){return e.typeName===j.FuncClass}static argsToString(e,n){if(e.length!==n.length)throw new Error("arity mismatch");return"("+e.map((r,s)=>r.valueToString(n[s])).join(", ")+")"}constructor(e,n,r=[]){super(),this.argTypes=e,this.retTypes=n,this.annotations=r}accept(e,n){return e.visitFunc(this,n)}covariant(e){if(Array.isArray(e)&&e.length===2&&e[0]&&e[0]._isPrincipal&&typeof e[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue([e,n]){const r=e.toUint8Array(),s=te(r.byteLength),i=Y(new Uint8Array([1]),s,r),o=new TextEncoder().encode(n),c=te(o.byteLength);return Y(new Uint8Array([1]),i,c,o)}_buildTypeTableImpl(e){this.argTypes.forEach(u=>u.buildTypeTable(e)),this.retTypes.forEach(u=>u.buildTypeTable(e));const n=ue(K.Func),r=te(this.argTypes.length),s=Y(...this.argTypes.map(u=>u.encodeType(e))),i=te(this.retTypes.length),o=Y(...this.retTypes.map(u=>u.encodeType(e))),c=te(this.annotations.length),a=Y(...this.annotations.map(u=>this.encodeAnnotation(u)));e.add(this,Y(n,r,s,i,o,c,a))}decodeValue(e,n){const r=n instanceof De?n.getType()??n:n;if(!Fi(r,this))throw new Error(`Cannot decode function reference at type ${this.display()} from wire type ${r.display()}`);if(Jt(e)!==1)throw new Error("Cannot decode function reference");const i=ji(e),o=Number(le(e)),c=Qt(e,o),u=new TextDecoder("utf8",{fatal:!0}).decode(c);return[i,u]}get name(){const e=this.argTypes.map(s=>s.name).join(", "),n=this.retTypes.map(s=>s.name).join(", "),r=" "+this.annotations.join(" ");return`(${e}) -> (${n})${r}`}valueToString([e,n]){return`func "${e.toText()}".${n}`}display(){const e=this.argTypes.map(s=>s.display()).join(", "),n=this.retTypes.map(s=>s.display()).join(", "),r=" "+this.annotations.join(" ");return`(${e})  (${n})${r}`}encodeAnnotation(e){if(e==="query")return new Uint8Array([1]);if(e==="oneway")return new Uint8Array([2]);if(e==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class ss extends Dt{get typeName(){return j.ServiceClass}static[Symbol.hasInstance](e){return e.typeName===j.ServiceClass}constructor(e){super(),this._fields=Object.entries(e).sort((n,r)=>n[0]<r[0]?-1:n[0]>r[0]?1:0)}accept(e,n){return e.visitService(this,n)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${ie(e)}`)}encodeValue(e){const n=e.toUint8Array(),r=te(n.length);return Y(new Uint8Array([1]),r,n)}_buildTypeTableImpl(e){this._fields.forEach(([i,o])=>o.buildTypeTable(e));const n=ue(K.Service),r=te(this._fields.length),s=this._fields.map(([i,o])=>{const c=new TextEncoder().encode(i),a=te(c.length);return Y(a,c,o.encodeType(e))});e.add(this,Y(n,r,...s))}decodeValue(e,n){const r=n instanceof De?n.getType()??n:n;if(!Fi(r,this))throw new Error(`Cannot decode service reference at type ${this.display()} from wire type ${r.display()}`);return ji(e)}get name(){return`service {${this._fields.map(([n,r])=>n+":"+r.name).join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}fieldsAsObject(){const e={};for(const[n,r]of this._fields)e[n]=r;return e}}function ie(t){const e=JSON.stringify(t,(n,r)=>typeof r=="bigint"?`BigInt(${r})`:r);return e&&e.length>mo?e.substring(0,mo-3)+"...":e}function ri(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const n=new Of;t.forEach(a=>a.buildTypeTable(n));const r=new TextEncoder().encode(Hr),s=n.encode(),i=te(e.length),o=Y(...t.map(a=>a.encodeType(n))),c=Y(...ar(t,e,(a,u)=>{try{a.covariant(u)}catch(l){throw new Error(l.message+`

`)}return a.encodeValue(u)}));return Y(r,s,i,o,c)}function _a(t,e){const n=new Hn(e);if(e.byteLength<Hr.length)throw new Error("Message length smaller than magic number");const r=Qt(n,Hr.length),s=new TextDecoder().decode(r);if(s!==Hr)throw new Error("Wrong magic number: "+JSON.stringify(s));function i(f){const h=[],y=Number(le(f));for(let p=0;p<y;p++){const _=Number(Et(f));switch(_){case K.Opt:case K.Vector:{const m=Number(Et(f));h.push([_,m]);break}case K.Record:case K.Variant:{const m=[];let v=Number(le(f)),A;for(;v--;){const T=Number(le(f));if(T>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof A=="number"&&A>=T)throw new Error("field id collision or not sorted");A=T;const S=Number(Et(f));m.push([T,S])}h.push([_,m]);break}case K.Func:{const m=[];let v=Number(le(f));for(;v--;)m.push(Number(Et(f)));const A=[];let T=Number(le(f));for(;T--;)A.push(Number(Et(f)));const S=[];let R=Number(le(f));for(;R--;)switch(Number(le(f))){case 1:{S.push("query");break}case 2:{S.push("oneway");break}case 3:{S.push("composite_query");break}default:throw new Error("unknown annotation")}h.push([_,[m,A,S]]);break}case K.Service:{let m=Number(le(f));const v=[];for(;m--;){const A=Number(le(f)),T=new TextDecoder().decode(Qt(f,A)),S=Et(f);v.push([T,S])}h.push([_,v]);break}default:throw new Error("Illegal op_code: "+_)}}const b=[],g=Number(le(f));for(let p=0;p<g;p++)b.push(Number(Et(f)));return[h,b]}const[o,c]=i(n);if(c.length<t.length)throw new Error("Wrong number of return values");const a=o.map(f=>Ga());function u(f){if(f<-24)throw new Error("future value not supported");if(f<0)switch(f){case-1:return Aa;case-2:return Ia;case-3:return Sa;case-4:return Ta;case-5:return qa;case-6:return Ma;case-7:return Pa;case-8:return Da;case-9:return $a;case-10:return Na;case-11:return Ra;case-12:return Ua;case-13:return Ca;case-14:return Oa;case-15:return Ba;case-16:return va;case-17:return Ea;case-24:return La;default:throw new Error("Illegal op_code: "+f)}if(f>=o.length)throw new Error("type index out of range");return a[f]}function l(f){switch(f[0]){case K.Vector:{const h=u(f[1]);return ka(h)}case K.Opt:{const h=u(f[1]);return ja(h)}case K.Record:{const h={};for(const[g,p]of f[1]){const _=`_${g}_`;h[_]=u(p)}const y=Fa(h),b=y.tryAsTuple();return Array.isArray(b)?Va(...b):y}case K.Variant:{const h={};for(const[y,b]of f[1]){const g=`_${y}_`;h[g]=u(b)}return Ha(h)}case K.Func:{const[h,y,b]=f[1];return Za(h.map(g=>u(g)),y.map(g=>u(g)),b)}case K.Service:{const h={},y=f[1];for(const[b,g]of y){let p=u(g);if(p instanceof De&&(p=p.getType()),!(p instanceof fr))throw new Error("Illegal service definition: services can only contain functions");h[b]=p}return Ka(h)}default:throw new Error("Illegal op_code: "+f[0])}}o.forEach((f,h)=>{if(f[0]===K.Func){const y=l(f);a[h].fill(y)}}),o.forEach((f,h)=>{if(f[0]!==K.Func){const y=l(f);a[h].fill(y)}}),si();const d=c.map(f=>u(f));try{const f=t.map((h,y)=>h.decodeValue(n,d[y]));for(let h=t.length;h<d.length;h++)d[h].decodeValue(n,d[h]);if(n.byteLength>0)throw new Error("decode: Left-over bytes");return f}finally{si()}}const Ea=new Di,va=new Pt,Nf=new ma,Ia=new ga,Aa=new cr,Ba=new wa,Ta=new Li,Sa=new Vi,Ca=new ki(32),Oa=new ki(64),$a=new en(8),Na=new en(16),Ra=new en(32),Ua=new en(64),qa=new Mt(8),Ma=new Mt(16),Pa=new Mt(32),Da=new Mt(64),La=new xa;function Va(...t){return new Is(t)}function ka(t){return new Vn(t)}function ja(t){return new bt(t)}function Fa(t){return new tn(t)}function Ha(t){return new kn(t)}function Ga(){return new De}function Za(t,e,n=[]){return new fr(t,e,n)}function Ka(t){return new ss(t)}class As{constructor(e=new Map){this.rels=e}copy(){const e=new Map;for(const[n,r]of this.rels.entries()){const s=new Map(r);e.set(n,s)}return new As(e)}known(e,n){var r;return(r=this.rels.get(e.name))==null?void 0:r.get(n.name)}addNegative(e,n){this.addNames(e.name,n.name,!1)}add(e,n){this.addNames(e.name,n.name,!0)}display(){let e="";for(const[n,r]of this.rels)for(const[s,i]of r)e+=`${n} ${i?":<":"!<:"} ${s}
`;return e}addNames(e,n,r){const s=this.rels.get(e);if(s==null){const i=new Map;i.set(n,r),this.rels.set(e,i)}else s.set(n,r)}}let Gr=new As;function si(){Gr=new As}function Rf(t,e){const n=new Set(t.annotations),r=new Set(e.annotations);if(n.size!==r.size)return!1;for(const s of n)if(!r.has(s))return!1;return!0}function Ms(t){return t instanceof bt||t instanceof cr||t instanceof Pt}function Fi(t,e){const n=Gr.copy(),r=ot(n,t,e);return r?Gr.add(t,e):Gr.addNegative(t,e),r}function ot(t,e,n){if(e.name===n.name)return!0;const r=t.known(e,n);if(r!==void 0)return r;if(t.add(e,n),n instanceof Pt||e instanceof Di||e instanceof Vi&&n instanceof Li)return!0;if(e instanceof Vn&&n instanceof Vn)return ot(t,e._type,n._type);if(n instanceof bt)return!0;if(e instanceof tn&&n instanceof tn){const s=e.fieldsAsObject;for(const[i,o]of n._fields){const c=s[Te(i)];if(c){if(!ot(t,c,o))return!1}else if(!Ms(o))return!1}return!0}if(e instanceof fr&&n instanceof fr){if(!Rf(e,n))return!1;for(let s=0;s<e.argTypes.length;s++){const i=e.argTypes[s];if(s<n.argTypes.length){if(!ot(t,n.argTypes[s],i))return!1}else if(!Ms(i))return!1}for(let s=0;s<n.retTypes.length;s++){const i=n.retTypes[s];if(s<e.retTypes.length){if(!ot(t,e.retTypes[s],i))return!1}else if(!Ms(i))return!1}return!0}if(e instanceof kn&&n instanceof kn){const s=n.alternativesAsObject;for(const[i,o]of e._fields){const c=s[Te(i)];if(!c||!ot(t,o,c))return!1}return!0}if(e instanceof ss&&n instanceof ss){const s=e.fieldsAsObject();for(const[i,o]of n._fields){const c=s[i];if(!c||!ot(t,c,o))return!1}return!0}return e instanceof De?ot(t,e.getType(),n):n instanceof De?ot(t,e,n.getType()):!1}const Uf=Object.freeze(Object.defineProperty({__proto__:null,Bool:Ia,BoolClass:ga,ConstructType:Dt,Empty:Ea,EmptyClass:Di,FixedIntClass:en,FixedNatClass:Mt,Float32:Ca,Float64:Oa,FloatClass:ki,Func:Za,FuncClass:fr,Int:Ta,Int16:Na,Int32:Ra,Int64:Ua,Int8:$a,IntClass:Li,Nat:Sa,Nat16:Ma,Nat32:Pa,Nat64:Da,Nat8:qa,NatClass:Vi,Null:Aa,NullClass:cr,Opt:ja,OptClass:bt,PrimitiveType:Ve,Principal:La,PrincipalClass:xa,Rec:Ga,RecClass:De,Record:Fa,RecordClass:tn,Reserved:va,ReservedClass:Pt,Service:Ka,ServiceClass:ss,Text:Ba,TextClass:wa,Tuple:Va,TupleClass:Is,Type:vs,Unknown:Nf,UnknownClass:ma,Variant:Ha,VariantClass:kn,Vec:ka,VecClass:Vn,Visitor:$f,decode:_a,encode:ri,resetSubtypeCache:si,subtype:Fi},Symbol.toStringTag,{value:"Module"}));function is(t){if(!t)throw new Error("Input cannot be null or undefined");return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):Array.isArray(t)?new Uint8Array(t):"buffer"in t?is(t.buffer):new Uint8Array(t)}function Bs(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function ii(t){if(typeof t=="string")return Ya(t);if(typeof t=="number")return Oe(te(t));if(t instanceof Uint8Array||ArrayBuffer.isView(t))return Oe(is(t));if(Array.isArray(t)){const e=t.map(ii);return Oe(z(...e))}else{if(t&&typeof t=="object"&&t._isPrincipal)return Oe(t.toUint8Array());if(typeof t=="object"&&t!==null&&typeof t.toHash=="function")return ii(t.toHash());if(typeof t=="object")return os(t);if(typeof t=="bigint")return Oe(te(t))}throw Q.fromCode(new $i(t))}const Ya=t=>{const e=new TextEncoder().encode(t);return Oe(e)};function Ps(t){return os(t)}function os(t){const r=Object.entries(t).filter(([,o])=>o!==void 0).map(([o,c])=>{const a=Ya(o),u=ii(c);return[a,u]}).sort(([o],[c])=>Af(o,c)),s=z(...r.map(o=>z(...o)));return Oe(s)}new TextEncoder().encode(`
ic-request`);const qf=new TextEncoder().encode("\vic-response");new TextEncoder().encode("ic-request-auth-delegation");class go{getPrincipal(){return X.anonymous()}async transformRequest(e){return{...e,body:{content:e.body}}}}class sn extends Error{constructor(e){super(e),this.name="DecodingError"}}const za=55799,Xa=Symbol("CBOR_STOP_CODE");var Ye=(t=>(t[t.False=20]="False",t[t.True=21]="True",t[t.Null=22]="Null",t[t.Undefined=23]="Undefined",t[t.Break=31]="Break",t))(Ye||{}),fe=(t=>(t[t.UnsignedInteger=0]="UnsignedInteger",t[t.NegativeInteger=1]="NegativeInteger",t[t.ByteString=2]="ByteString",t[t.TextString=3]="TextString",t[t.Array=4]="Array",t[t.Map=5]="Map",t[t.Tag=6]="Tag",t[t.Simple=7]="Simple",t))(fe||{});const Mf=23,Pf=255,Df=65535,Lf=4294967295,Vf=BigInt("0xffffffffffffffff");var Ze=(t=>(t[t.Value=23]="Value",t[t.OneByte=24]="OneByte",t[t.TwoBytes=25]="TwoBytes",t[t.FourBytes=26]="FourBytes",t[t.EightBytes=27]="EightBytes",t[t.Indefinite=31]="Indefinite",t))(Ze||{});const vn=!1;function kf(t){return t==null}function Wa(t,e){const n=new Uint8Array(e);return n.set(t),n}const jf=new TextDecoder;function Ff(t){return(t&224)>>5}function Hf(t){return t&31}let ur=new Uint8Array,Yn,ze=0;function Gf(t,e){ur=t,ze=0;const n=Xt(e);return(e==null?void 0:e(n))??n}function Xt(t){const[e,n]=Zr();switch(e){case fe.UnsignedInteger:return Gn(n);case fe.NegativeInteger:return zf(n);case fe.ByteString:return Qa(n);case fe.TextString:return oi(n);case fe.Array:return Zf(n,t);case fe.Map:return Yf(n,t);case fe.Tag:return Xf(n,t);case fe.Simple:return Kf(n)}throw new sn(`Unsupported major type: ${e}`)}function Zr(){const t=ur.at(ze);if(kf(t))throw new sn("Provided CBOR data is empty");const e=Ff(t),n=Hf(t);return ze++,[e,n]}function Zf(t,e){const n=Gn(t);if(n===1/0){const s=[];let i=Xt(e);for(;i!==Xa;)s.push((e==null?void 0:e(i))??i),i=Xt(e);return s}const r=new Array(n);for(let s=0;s<n;s++){const i=Xt(e);r[s]=(e==null?void 0:e(i))??i}return r}function Kf(t){switch(t){case Ye.False:return!1;case Ye.True:return!0;case Ye.Null:return null;case Ye.Undefined:return;case Ye.Break:return Xa}throw new sn(`Unrecognized simple type: ${t.toString(2)}`)}function Yf(t,e){const n=Gn(t),r={};if(n===1/0){let[s,i]=Zr();for(;s!==fe.Simple&&i!==Ye.Break;){const o=oi(i),c=Xt(e);r[o]=(e==null?void 0:e(c,o))??c,[s,i]=Zr()}return r}for(let s=0;s<n;s++){const[i,o]=Zr();if(i!==fe.TextString)throw new sn("Map keys must be text strings");const c=oi(o),a=Xt(e);r[c]=(e==null?void 0:e(a,c))??a}return r}function Gn(t){if(t<=Ze.Value)return t;switch(Yn=new DataView(ur.buffer,ur.byteOffset+ze),t){case Ze.OneByte:return ze++,Yn.getUint8(0);case Ze.TwoBytes:return ze+=2,Yn.getUint16(0,vn);case Ze.FourBytes:return ze+=4,Yn.getUint32(0,vn);case Ze.EightBytes:return ze+=8,Yn.getBigUint64(0,vn);case Ze.Indefinite:return 1/0;default:throw new sn(`Unsupported integer info: ${t.toString(2)}`)}}function zf(t){const e=Gn(t);return typeof e=="number"?-1-e:-1n-e}function Qa(t){const e=Gn(t);if(e>Number.MAX_SAFE_INTEGER)throw new sn("Byte length is too large");const n=Number(e);return ze+=n,ur.slice(ze-n,ze)}function oi(t){const e=Qa(t);return jf.decode(e)}function Xf(t,e){const n=Gn(t);if(n===za)return Xt(e);throw new sn(`Unsupported tag: ${n}.`)}class Hi extends Error{constructor(e){super(e),this.name="SerializationError"}}const Wf=2*1024,Qf=100,Jf=new TextEncoder;function zn(t){return t<<5}let Ce=new Uint8Array(Wf),Fe=new DataView(Ce.buffer),ce=0,Ds=[];function eu(t,e){ce=0;const n=(e==null?void 0:e(t))??t;return cu(za,n,e),Ce.slice(0,ce)}function Gi(t,e){if(ce>Ce.length-Qf&&(Ce=Wa(Ce,Ce.length*2),Fe=new DataView(Ce.buffer)),t===!1||t===!0||t===null||t===void 0){ru(t);return}if(typeof t=="number"||typeof t=="bigint"){au(t);return}if(typeof t=="string"){tc(t);return}if(t instanceof Uint8Array){wo(t);return}if(t instanceof ArrayBuffer){wo(new Uint8Array(t));return}if(Array.isArray(t)){tu(t,e);return}if(typeof t=="object"){nu(t,e);return}throw new Hi(`Unsupported type: ${typeof t}`)}function tu(t,e){Zn(fe.Array,t.length),t.forEach((n,r)=>{Gi((e==null?void 0:e(n,r.toString()))??n,e)})}function nu(t,e){Ds=Object.entries(t),Zn(fe.Map,Ds.length),Ds.forEach(([n,r])=>{tc(n),Gi((e==null?void 0:e(r,n))??r,e)})}function Zn(t,e){if(e<=Mf){Fe.setUint8(ce++,zn(t)|Number(e));return}if(e<=Pf){Fe.setUint8(ce++,zn(t)|Ze.OneByte),Fe.setUint8(ce,Number(e)),ce+=1;return}if(e<=Df){Fe.setUint8(ce++,zn(t)|Ze.TwoBytes),Fe.setUint16(ce,Number(e),vn),ce+=2;return}if(e<=Lf){Fe.setUint8(ce++,zn(t)|Ze.FourBytes),Fe.setUint32(ce,Number(e),vn),ce+=4;return}if(e<=Vf){Fe.setUint8(ce++,zn(t)|Ze.EightBytes),Fe.setBigUint64(ce,BigInt(e),vn),ce+=8;return}throw new Hi(`Value too large to encode: ${e}`)}function ru(t){Zn(fe.Simple,su(t))}function su(t){if(t===!1)return Ye.False;if(t===!0)return Ye.True;if(t===null)return Ye.Null;if(t===void 0)return Ye.Undefined;throw new Hi(`Unrecognized simple value: ${t.toString()}`)}function Ja(t,e){Zn(t,e.length),ce>Ce.length-e.length&&(Ce=Wa(Ce,Ce.length+e.length),Fe=new DataView(Ce.buffer)),Ce.set(e,ce),ce+=e.length}function ec(t,e){Zn(t,e)}function iu(t){ec(fe.UnsignedInteger,t)}function ou(t){ec(fe.NegativeInteger,typeof t=="bigint"?-1n-t:-1-t)}function au(t){t>=0?iu(t):ou(t)}function tc(t){Ja(fe.TextString,Jf.encode(t))}function wo(t){Ja(fe.ByteString,t)}function cu(t,e,n){Zn(fe.Tag,t),Gi(e,n)}function fu(t){return typeof t=="object"&&t!==null&&"toCborValue"in t}function Ls(t){try{return eu(t,e=>X.isPrincipal(e)?e.toUint8Array():In.isExpiry(e)?e.toBigInt():fu(e)?e.toCborValue():e)}catch(e){throw Q.fromCode(new Bi(e,t))}}function nt(t){try{return Gf(t)}catch(e){throw Q.fromCode(new Ai(e,t))}}const kr=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var Ht;(function(t){t.Query="read",t.ReadState="read_state",t.Call="call"})(Ht||(Ht={}));var ai;(function(t){t.Call="call"})(ai||(ai={}));var dr;(function(t){t.Query="query",t.ReadState="read_state"})(dr||(dr={}));function ci(){const t=new ArrayBuffer(16),e=new DataView(t),n=kr(),r=kr(),s=kr(),i=kr();return e.setUint32(0,n),e.setUint32(4,r),e.setUint32(8,s),e.setUint32(12,i),Object.assign(new Uint8Array(t),{__nonce__:void 0})}const jr="__expiry__",fi=BigInt(1e3),uu=BigInt(1e6),du=BigInt(60),ui=du*fi,lu=BigInt(1)*ui;function hu(t){return t/fi*fi}function yu(t){return t/ui*ui}class In{constructor(e){this.__expiry__=e,this._isExpiry=!0}static fromDeltaInMilliseconds(e,n=0){const r=BigInt(Date.now())+BigInt(n),s=r+BigInt(e),i=yu(s);let o;return i>=r+lu?o=i:o=hu(s),new In(o*uu)}toBigInt(){return this.__expiry__}toHash(){return te(this.__expiry__)}toString(){return this.__expiry__.toString()}toJSON(){return{[jr]:this.toString()}}static fromJSON(e){const n=JSON.parse(e);if(n[jr])try{const r=BigInt(n[jr]);return new In(r)}catch(r){throw new Q(new rs(`Not a valid BigInt: ${r}`))}throw new Q(new rs(`The input does not contain the key ${jr}`))}static isExpiry(e){return e instanceof In||typeof e=="object"&&e!==null&&"_isExpiry"in e&&e._isExpiry===!0&&"__expiry__"in e&&typeof e.__expiry__=="bigint"}}function xo(t=ci){return async e=>{const n=e.request.headers;e.request.headers=n,e.endpoint===Ht.Call&&(e.body.nonce=t())}}function Vs(t){const e=[];return t.forEach((n,r)=>{e.push([r,n])}),e}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zi=BigInt(0),as=BigInt(1);function lr(t,e=""){if(typeof t!="boolean"){const n=e&&`"${e}"`;throw new Error(n+"expected boolean, got type="+typeof t)}return t}function An(t,e,n=""){const r=Or(t),s=t==null?void 0:t.length,i=e!==void 0;if(!r||i&&s!==e){const o=n&&`"${n}" `,c=i?` of length ${e}`:"",a=r?`length=${s}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+c+", got "+a)}return t}function nc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Zi:BigInt("0x"+t)}function rt(t){return nc(J(t))}function hr(t){return Pe(t),nc(J(Uint8Array.from(t).reverse()))}function pe(t,e){return $r(t.toString(16).padStart(e*2,"0"))}function rc(t,e){return pe(t,e).reverse()}function Ie(t,e,n){let r;if(typeof e=="string")try{r=$r(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Or(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function _o(t){return Uint8Array.from(t)}const ks=t=>typeof t=="bigint"&&Zi<=t;function sc(t,e,n){return ks(t)&&ks(e)&&ks(n)&&e<=t&&t<n}function Eo(t,e,n,r){if(!sc(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function yr(t){let e;for(e=0;t>Zi;t>>=as,e+=1);return e}function bu(t,e){return t>>BigInt(e)&as}const on=t=>(as<<BigInt(t))-as;function pu(t){return typeof t=="function"&&Number.isSafeInteger(t.outputLen)}function Ur(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const c=t[s];if(o&&c===void 0)return;const a=typeof c;if(a!==i||c===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${a}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}const ic=()=>{throw new Error("not implemented")};function br(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Se=BigInt(0),ge=BigInt(1),Gt=BigInt(2),oc=BigInt(3),ac=BigInt(4),cc=BigInt(5),mu=BigInt(7),fc=BigInt(8),gu=BigInt(9),uc=BigInt(16);function se(t,e){const n=t%e;return n>=Se?n:e+n}function Qe(t,e,n){let r=t;for(;e-- >Se;)r*=r,r%=n;return r}function vo(t,e){if(t===Se)throw new Error("invert: expected non-zero number");if(e<=Se)throw new Error("invert: expected positive modulus, got "+e);let n=se(t,e),r=e,s=Se,i=ge;for(;n!==Se;){const c=r/n,a=r%n,u=s-i*c;r=n,n=a,s=i,i=u}if(r!==ge)throw new Error("invert: does not exist");return se(s,e)}function Ki(t,e,n){if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root")}function dc(t,e){const n=(t.ORDER+ge)/ac,r=t.pow(e,n);return Ki(t,r,e),r}function wu(t,e){const n=(t.ORDER-cc)/fc,r=t.mul(e,Gt),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,Gt),s),c=t.mul(i,t.sub(o,t.ONE));return Ki(t,c,e),c}function xu(t){const e=Lt(t),n=lc(t),r=n(e,e.neg(e.ONE)),s=n(e,r),i=n(e,e.neg(r)),o=(t+mu)/uc;return(c,a)=>{let u=c.pow(a,o),l=c.mul(u,r);const d=c.mul(u,s),f=c.mul(u,i),h=c.eql(c.sqr(l),a),y=c.eql(c.sqr(d),a);u=c.cmov(u,l,h),l=c.cmov(f,d,y);const b=c.eql(c.sqr(l),a),g=c.cmov(u,l,b);return Ki(c,g,a),g}}function lc(t){if(t<oc)throw new Error("sqrt is not defined for small field");let e=t-ge,n=0;for(;e%Gt===Se;)e/=Gt,n++;let r=Gt;const s=Lt(t);for(;cs(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return dc;let i=s.pow(r,e);const o=(e+ge)/Gt;return function(a,u){if(a.is0(u))return u;if(cs(a,u)!==1)throw new Error("Cannot find square root");let l=n,d=a.mul(a.ONE,i),f=a.pow(u,e),h=a.pow(u,o);for(;!a.eql(f,a.ONE);){if(a.is0(f))return a.ZERO;let y=1,b=a.sqr(f);for(;!a.eql(b,a.ONE);)if(y++,b=a.sqr(b),y===l)throw new Error("Cannot find square root");const g=ge<<BigInt(l-y-1),p=a.pow(d,g);l=y,d=a.sqr(p),f=a.mul(f,d),h=a.mul(h,p)}return h}}function _u(t){return t%ac===oc?dc:t%fc===cc?wu:t%uc===gu?xu(t):lc(t)}const Eu=(t,e)=>(se(t,e)&ge)===ge,vu=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function hc(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=vu.reduce((r,s)=>(r[s]="function",r),e);return Ur(t,n),t}function Ts(t,e,n){if(n<Se)throw new Error("invalid exponent, negatives unsupported");if(n===Se)return t.ONE;if(n===ge)return e;let r=t.ONE,s=e;for(;n>Se;)n&ge&&(r=t.mul(r,s)),s=t.sqr(s),n>>=ge;return r}function an(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,c,a)=>t.is0(c)?o:(r[a]=o,t.mul(o,c)),t.ONE),i=t.inv(s);return e.reduceRight((o,c,a)=>t.is0(c)?o:(r[a]=t.mul(o,r[a]),t.mul(o,c)),i),r}function cs(t,e){const n=(t.ORDER-ge)/Gt,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function Iu(t,e){e!==void 0&&ef(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Lt(t,e,n=!1,r={}){if(t<=Se)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i,o=!1,c;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const f=e;f.BITS&&(s=f.BITS),f.sqrt&&(i=f.sqrt),typeof f.isLE=="boolean"&&(n=f.isLE),typeof f.modFromBytes=="boolean"&&(o=f.modFromBytes),c=f.allowedLengths}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:a,nByteLength:u}=Iu(t,s);if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let l;const d=Object.freeze({ORDER:t,isLE:n,BITS:a,BYTES:u,MASK:on(a),ZERO:Se,ONE:ge,allowedLengths:c,create:f=>se(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return Se<=f&&f<t},is0:f=>f===Se,isValidNot0:f=>!d.is0(f)&&d.isValid(f),isOdd:f=>(f&ge)===ge,neg:f=>se(-f,t),eql:(f,h)=>f===h,sqr:f=>se(f*f,t),add:(f,h)=>se(f+h,t),sub:(f,h)=>se(f-h,t),mul:(f,h)=>se(f*h,t),pow:(f,h)=>Ts(d,f,h),div:(f,h)=>se(f*vo(h,t),t),sqrN:f=>f*f,addN:(f,h)=>f+h,subN:(f,h)=>f-h,mulN:(f,h)=>f*h,inv:f=>vo(f,t),sqrt:i||(f=>(l||(l=_u(t)),l(d,f))),toBytes:f=>n?rc(f,u):pe(f,u),fromBytes:(f,h=!0)=>{if(c){if(!c.includes(f.length)||f.length>u)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+f.length);const b=new Uint8Array(u);b.set(f,n?0:b.length-f.length),f=b}if(f.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+f.length);let y=n?hr(f):rt(f);if(o&&(y=se(y,t)),!h&&!d.isValid(y))throw new Error("invalid field element: outside of range 0..ORDER");return y},invertBatch:f=>an(d,f),cmov:(f,h,y)=>y?h:f});return Object.freeze(d)}function yc(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function bc(t){const e=yc(t);return e+Math.ceil(e/2)}function Au(t,e,n=!1){const r=t.length,s=yc(e),i=bc(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?hr(t):rt(t),c=se(o,e-ge)+ge;return n?rc(c,s):pe(c,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jn=BigInt(0),Zt=BigInt(1);function fs(t,e){const n=e.negate();return t?n:e}function dt(t,e){const n=an(t.Fp,e.map(r=>r.Z));return e.map((r,s)=>t.fromAffine(r.toAffine(n[s])))}function pc(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function js(t,e){pc(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=on(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function Io(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let c=Number(t&s),a=t>>o;c>r&&(c-=i,a+=Zt);const u=e*r,l=u+Math.abs(c)-1,d=c===0,f=c<0,h=e%2!==0;return{nextN:a,offset:l,isZero:d,isNeg:f,isNegF:h,offsetF:u}}function Bu(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function Tu(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Fs=new WeakMap,mc=new WeakMap;function Hs(t){return mc.get(t)||1}function Ao(t){if(t!==jn)throw new Error("invalid wNAF")}class gc{constructor(e,n){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=n}_unsafeLadder(e,n,r=this.ZERO){let s=e;for(;n>jn;)n&Zt&&(r=r.add(s)),s=s.double(),n>>=Zt;return r}precomputeWindow(e,n){const{windows:r,windowSize:s}=js(n,this.bits),i=[];let o=e,c=o;for(let a=0;a<r;a++){c=o,i.push(c);for(let u=1;u<s;u++)c=c.add(o),i.push(c);o=c.double()}return i}wNAF(e,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=js(e,this.bits);for(let c=0;c<o.windows;c++){const{nextN:a,offset:u,isZero:l,isNeg:d,isNegF:f,offsetF:h}=Io(r,c,o);r=a,l?i=i.add(fs(f,n[h])):s=s.add(fs(d,n[u]))}return Ao(r),{p:s,f:i}}wNAFUnsafe(e,n,r,s=this.ZERO){const i=js(e,this.bits);for(let o=0;o<i.windows&&r!==jn;o++){const{nextN:c,offset:a,isZero:u,isNeg:l}=Io(r,o,i);if(r=c,!u){const d=n[a];s=s.add(l?d.negate():d)}}return Ao(r),s}getPrecomputes(e,n,r){let s=Fs.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&(typeof r=="function"&&(s=r(s)),Fs.set(n,s))),s}cached(e,n,r){const s=Hs(e);return this.wNAF(s,this.getPrecomputes(s,e,r),n)}unsafe(e,n,r,s){const i=Hs(e);return i===1?this._unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),n,s)}createCache(e,n){pc(n,this.bits),mc.set(e,n),Fs.delete(e)}hasCache(e){return Hs(e)!==1}}function Su(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>jn||r>jn;)n&Zt&&(i=i.add(s)),r&Zt&&(o=o.add(s)),s=s.double(),n>>=Zt,r>>=Zt;return{p1:i,p2:o}}function wc(t,e,n,r){Bu(n,t),Tu(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,c=yr(BigInt(s));let a=1;c>12?a=c-3:c>4?a=c-2:c>0&&(a=2);const u=on(a),l=new Array(Number(u)+1).fill(o),d=Math.floor((e.BITS-1)/a)*a;let f=o;for(let h=d;h>=0;h-=a){l.fill(o);for(let b=0;b<i;b++){const g=r[b],p=Number(g>>BigInt(h)&u);l[p]=l[p].add(n[b])}let y=o;for(let b=l.length-1,g=o;b>0;b--)g=g.add(l[b]),y=y.add(g);if(f=f.add(y),h!==0)for(let b=0;b<a;b++)f=f.double()}return f}function Bo(t,e,n){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return hc(e),e}else return Lt(t,{isLE:n})}function xc(t,e,n={},r){if(r===void 0&&(r=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const a of["p","n","h"]){const u=e[a];if(!(typeof u=="bigint"&&u>jn))throw new Error(`CURVE.${a} must be positive bigint`)}const s=Bo(e.p,n.Fp,r),i=Bo(e.n,n.Fn,r),c=["Gx","Gy","a",t==="weierstrass"?"b":"d"];for(const a of c)if(!s.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}const Cu=rt;function vt(t,e){if(pr(t),pr(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=t&255,t>>>=8;return new Uint8Array(n)}function Ou(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}function pr(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function _c(t){if(!Or(t)&&typeof t!="string")throw new Error("DST must be Uint8Array or string");return typeof t=="string"?ne(t):t}function $u(t,e,n,r){Pe(t),pr(n),e=_c(e),e.length>255&&(e=r(z(ne("H2C-OVERSIZE-DST-"),e)));const{outputLen:s,blockLen:i}=r,o=Math.ceil(n/s);if(n>65535||o>255)throw new Error("expand_message_xmd: invalid lenInBytes");const c=z(e,vt(e.length,1)),a=vt(0,i),u=vt(n,2),l=new Array(o),d=r(z(a,t,u,vt(0,1),c));l[0]=r(z(d,vt(1,1),c));for(let h=1;h<=o;h++){const y=[Ou(d,l[h-1]),vt(h+1,1),c];l[h]=r(z(...y))}return z(...l).slice(0,n)}function Nu(t,e,n,r,s){if(Pe(t),pr(n),e=_c(e),e.length>255){const i=Math.ceil(2*r/8);e=s.create({dkLen:i}).update(ne("H2C-OVERSIZE-DST-")).update(e).digest()}if(n>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:n}).update(t).update(vt(n,2)).update(e).update(vt(e.length,1)).digest()}function Gs(t,e,n){Ur(n,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:r,k:s,m:i,hash:o,expand:c,DST:a}=n;if(!pu(n.hash))throw new Error("expected valid hash");Pe(t),pr(e);const u=r.toString(2).length,l=Math.ceil((u+s)/8),d=e*i*l;let f;if(c==="xmd")f=$u(t,a,d,o);else if(c==="xof")f=Nu(t,a,d,s,o);else if(c==="_internal_pass")f=t;else throw new Error('expand must be "xmd" or "xof"');const h=new Array(e);for(let y=0;y<e;y++){const b=new Array(i);for(let g=0;g<i;g++){const p=l*(g+y*i),_=f.subarray(p,p+l);b[g]=se(Cu(_),r)}h[y]=b}return h}function Ec(t,e){const n=e.map(r=>Array.from(r).reverse());return(r,s)=>{const[i,o,c,a]=n.map(d=>d.reduce((f,h)=>t.add(t.mul(f,r),h))),[u,l]=an(t,[o,a],!0);return r=t.mul(i,u),s=t.mul(s,t.mul(c,l)),{x:r,y:s}}}const Ru=ne("HashToScalar-");function To(t,e,n){if(typeof e!="function")throw new Error("mapToCurve() must be defined");function r(i){return t.fromAffine(e(i))}function s(i){const o=i.clearCofactor();return o.equals(t.ZERO)?t.ZERO:(o.assertValidity(),o)}return{defaults:n,hashToCurve(i,o){const c=Object.assign({},n,o),a=Gs(i,2,c),u=r(a[0]),l=r(a[1]);return s(u.add(l))},encodeToCurve(i,o){const c=n.encodeDST?{DST:n.encodeDST}:{},a=Object.assign({},n,c,o),u=Gs(i,1,a),l=r(u[0]);return s(l)},mapToCurve(i){if(!Array.isArray(i))throw new Error("expected array of bigints");for(const o of i)if(typeof o!="bigint")throw new Error("expected array of bigints");return s(r(i))},hashToScalar(i,o){const c=t.Fn.ORDER,a=Object.assign({},n,{p:c,m:1,DST:Ru},o);return Gs(i,1,a)[0][0]}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const So=(t,e)=>(t+(t>=0?e:-e)/at)/e;function Uu(t,e,n){const[[r,s],[i,o]]=e,c=So(o*t,n),a=So(-s*t,n);let u=t-c*r-a*i,l=-c*s-a*o;const d=u<Kt,f=l<Kt;d&&(u=-u),f&&(l=-l);const h=on(Math.ceil(yr(n)/2))+Ee;if(u<Kt||u>=h||l<Kt||l>=h)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:d,k1:u,k2neg:f,k2:l}}const Kt=BigInt(0),Ee=BigInt(1),at=BigInt(2),mn=BigInt(3),di=BigInt(4);function us(t,e){const{BYTES:n}=t;let r;if(typeof e=="bigint")r=e;else{let s=Ie("private key",e);try{r=t.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof e}`)}}if(!t.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function qu(t,e={}){const n=xc("weierstrass",t,e),{Fp:r,Fn:s}=n;let i=n.CURVE;const{h:o,n:c}=i;Ur(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:a}=e;if(a&&(!r.is0(i.a)||typeof a.beta!="bigint"||!Array.isArray(a.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const u=Du(r,s);function l(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(C,x,I){const{x:$,y:M}=x.toAffine(),F=r.toBytes($);if(lr(I,"isCompressed"),I){l();const O=!r.isOdd(M);return z(Mu(O),F)}else return z(Uint8Array.of(4),F,r.toBytes(M))}function f(C){An(C,void 0,"Point");const{publicKey:x,publicKeyUncompressed:I}=u,$=C.length,M=C[0],F=C.subarray(1);if($===x&&(M===2||M===3)){const O=r.fromBytes(F);if(!r.isValid(O))throw new Error("bad point: is not on curve, wrong x");const N=b(O);let q;try{q=r.sqrt(N)}catch(ye){const ae=ye instanceof Error?": "+ye.message:"";throw new Error("bad point: is not on curve, sqrt error"+ae)}l();const L=r.isOdd(q);return(M&1)===1!==L&&(q=r.neg(q)),{x:O,y:q}}else if($===I&&M===4){const O=r.BYTES,N=r.fromBytes(F.subarray(0,O)),q=r.fromBytes(F.subarray(O,O*2));if(!g(N,q))throw new Error("bad point: is not on curve");return{x:N,y:q}}else throw new Error(`bad point: got length ${$}, expected compressed=${x} or uncompressed=${I}`)}const h=e.toBytes||d,y=e.fromBytes||f;function b(C){const x=r.sqr(C),I=r.mul(x,C);return r.add(r.add(I,r.mul(C,i.a)),i.b)}function g(C,x){const I=r.sqr(x),$=b(C);return r.eql(I,$)}if(!g(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const p=r.mul(r.pow(i.a,mn),di),_=r.mul(r.sqr(i.b),BigInt(27));if(r.is0(r.add(p,_)))throw new Error("bad curve params: a or b");function m(C,x,I=!1){if(!r.isValid(x)||I&&r.is0(x))throw new Error(`bad point coordinate ${C}`);return x}function v(C){if(!(C instanceof w))throw new Error("ProjectivePoint expected")}function A(C){if(!a||!a.basises)throw new Error("no endo");return Uu(C,a.basises,s.ORDER)}const T=br((C,x)=>{const{X:I,Y:$,Z:M}=C;if(r.eql(M,r.ONE))return{x:I,y:$};const F=C.is0();x==null&&(x=F?r.ONE:r.inv(M));const O=r.mul(I,x),N=r.mul($,x),q=r.mul(M,x);if(F)return{x:r.ZERO,y:r.ZERO};if(!r.eql(q,r.ONE))throw new Error("invZ was invalid");return{x:O,y:N}}),S=br(C=>{if(C.is0()){if(e.allowInfinityPoint&&!r.is0(C.Y))return;throw new Error("bad point: ZERO")}const{x,y:I}=C.toAffine();if(!r.isValid(x)||!r.isValid(I))throw new Error("bad point: x or y not field elements");if(!g(x,I))throw new Error("bad point: equation left != right");if(!C.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function R(C,x,I,$,M){return I=new w(r.mul(I.X,C),I.Y,I.Z),x=fs($,x),I=fs(M,I),x.add(I)}class w{constructor(x,I,$){this.X=m("x",x),this.Y=m("y",I,!0),this.Z=m("z",$),Object.freeze(this)}static CURVE(){return i}static fromAffine(x){const{x:I,y:$}=x||{};if(!x||!r.isValid(I)||!r.isValid($))throw new Error("invalid affine point");if(x instanceof w)throw new Error("projective point not allowed");return r.is0(I)&&r.is0($)?w.ZERO:new w(I,$,r.ONE)}static fromBytes(x){const I=w.fromAffine(y(An(x,void 0,"point")));return I.assertValidity(),I}static fromHex(x){return w.fromBytes(Ie("pointHex",x))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(x=8,I=!0){return U.createCache(this,x),I||this.multiply(mn),this}assertValidity(){S(this)}hasEvenY(){const{y:x}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(x)}equals(x){v(x);const{X:I,Y:$,Z:M}=this,{X:F,Y:O,Z:N}=x,q=r.eql(r.mul(I,N),r.mul(F,M)),L=r.eql(r.mul($,N),r.mul(O,M));return q&&L}negate(){return new w(this.X,r.neg(this.Y),this.Z)}double(){const{a:x,b:I}=i,$=r.mul(I,mn),{X:M,Y:F,Z:O}=this;let N=r.ZERO,q=r.ZERO,L=r.ZERO,V=r.mul(M,M),ye=r.mul(F,F),ae=r.mul(O,O),W=r.mul(M,F);return W=r.add(W,W),L=r.mul(M,O),L=r.add(L,L),N=r.mul(x,L),q=r.mul($,ae),q=r.add(N,q),N=r.sub(ye,q),q=r.add(ye,q),q=r.mul(N,q),N=r.mul(W,N),L=r.mul($,L),ae=r.mul(x,ae),W=r.sub(V,ae),W=r.mul(x,W),W=r.add(W,L),L=r.add(V,V),V=r.add(L,V),V=r.add(V,ae),V=r.mul(V,W),q=r.add(q,V),ae=r.mul(F,O),ae=r.add(ae,ae),V=r.mul(ae,W),N=r.sub(N,V),L=r.mul(ae,ye),L=r.add(L,L),L=r.add(L,L),new w(N,q,L)}add(x){v(x);const{X:I,Y:$,Z:M}=this,{X:F,Y:O,Z:N}=x;let q=r.ZERO,L=r.ZERO,V=r.ZERO;const ye=i.a,ae=r.mul(i.b,mn);let W=r.mul(I,F),ke=r.mul($,O),je=r.mul(M,N),cn=r.add(I,$),_e=r.add(F,O);cn=r.mul(cn,_e),_e=r.add(W,ke),cn=r.sub(cn,_e),_e=r.add(I,M);let Xe=r.add(F,N);return _e=r.mul(_e,Xe),Xe=r.add(W,je),_e=r.sub(_e,Xe),Xe=r.add($,M),q=r.add(O,N),Xe=r.mul(Xe,q),q=r.add(ke,je),Xe=r.sub(Xe,q),V=r.mul(ye,_e),q=r.mul(ae,je),V=r.add(q,V),q=r.sub(ke,V),V=r.add(ke,V),L=r.mul(q,V),ke=r.add(W,W),ke=r.add(ke,W),je=r.mul(ye,je),_e=r.mul(ae,_e),ke=r.add(ke,je),je=r.sub(W,je),je=r.mul(ye,je),_e=r.add(_e,je),W=r.mul(ke,_e),L=r.add(L,W),W=r.mul(Xe,_e),q=r.mul(cn,q),q=r.sub(q,W),W=r.mul(cn,ke),V=r.mul(Xe,V),V=r.add(V,W),new w(q,L,V)}subtract(x){return this.add(x.negate())}is0(){return this.equals(w.ZERO)}multiply(x){const{endo:I}=e;if(!s.isValidNot0(x))throw new Error("invalid scalar: out of range");let $,M;const F=O=>U.cached(this,O,N=>dt(w,N));if(I){const{k1neg:O,k1:N,k2neg:q,k2:L}=A(x),{p:V,f:ye}=F(N),{p:ae,f:W}=F(L);M=ye.add(W),$=R(I.beta,V,ae,O,q)}else{const{p:O,f:N}=F(x);$=O,M=N}return dt(w,[$,M])[0]}multiplyUnsafe(x){const{endo:I}=e,$=this;if(!s.isValid(x))throw new Error("invalid scalar: out of range");if(x===Kt||$.is0())return w.ZERO;if(x===Ee)return $;if(U.hasCache(this))return this.multiply(x);if(I){const{k1neg:M,k1:F,k2neg:O,k2:N}=A(x),{p1:q,p2:L}=Su(w,$,F,N);return R(I.beta,q,L,M,O)}else return U.unsafe($,x)}multiplyAndAddUnsafe(x,I,$){const M=this.multiplyUnsafe(I).add(x.multiplyUnsafe($));return M.is0()?void 0:M}toAffine(x){return T(this,x)}isTorsionFree(){const{isTorsionFree:x}=e;return o===Ee?!0:x?x(w,this):U.unsafe(this,c).is0()}clearCofactor(){const{clearCofactor:x}=e;return o===Ee?this:x?x(w,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(x=!0){return lr(x,"isCompressed"),this.assertValidity(),h(w,this,x)}toHex(x=!0){return J(this.toBytes(x))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(x=!0){return this.toBytes(x)}_setWindowSize(x){this.precompute(x)}static normalizeZ(x){return dt(w,x)}static msm(x,I){return wc(w,s,x,I)}static fromPrivateKey(x){return w.BASE.multiply(us(s,x))}}w.BASE=new w(i.Gx,i.Gy,r.ONE),w.ZERO=new w(r.ZERO,r.ONE,r.ZERO),w.Fp=r,w.Fn=s;const B=s.BITS,U=new gc(w,e.endo?Math.ceil(B/2):B);return w.BASE.precompute(8),w}function Mu(t){return Uint8Array.of(t?2:3)}function Pu(t,e){const n=t.ORDER;let r=Kt;for(let y=n-Ee;y%at===Kt;y/=at)r+=Ee;const s=r,i=at<<s-Ee-Ee,o=i*at,c=(n-Ee)/o,a=(c-Ee)/at,u=o-Ee,l=i,d=t.pow(e,c),f=t.pow(e,(c+Ee)/at);let h=(y,b)=>{let g=d,p=t.pow(b,u),_=t.sqr(p);_=t.mul(_,b);let m=t.mul(y,_);m=t.pow(m,a),m=t.mul(m,p),p=t.mul(m,b),_=t.mul(m,y);let v=t.mul(_,p);m=t.pow(v,l);let A=t.eql(m,t.ONE);p=t.mul(_,f),m=t.mul(v,g),_=t.cmov(p,_,A),v=t.cmov(m,v,A);for(let T=s;T>Ee;T--){let S=T-at;S=at<<S-Ee;let R=t.pow(v,S);const w=t.eql(R,t.ONE);p=t.mul(_,g),g=t.mul(g,g),R=t.mul(v,g),_=t.cmov(p,_,w),v=t.cmov(R,v,w)}return{isValid:A,value:_}};if(t.ORDER%di===mn){const y=(t.ORDER-mn)/di,b=t.sqrt(t.neg(e));h=(g,p)=>{let _=t.sqr(p);const m=t.mul(g,p);_=t.mul(_,m);let v=t.pow(_,y);v=t.mul(v,m);const A=t.mul(v,b),T=t.mul(t.sqr(v),p),S=t.eql(T,g);let R=t.cmov(A,v,S);return{isValid:S,value:R}}}return h}function vc(t,e){hc(t);const{A:n,B:r,Z:s}=e;if(!t.isValid(n)||!t.isValid(r)||!t.isValid(s))throw new Error("mapToCurveSimpleSWU: invalid opts");const i=Pu(t,s);if(!t.isOdd)throw new Error("Field does not have .isOdd()");return o=>{let c,a,u,l,d,f,h,y;c=t.sqr(o),c=t.mul(c,s),a=t.sqr(c),a=t.add(a,c),u=t.add(a,t.ONE),u=t.mul(u,r),l=t.cmov(s,t.neg(a),!t.eql(a,t.ZERO)),l=t.mul(l,n),a=t.sqr(u),f=t.sqr(l),d=t.mul(f,n),a=t.add(a,d),a=t.mul(a,u),f=t.mul(f,l),d=t.mul(f,r),a=t.add(a,d),h=t.mul(c,u);const{isValid:b,value:g}=i(a,f);y=t.mul(c,o),y=t.mul(y,g),h=t.cmov(h,u,b),y=t.cmov(y,g,b);const p=t.isOdd(o)===t.isOdd(y);y=t.cmov(t.neg(y),y,p);const _=an(t,[l],!0)[0];return h=t.mul(h,_),{x:h,y}}}function Du(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function Co(t){const{CURVE:e,curveOpts:n}=Lu(t),r=qu(e,n);return ku(t,r)}function Lu(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp;let r=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=Lt(e.n,{BITS:t.nBitLength,allowedLengths:r,modFromBytes:t.wrapPrivateKey}),i={Fp:n,Fn:s,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}function Vu(t,e,n){function r(s){const i=t.sqr(s),o=t.mul(i,s);return t.add(t.add(o,t.mul(s,e)),n)}return r}function ku(t,e){const{Fp:n,Fn:r}=e;function s(o){return sc(o,Ee,r.ORDER)}const i=Vu(n,t.a,t.b);return Object.assign({},{CURVE:t,Point:e,ProjectivePoint:e,normPrivateKeyToScalar:o=>us(r,o),weierstrassEquation:i,isWithinCurveOrder:s})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ju=BigInt(0),Fr=BigInt(1),Oo=BigInt(2),gn=BigInt(3);function Fu(t){const e=[];for(;t>Fr;t>>=Fr)(t&Fr)===ju?e.unshift(0):(t&gn)===gn?(e.unshift(-1),t+=Fr):e.unshift(1);return e}function Zs(t){if(!Array.isArray(t)||t.length===0)throw new Error("expected non-empty array")}function Hu(t,e,n,r){const{Fp2:s,Fp12:i}=t,{twistType:o,ateLoopSize:c,xNegative:a,postPrecompute:u}=r;let l;if(o==="multiplicative")l=(m,v,A,T,S,R)=>i.mul014(T,m,s.mul(v,S),s.mul(A,R));else if(o==="divisive")l=(m,v,A,T,S,R)=>i.mul034(T,s.mul(A,R),s.mul(v,S),m);else throw new Error("bls: unknown twist type");const d=s.div(s.ONE,s.mul(s.ONE,Oo));function f(m,v,A,T){const S=s.sqr(A),R=s.sqr(T),w=s.mulByB(s.mul(R,gn)),B=s.mul(w,gn),U=s.sub(s.sub(s.sqr(s.add(A,T)),R),S),C=s.sub(w,S),x=s.mul(s.sqr(v),gn),I=s.neg(U);return m.push([C,x,I]),v=s.mul(s.mul(s.mul(s.sub(S,B),v),A),d),A=s.sub(s.sqr(s.mul(s.add(S,B),d)),s.mul(s.sqr(w),gn)),T=s.mul(S,U),{Rx:v,Ry:A,Rz:T}}function h(m,v,A,T,S,R){const w=s.sub(A,s.mul(R,T)),B=s.sub(v,s.mul(S,T)),U=s.sub(s.mul(w,S),s.mul(B,R)),C=s.neg(w),x=B;m.push([U,C,x]);const I=s.sqr(B),$=s.mul(I,B),M=s.mul(I,v),F=s.add(s.sub($,s.mul(M,Oo)),s.mul(s.sqr(w),T));return v=s.mul(B,F),A=s.sub(s.mul(s.sub(M,F),w),s.mul($,A)),T=s.mul(T,$),{Rx:v,Ry:A,Rz:T}}const y=Fu(c),b=br(m=>{const v=m,{x:A,y:T}=v.toAffine(),S=A,R=T,w=s.neg(T);let B=S,U=R,C=s.ONE;const x=[];for(const I of y){const $=[];({Rx:B,Ry:U,Rz:C}=f($,B,U,C)),I&&({Rx:B,Ry:U,Rz:C}=h($,B,U,C,S,I===-1?w:R)),x.push($)}if(u){const I=x[x.length-1];u(B,U,C,S,R,h.bind(null,I))}return x});function g(m,v=!1){let A=i.ONE;if(m.length){const T=m[0][0].length;for(let S=0;S<T;S++){A=i.sqr(A);for(const[R,w,B]of m)for(const[U,C,x]of R[S])A=l(U,C,x,A,w,B)}}return a&&(A=i.conjugate(A)),v?i.finalExponentiate(A):A}function p(m,v=!0){const A=[];dt(e,m.map(({g1:T})=>T)),dt(n,m.map(({g2:T})=>T));for(const{g1:T,g2:S}of m){if(T.is0()||S.is0())throw new Error("pairing is not available for ZERO point");T.assertValidity(),S.assertValidity();const R=T.toAffine();A.push([b(S),R.x,R.y])}return g(A,v)}function _(m,v,A=!0){return p([{g1:m,g2:v}],A)}return{Fp12:i,millerLoopBatch:g,pairing:_,pairingBatch:p,calcPairingPrecomputes:b}}function $o(t,e,n,r,s){const{Fp12:i,pairingBatch:o}=t;function c(d){return d instanceof e.Point?d:e.Point.fromHex(d)}function a(d){return d instanceof n.Point?d:n.Point.fromHex(d)}function u(d){if(!(d instanceof n.Point))throw new Error(`expected valid message hashed to ${s?"G1":"G2"} curve`);return d}const l=s?(d,f)=>({g1:f,g2:d}):(d,f)=>({g1:d,g2:f});return{getPublicKey(d){const f=us(e.Point.Fn,d);return e.Point.BASE.multiply(f)},sign(d,f,h){if(h!=null)throw new Error("sign() expects 2 arguments");const y=us(e.Point.Fn,f);return u(d).assertValidity(),d.multiply(y)},verify(d,f,h,y){if(y!=null)throw new Error("verify() expects 3 arguments");d=a(d),h=c(h);const b=h.negate(),g=e.Point.BASE,p=u(f),_=d,m=o([l(b,p),l(g,_)]);return i.eql(m,i.ONE)},verifyBatch(d,f,h){if(Zs(f),h.length!==f.length)throw new Error("amount of public keys and messages should be equal");const y=a(d),b=f,g=h.map(c),p=new Map;for(let v=0;v<g.length;v++){const A=g[v],T=b[v];let S=p.get(T);S===void 0&&(S=[],p.set(T,S)),S.push(A)}const _=[],m=e.Point.BASE;try{for(const[v,A]of p){const T=A.reduce((S,R)=>S.add(R));_.push(l(T,v))}return _.push(l(m.negate(),y)),i.eql(o(_),i.ONE)}catch{return!1}},aggregatePublicKeys(d){Zs(d),d=d.map(h=>c(h));const f=d.reduce((h,y)=>h.add(y),e.Point.ZERO);return f.assertValidity(),f},aggregateSignatures(d){Zs(d),d=d.map(h=>a(h));const f=d.reduce((h,y)=>h.add(y),n.Point.ZERO);return f.assertValidity(),f},hash(d,f){Pe(d);const h=f?{DST:f}:void 0;return n.hashToCurve(d,h)},Signature:r}}function Gu(t){const{Fp:e,Fr:n,Fp2:r,Fp6:s,Fp12:i}=t.fields,o=Co(t.G1),c=Object.assign(o,To(o.Point,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),a=Co(t.G2),u=Object.assign(a,To(a.Point,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults})),l=Hu(t.fields,c.Point,u.Point,{...t.params,postPrecompute:t.postPrecompute}),{millerLoopBatch:d,pairing:f,pairingBatch:h,calcPairingPrecomputes:y}=l,b=$o(l,c,u,t.G2.Signature,!1),g=$o(l,u,c,t.G1.ShortSignature,!0),p=t.randomBytes||ca,_=()=>{const O=bc(n.ORDER);return Au(p(O),n.ORDER)},m={randomSecretKey:_,randomPrivateKey:_,calcPairingPrecomputes:y},{ShortSignature:v}=t.G1,{Signature:A}=t.G2;function T(O,N){return O instanceof c.Point?O:g.hash(Ie("point",O),N==null?void 0:N.DST)}function S(O,N){return O instanceof u.Point?O:b.hash(Ie("point",O),N==null?void 0:N.DST)}function R(O){return b.getPublicKey(O).toBytes(!0)}function w(O){return g.getPublicKey(O).toBytes(!0)}function B(O,N,q){const L=S(O,q),V=b.sign(L,N);return O instanceof u.Point?V:A.toBytes(V)}function U(O,N,q){const L=T(O,q),V=g.sign(L,N);return O instanceof c.Point?V:v.toBytes(V)}function C(O,N,q,L){const V=S(N,L);return b.verify(O,V,q)}function x(O,N,q,L){const V=T(N,L);return g.verify(O,V,q)}function I(O){const N=b.aggregatePublicKeys(O);return O[0]instanceof c.Point?N:N.toBytes(!0)}function $(O){const N=b.aggregateSignatures(O);return O[0]instanceof u.Point?N:A.toBytes(N)}function M(O){const N=g.aggregateSignatures(O);return O[0]instanceof c.Point?N:v.toBytes(N)}function F(O,N,q,L){const V=N.map(ye=>S(ye,L));return b.verifyBatch(O,V,q)}return c.Point.BASE.precompute(4),{longSignatures:b,shortSignatures:g,millerLoopBatch:d,pairing:f,pairingBatch:h,verifyBatch:F,fields:{Fr:n,Fp:e,Fp2:r,Fp6:s,Fp12:i},params:{ateLoopSize:t.params.ateLoopSize,twistType:t.params.twistType,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:m,getPublicKey:R,getPublicKeyForShortSignatures:w,sign:B,signShortSignature:U,verify:C,verifyShortSignature:x,aggregatePublicKeys:I,aggregateSignatures:$,aggregateShortSignatures:M,G1:c,G2:u,Signature:A,ShortSignature:v}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const No=BigInt(0),lt=BigInt(1),ve=BigInt(2),Ro=BigInt(3);function Yi(t,e,n,r,s=1,i){const o=BigInt(i===void 0?r:i),c=n**BigInt(r),a=[];for(let u=0;u<s;u++){const l=BigInt(u+1),d=[];for(let f=0,h=lt;f<r;f++){const y=(l*h-l)/o%c;d.push(t.pow(e,y)),h*=n}a.push(d)}return a}function Zu(t,e,n){const r=e.pow(n,(t.ORDER-lt)/Ro),s=e.pow(n,(t.ORDER-lt)/ve);function i(f,h){const y=e.mul(e.frobeniusMap(f,1),r),b=e.mul(e.frobeniusMap(h,1),s);return[y,b]}const o=e.pow(n,(t.ORDER**ve-lt)/Ro),c=e.pow(n,(t.ORDER**ve-lt)/ve);if(!e.eql(c,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function a(f,h){return[e.mul(f,o),e.neg(h)]}const u=f=>(h,y)=>{const b=y.toAffine(),g=f(b.x,b.y);return h.fromAffine({x:g[0],y:g[1]})},l=u(i),d=u(a);return{psi:i,psi2:a,G2psi:l,G2psi2:d,PSI_X:r,PSI_Y:s,PSI2_X:o,PSI2_Y:c}}const Uo=(t,e)=>{if(e.length!==2)throw new Error("invalid tuple");const n=e.map(r=>t.create(r));return{c0:n[0],c1:n[1]}};class Ku{constructor(e,n={}){this.MASK=lt;const r=e.ORDER,s=r*r;this.Fp=e,this.ORDER=s,this.BITS=yr(s),this.BYTES=Math.ceil(yr(s)/8),this.isLE=e.isLE,this.ZERO={c0:e.ZERO,c1:e.ZERO},this.ONE={c0:e.ONE,c1:e.ZERO},this.Fp_NONRESIDUE=e.create(n.NONRESIDUE||BigInt(-1)),this.Fp_div2=e.div(e.ONE,ve),this.NONRESIDUE=Uo(e,n.FP2_NONRESIDUE),this.FROBENIUS_COEFFICIENTS=Yi(e,this.Fp_NONRESIDUE,e.ORDER,2)[0],this.mulByB=n.Fp2mulByB,Object.seal(this)}fromBigTuple(e){return Uo(this.Fp,e)}create(e){return e}isValid({c0:e,c1:n}){function r(s,i){return typeof s=="bigint"&&No<=s&&s<i}return r(e,this.ORDER)&&r(n,this.ORDER)}is0({c0:e,c1:n}){return this.Fp.is0(e)&&this.Fp.is0(n)}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}eql({c0:e,c1:n},{c0:r,c1:s}){return this.Fp.eql(e,r)&&this.Fp.eql(n,s)}neg({c0:e,c1:n}){return{c0:this.Fp.neg(e),c1:this.Fp.neg(n)}}pow(e,n){return Ts(this,e,n)}invertBatch(e){return an(this,e)}add(e,n){const{c0:r,c1:s}=e,{c0:i,c1:o}=n;return{c0:this.Fp.add(r,i),c1:this.Fp.add(s,o)}}sub({c0:e,c1:n},{c0:r,c1:s}){return{c0:this.Fp.sub(e,r),c1:this.Fp.sub(n,s)}}mul({c0:e,c1:n},r){const{Fp:s}=this;if(typeof r=="bigint")return{c0:s.mul(e,r),c1:s.mul(n,r)};const{c0:i,c1:o}=r;let c=s.mul(e,i),a=s.mul(n,o);const u=s.sub(c,a),l=s.sub(s.mul(s.add(e,n),s.add(i,o)),s.add(c,a));return{c0:u,c1:l}}sqr({c0:e,c1:n}){const{Fp:r}=this,s=r.add(e,n),i=r.sub(e,n),o=r.add(e,e);return{c0:r.mul(s,i),c1:r.mul(o,n)}}addN(e,n){return this.add(e,n)}subN(e,n){return this.sub(e,n)}mulN(e,n){return this.mul(e,n)}sqrN(e){return this.sqr(e)}div(e,n){const{Fp:r}=this;return this.mul(e,typeof n=="bigint"?r.inv(r.create(n)):this.inv(n))}inv({c0:e,c1:n}){const{Fp:r}=this,s=r.inv(r.create(e*e+n*n));return{c0:r.mul(s,r.create(e)),c1:r.mul(s,r.create(-n))}}sqrt(e){const{Fp:n}=this,r=this,{c0:s,c1:i}=e;if(n.is0(i))return cs(n,s)===1?r.create({c0:n.sqrt(s),c1:n.ZERO}):r.create({c0:n.ZERO,c1:n.sqrt(n.div(s,this.Fp_NONRESIDUE))});const o=n.sqrt(n.sub(n.sqr(s),n.mul(n.sqr(i),this.Fp_NONRESIDUE)));let c=n.mul(n.add(o,s),this.Fp_div2);cs(n,c)===-1&&(c=n.sub(c,o));const u=n.sqrt(c),l=r.create({c0:u,c1:n.div(n.mul(i,this.Fp_div2),u)});if(!r.eql(r.sqr(l),e))throw new Error("Cannot find square root");const d=l,f=r.neg(d),{re:h,im:y}=r.reim(d),{re:b,im:g}=r.reim(f);return y>g||y===g&&h>b?d:f}isOdd(e){const{re:n,im:r}=this.reim(e),s=n%ve,i=n===No,o=r%ve;return BigInt(s||i&&o)==lt}fromBytes(e){const{Fp:n}=this;if(e.length!==this.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:n.fromBytes(e.subarray(0,n.BYTES)),c1:n.fromBytes(e.subarray(n.BYTES))}}toBytes({c0:e,c1:n}){return z(this.Fp.toBytes(e),this.Fp.toBytes(n))}cmov({c0:e,c1:n},{c0:r,c1:s},i){return{c0:this.Fp.cmov(e,r,i),c1:this.Fp.cmov(n,s,i)}}reim({c0:e,c1:n}){return{re:e,im:n}}Fp4Square(e,n){const r=this,s=r.sqr(e),i=r.sqr(n);return{first:r.add(r.mulByNonresidue(i),s),second:r.sub(r.sub(r.sqr(r.add(e,n)),s),i)}}mulByNonresidue({c0:e,c1:n}){return this.mul({c0:e,c1:n},this.NONRESIDUE)}frobeniusMap({c0:e,c1:n},r){return{c0:e,c1:this.Fp.mul(n,this.FROBENIUS_COEFFICIENTS[r%2])}}}class Yu{constructor(e){this.MASK=lt,this.Fp2=e,this.ORDER=e.ORDER,this.BITS=3*e.BITS,this.BYTES=3*e.BYTES,this.isLE=e.isLE,this.ZERO={c0:e.ZERO,c1:e.ZERO,c2:e.ZERO},this.ONE={c0:e.ONE,c1:e.ZERO,c2:e.ZERO};const{Fp:n}=e,r=Yi(e,e.NONRESIDUE,n.ORDER,6,2,3);this.FROBENIUS_COEFFICIENTS_1=r[0],this.FROBENIUS_COEFFICIENTS_2=r[1],Object.seal(this)}add({c0:e,c1:n,c2:r},{c0:s,c1:i,c2:o}){const{Fp2:c}=this;return{c0:c.add(e,s),c1:c.add(n,i),c2:c.add(r,o)}}sub({c0:e,c1:n,c2:r},{c0:s,c1:i,c2:o}){const{Fp2:c}=this;return{c0:c.sub(e,s),c1:c.sub(n,i),c2:c.sub(r,o)}}mul({c0:e,c1:n,c2:r},s){const{Fp2:i}=this;if(typeof s=="bigint")return{c0:i.mul(e,s),c1:i.mul(n,s),c2:i.mul(r,s)};const{c0:o,c1:c,c2:a}=s,u=i.mul(e,o),l=i.mul(n,c),d=i.mul(r,a);return{c0:i.add(u,i.mulByNonresidue(i.sub(i.mul(i.add(n,r),i.add(c,a)),i.add(l,d)))),c1:i.add(i.sub(i.mul(i.add(e,n),i.add(o,c)),i.add(u,l)),i.mulByNonresidue(d)),c2:i.sub(i.add(l,i.mul(i.add(e,r),i.add(o,a))),i.add(u,d))}}sqr({c0:e,c1:n,c2:r}){const{Fp2:s}=this;let i=s.sqr(e),o=s.mul(s.mul(e,n),ve),c=s.mul(s.mul(n,r),ve),a=s.sqr(r);return{c0:s.add(s.mulByNonresidue(c),i),c1:s.add(s.mulByNonresidue(a),o),c2:s.sub(s.sub(s.add(s.add(o,s.sqr(s.add(s.sub(e,n),r))),c),i),a)}}addN(e,n){return this.add(e,n)}subN(e,n){return this.sub(e,n)}mulN(e,n){return this.mul(e,n)}sqrN(e){return this.sqr(e)}create(e){return e}isValid({c0:e,c1:n,c2:r}){const{Fp2:s}=this;return s.isValid(e)&&s.isValid(n)&&s.isValid(r)}is0({c0:e,c1:n,c2:r}){const{Fp2:s}=this;return s.is0(e)&&s.is0(n)&&s.is0(r)}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}neg({c0:e,c1:n,c2:r}){const{Fp2:s}=this;return{c0:s.neg(e),c1:s.neg(n),c2:s.neg(r)}}eql({c0:e,c1:n,c2:r},{c0:s,c1:i,c2:o}){const{Fp2:c}=this;return c.eql(e,s)&&c.eql(n,i)&&c.eql(r,o)}sqrt(e){return ic()}div(e,n){const{Fp2:r}=this,{Fp:s}=r;return this.mul(e,typeof n=="bigint"?s.inv(s.create(n)):this.inv(n))}pow(e,n){return Ts(this,e,n)}invertBatch(e){return an(this,e)}inv({c0:e,c1:n,c2:r}){const{Fp2:s}=this;let i=s.sub(s.sqr(e),s.mulByNonresidue(s.mul(r,n))),o=s.sub(s.mulByNonresidue(s.sqr(r)),s.mul(e,n)),c=s.sub(s.sqr(n),s.mul(e,r)),a=s.inv(s.add(s.mulByNonresidue(s.add(s.mul(r,o),s.mul(n,c))),s.mul(e,i)));return{c0:s.mul(a,i),c1:s.mul(a,o),c2:s.mul(a,c)}}fromBytes(e){const{Fp2:n}=this;if(e.length!==this.BYTES)throw new Error("fromBytes invalid length="+e.length);const r=n.BYTES;return{c0:n.fromBytes(e.subarray(0,r)),c1:n.fromBytes(e.subarray(r,r*2)),c2:n.fromBytes(e.subarray(2*r))}}toBytes({c0:e,c1:n,c2:r}){const{Fp2:s}=this;return z(s.toBytes(e),s.toBytes(n),s.toBytes(r))}cmov({c0:e,c1:n,c2:r},{c0:s,c1:i,c2:o},c){const{Fp2:a}=this;return{c0:a.cmov(e,s,c),c1:a.cmov(n,i,c),c2:a.cmov(r,o,c)}}fromBigSix(e){const{Fp2:n}=this;if(!Array.isArray(e)||e.length!==6)throw new Error("invalid Fp6 usage");return{c0:n.fromBigTuple(e.slice(0,2)),c1:n.fromBigTuple(e.slice(2,4)),c2:n.fromBigTuple(e.slice(4,6))}}frobeniusMap({c0:e,c1:n,c2:r},s){const{Fp2:i}=this;return{c0:i.frobeniusMap(e,s),c1:i.mul(i.frobeniusMap(n,s),this.FROBENIUS_COEFFICIENTS_1[s%6]),c2:i.mul(i.frobeniusMap(r,s),this.FROBENIUS_COEFFICIENTS_2[s%6])}}mulByFp2({c0:e,c1:n,c2:r},s){const{Fp2:i}=this;return{c0:i.mul(e,s),c1:i.mul(n,s),c2:i.mul(r,s)}}mulByNonresidue({c0:e,c1:n,c2:r}){const{Fp2:s}=this;return{c0:s.mulByNonresidue(r),c1:e,c2:n}}mul1({c0:e,c1:n,c2:r},s){const{Fp2:i}=this;return{c0:i.mulByNonresidue(i.mul(r,s)),c1:i.mul(e,s),c2:i.mul(n,s)}}mul01({c0:e,c1:n,c2:r},s,i){const{Fp2:o}=this;let c=o.mul(e,s),a=o.mul(n,i);return{c0:o.add(o.mulByNonresidue(o.sub(o.mul(o.add(n,r),i),a)),c),c1:o.sub(o.sub(o.mul(o.add(s,i),o.add(e,n)),c),a),c2:o.add(o.sub(o.mul(o.add(e,r),s),c),a)}}}class zu{constructor(e,n){this.MASK=lt;const{Fp2:r}=e,{Fp:s}=r;this.Fp6=e,this.ORDER=r.ORDER,this.BITS=2*e.BITS,this.BYTES=2*e.BYTES,this.isLE=e.isLE,this.ZERO={c0:e.ZERO,c1:e.ZERO},this.ONE={c0:e.ONE,c1:e.ZERO},this.FROBENIUS_COEFFICIENTS=Yi(r,r.NONRESIDUE,s.ORDER,12,1,6)[0],this.X_LEN=n.X_LEN,this.finalExponentiate=n.Fp12finalExponentiate}create(e){return e}isValid({c0:e,c1:n}){const{Fp6:r}=this;return r.isValid(e)&&r.isValid(n)}is0({c0:e,c1:n}){const{Fp6:r}=this;return r.is0(e)&&r.is0(n)}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}neg({c0:e,c1:n}){const{Fp6:r}=this;return{c0:r.neg(e),c1:r.neg(n)}}eql({c0:e,c1:n},{c0:r,c1:s}){const{Fp6:i}=this;return i.eql(e,r)&&i.eql(n,s)}sqrt(e){ic()}inv({c0:e,c1:n}){const{Fp6:r}=this;let s=r.inv(r.sub(r.sqr(e),r.mulByNonresidue(r.sqr(n))));return{c0:r.mul(e,s),c1:r.neg(r.mul(n,s))}}div(e,n){const{Fp6:r}=this,{Fp2:s}=r,{Fp:i}=s;return this.mul(e,typeof n=="bigint"?i.inv(i.create(n)):this.inv(n))}pow(e,n){return Ts(this,e,n)}invertBatch(e){return an(this,e)}add({c0:e,c1:n},{c0:r,c1:s}){const{Fp6:i}=this;return{c0:i.add(e,r),c1:i.add(n,s)}}sub({c0:e,c1:n},{c0:r,c1:s}){const{Fp6:i}=this;return{c0:i.sub(e,r),c1:i.sub(n,s)}}mul({c0:e,c1:n},r){const{Fp6:s}=this;if(typeof r=="bigint")return{c0:s.mul(e,r),c1:s.mul(n,r)};let{c0:i,c1:o}=r,c=s.mul(e,i),a=s.mul(n,o);return{c0:s.add(c,s.mulByNonresidue(a)),c1:s.sub(s.mul(s.add(e,n),s.add(i,o)),s.add(c,a))}}sqr({c0:e,c1:n}){const{Fp6:r}=this;let s=r.mul(e,n);return{c0:r.sub(r.sub(r.mul(r.add(r.mulByNonresidue(n),e),r.add(e,n)),s),r.mulByNonresidue(s)),c1:r.add(s,s)}}addN(e,n){return this.add(e,n)}subN(e,n){return this.sub(e,n)}mulN(e,n){return this.mul(e,n)}sqrN(e){return this.sqr(e)}fromBytes(e){const{Fp6:n}=this;if(e.length!==this.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:n.fromBytes(e.subarray(0,n.BYTES)),c1:n.fromBytes(e.subarray(n.BYTES))}}toBytes({c0:e,c1:n}){const{Fp6:r}=this;return z(r.toBytes(e),r.toBytes(n))}cmov({c0:e,c1:n},{c0:r,c1:s},i){const{Fp6:o}=this;return{c0:o.cmov(e,r,i),c1:o.cmov(n,s,i)}}fromBigTwelve(e){const{Fp6:n}=this;return{c0:n.fromBigSix(e.slice(0,6)),c1:n.fromBigSix(e.slice(6,12))}}frobeniusMap(e,n){const{Fp6:r}=this,{Fp2:s}=r,{c0:i,c1:o,c2:c}=r.frobeniusMap(e.c1,n),a=this.FROBENIUS_COEFFICIENTS[n%12];return{c0:r.frobeniusMap(e.c0,n),c1:r.create({c0:s.mul(i,a),c1:s.mul(o,a),c2:s.mul(c,a)})}}mulByFp2({c0:e,c1:n},r){const{Fp6:s}=this;return{c0:s.mulByFp2(e,r),c1:s.mulByFp2(n,r)}}conjugate({c0:e,c1:n}){return{c0:e,c1:this.Fp6.neg(n)}}mul014({c0:e,c1:n},r,s,i){const{Fp6:o}=this,{Fp2:c}=o;let a=o.mul01(e,r,s),u=o.mul1(n,i);return{c0:o.add(o.mulByNonresidue(u),a),c1:o.sub(o.sub(o.mul01(o.add(n,e),r,c.add(s,i)),a),u)}}mul034({c0:e,c1:n},r,s,i){const{Fp6:o}=this,{Fp2:c}=o,a=o.create({c0:c.mul(e.c0,r),c1:c.mul(e.c1,r),c2:c.mul(e.c2,r)}),u=o.mul01(n,s,i),l=o.mul01(o.add(e,n),c.add(r,s),i);return{c0:o.add(o.mulByNonresidue(u),a),c1:o.sub(l,o.add(a,u))}}_cyclotomicSquare({c0:e,c1:n}){const{Fp6:r}=this,{Fp2:s}=r,{c0:i,c1:o,c2:c}=e,{c0:a,c1:u,c2:l}=n,{first:d,second:f}=s.Fp4Square(i,u),{first:h,second:y}=s.Fp4Square(a,c),{first:b,second:g}=s.Fp4Square(o,l),p=s.mulByNonresidue(g);return{c0:r.create({c0:s.add(s.mul(s.sub(d,i),ve),d),c1:s.add(s.mul(s.sub(h,o),ve),h),c2:s.add(s.mul(s.sub(b,c),ve),b)}),c1:r.create({c0:s.add(s.mul(s.add(p,a),ve),p),c1:s.add(s.mul(s.add(f,u),ve),f),c2:s.add(s.mul(s.add(y,l),ve),y)})}}_cyclotomicExp(e,n){let r=this.ONE;for(let s=this.X_LEN-1;s>=0;s--)r=this._cyclotomicSquare(r),bu(n,s)&&(r=this.mul(r,e));return r}}function Xu(t){const e=Lt(t.ORDER),n=new Ku(e,t),r=new Yu(n),s=new zu(r,t);return{Fp:e,Fp2:n,Fp6:r,Fp12:s}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const xe=BigInt(0),ds=BigInt(1),Le=BigInt(2),Ss=BigInt(3),mr=BigInt(4),It=BigInt("0xd201000000010000"),Wu=yr(It),nn={p:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),n:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"),h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),a:xe,b:mr,Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1")},Qu=Lt(nn.n,{modFromBytes:!0,isLE:!0}),{Fp:P,Fp2:H,Fp6:Ju,Fp12:Z}=Xu({ORDER:nn.p,X_LEN:Wu,FP2_NONRESIDUE:[ds,ds],Fp2mulByB:({c0:t,c1:e})=>{const n=P.mul(t,mr),r=P.mul(e,mr);return{c0:P.sub(n,r),c1:P.add(n,r)}},Fp12finalExponentiate:t=>{const e=It,n=Z.div(Z.frobeniusMap(t,6),t),r=Z.mul(Z.frobeniusMap(n,2),n),s=Z.conjugate(Z._cyclotomicExp(r,e)),i=Z.mul(Z.conjugate(Z._cyclotomicSquare(r)),s),o=Z.conjugate(Z._cyclotomicExp(i,e)),c=Z.conjugate(Z._cyclotomicExp(o,e)),a=Z.mul(Z.conjugate(Z._cyclotomicExp(c,e)),Z._cyclotomicSquare(s)),u=Z.conjugate(Z._cyclotomicExp(a,e)),l=Z.frobeniusMap(Z.mul(s,c),2),d=Z.frobeniusMap(Z.mul(o,r),3),f=Z.frobeniusMap(Z.mul(a,Z.conjugate(r)),1),h=Z.mul(Z.mul(u,Z.conjugate(i)),r);return Z.mul(Z.mul(Z.mul(l,d),f),h)}}),{G2psi:qo,G2psi2:ed}=Zu(P,H,H.div(H.ONE,H.NONRESIDUE)),Ks=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:P.ORDER,m:2,k:128,expand:"xmd",hash:Oe}),zi={p:H.ORDER,n:nn.n,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),a:H.ZERO,b:H.fromBigTuple([mr,mr]),Gx:H.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:H.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")])},Cs=qr(P.toBytes(xe),{infinity:!0,compressed:!0});function Os(t){t=t.slice();const e=t[0]&224,n=!!(e>>7&1),r=!!(e>>6&1),s=!!(e>>5&1);return t[0]&=31,{compressed:n,infinity:r,sort:s,value:t}}function qr(t,e){if(t[0]&224)throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function td(t,e,n){const{BYTES:r,ORDER:s}=P,i=e.is0(),{x:o,y:c}=e.toAffine();if(n){if(i)return Cs.slice();const a=!!(c*Le/s);return qr(pe(o,r),{compressed:!0,sort:a})}else return i?z(Uint8Array.of(64),new Uint8Array(2*r-1)):z(pe(o,r),pe(c,r))}function Ys(t){t.assertValidity();const{BYTES:e,ORDER:n}=P,{x:r,y:s}=t.toAffine();if(t.is0())return Cs.slice();const i=!!(s*Le/n);return qr(pe(r,e),{compressed:!0,sort:i})}function nd(t){const{compressed:e,infinity:n,sort:r,value:s}=Os(t),{BYTES:i,ORDER:o}=P;if(s.length===48&&e){const c=rt(s),a=P.create(c&on(P.BITS));if(n){if(a!==xe)throw new Error("invalid G1 point: non-empty, at infinity, with compression");return{x:xe,y:xe}}const u=P.add(P.pow(a,Ss),P.create(nn.b));let l=P.sqrt(u);if(!l)throw new Error("invalid G1 point: compressed point");return l*Le/o!==BigInt(r)&&(l=P.neg(l)),{x:P.create(a),y:P.create(l)}}else if(s.length===96&&!e){const c=rt(s.subarray(0,i)),a=rt(s.subarray(i));if(n){if(c!==xe||a!==xe)throw new Error("G1: non-empty point at infinity");return $s.G1.Point.ZERO.toAffine()}return{x:P.create(c),y:P.create(a)}}else throw new Error("invalid G1 point: expected 48/96 bytes")}function Mo(t){const{infinity:e,sort:n,value:r}=Os(Ie("signatureHex",t,48)),s=P.ORDER,i=$s.G1.Point,o=rt(r);if(e)return i.ZERO;const c=P.create(o&on(P.BITS)),a=P.add(P.pow(c,Ss),P.create(nn.b));let u=P.sqrt(a);if(!u)throw new Error("invalid G1 point: compressed");const l=BigInt(n);u*Le/s!==l&&(u=P.neg(u));const d=i.fromAffine({x:c,y:u});return d.assertValidity(),d}function rd(t,e,n){const{BYTES:r,ORDER:s}=P,i=e.is0(),{x:o,y:c}=e.toAffine();if(n){if(i)return z(Cs,pe(xe,r));const a=!!(c.c1===xe?c.c0*Le/s:c.c1*Le/s);return z(qr(pe(o.c1,r),{compressed:!0,sort:a}),pe(o.c0,r))}else{if(i)return z(Uint8Array.of(64),new Uint8Array(4*r-1));const{re:a,im:u}=H.reim(o),{re:l,im:d}=H.reim(c);return z(pe(u,r),pe(a,r),pe(d,r),pe(l,r))}}function zs(t){t.assertValidity();const{BYTES:e}=P;if(t.is0())return z(Cs,pe(xe,e));const{x:n,y:r}=t.toAffine(),{re:s,im:i}=H.reim(n),{re:o,im:c}=H.reim(r),u=!!((c>xe?c*Le:o*Le)/P.ORDER&ds),l=s;return z(qr(pe(i,e),{sort:u,compressed:!0}),pe(l,e))}function sd(t){const{BYTES:e,ORDER:n}=P,{compressed:r,infinity:s,sort:i,value:o}=Os(t);if(!r&&!s&&i||!r&&s&&i||i&&s&&r)throw new Error("invalid encoding flag: "+(t[0]&224));const c=(a,u,l)=>rt(a.slice(u,l));if(o.length===96&&r){if(s){if(o.reduce((y,b)=>y!==0?b+1:b,0)>0)throw new Error("invalid G2 point: compressed");return{x:H.ZERO,y:H.ZERO}}const a=c(o,0,e),u=c(o,e,2*e),l=H.create({c0:P.create(u),c1:P.create(a)}),d=H.add(H.pow(l,Ss),zi.b);let f=H.sqrt(d);const h=f.c1===xe?f.c0*Le/n:f.c1*Le/n?ds:xe;return f=i&&h>0?f:H.neg(f),{x:l,y:f}}else if(o.length===192&&!r){if(s){if(o.reduce((f,h)=>f!==0?h+1:h,0)>0)throw new Error("invalid G2 point: uncompressed");return{x:H.ZERO,y:H.ZERO}}const a=c(o,0*e,1*e),u=c(o,1*e,2*e),l=c(o,2*e,3*e),d=c(o,3*e,4*e);return{x:H.fromBigTuple([u,a]),y:H.fromBigTuple([d,l])}}else throw new Error("invalid G2 point: expected 96/192 bytes")}function Po(t){const{ORDER:e}=P,{infinity:n,sort:r,value:s}=Os(Ie("signatureHex",t)),i=$s.G2.Point,o=s.length/2;if(o!==48&&o!==96)throw new Error("invalid compressed signature length, expected 96/192 bytes");const c=rt(s.slice(0,o)),a=rt(s.slice(o));if(n)return i.ZERO;const u=P.create(c&on(P.BITS)),l=P.create(a),d=H.create({c0:l,c1:u}),f=H.add(H.pow(d,Ss),zi.b);let h=H.sqrt(f);if(!h)throw new Error("Failed to find a square root");const{re:y,im:b}=H.reim(h),g=BigInt(r),p=b>xe&&b*Le/e!==g,_=b===xe&&y*Le/e!==g;(p||_)&&(h=H.neg(h));const m=i.fromAffine({x:d,y:h});return m.assertValidity(),m}const $s=Gu({fields:{Fp:P,Fp2:H,Fp6:Ju,Fp12:Z,Fr:Qu},G1:{...nn,Fp:P,htfDefaults:{...Ks,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const n=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),r=new t(P.mul(e.X,n),e.Y,e.Z);return e.multiplyUnsafe(It).negate().multiplyUnsafe(It).equals(r)},clearCofactor:(t,e)=>e.multiplyUnsafe(It).add(e),mapToCurve:fd,fromBytes:nd,toBytes:td,ShortSignature:{fromBytes(t){return Pe(t),Mo(t)},fromHex(t){return Mo(t)},toBytes(t){return Ys(t)},toRawBytes(t){return Ys(t)},toHex(t){return J(Ys(t))}}},G2:{...zi,Fp:H,hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Ks},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:ud,isTorsionFree:(t,e)=>e.multiplyUnsafe(It).negate().equals(qo(t,e)),clearCofactor:(t,e)=>{const n=It;let r=e.multiplyUnsafe(n).negate(),s=qo(t,e),i=e.double();return i=ed(t,i),i=i.subtract(s),s=r.add(s),s=s.multiplyUnsafe(n).negate(),i=i.add(s),i=i.subtract(r),i.subtract(e)},fromBytes:sd,toBytes:rd,Signature:{fromBytes(t){return Pe(t),Po(t)},fromHex(t){return Po(t)},toBytes(t){return zs(t)},toRawBytes(t){return zs(t)},toHex(t){return J(zs(t))}}},params:{ateLoopSize:It,r:nn.n,xNegative:!0,twistType:"multiplicative"},htfDefaults:Ks,hash:Oe}),id=Ec(H,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(t=>t.map(e=>H.fromBigTuple(e.map(BigInt))))),od=Ec(P,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),ad=vc(P,{A:P.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:P.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:P.create(BigInt(11))}),cd=vc(H,{A:H.create({c0:P.create(xe),c1:P.create(BigInt(240))}),B:H.create({c0:P.create(BigInt(1012)),c1:P.create(BigInt(1012))}),Z:H.create({c0:P.create(BigInt(-2)),c1:P.create(BigInt(-1))})});function fd(t){const{x:e,y:n}=ad(P.create(t[0]));return od(e,n)}function ud(t){const{x:e,y:n}=cd(H.fromBigTuple(t));return id(e,n)}function dd(t,e,n){const r=typeof t=="string"?t:J(t),s=typeof e=="string"?e:J(e),i=typeof n=="string"?n:J(n);return $s.verifyShortSignature(s,i,r)}const ld=BigInt(1e6),Ic=t=>le(new Hn(t)),Xi=t=>{const n=Ic(t)/ld;return new Date(Number(n))},Do=60*1e3,hd=60,yd=24,bd=yd*hd,pd=5,md=5,gd=30*bd;var me;(function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"})(me||(me={}));function wd(t,e){for(let n=0;n<t.length;n++)if(t[n]>e[n])return!0;return!1}var Tn,Je;const er=class er{constructor(e,n,r,s,i=pd,o=!1,c){k(this,Tn,!1);k(this,Je,void 0);this._rootKey=n,this._canisterId=r,this._blsVerify=s,this._maxAgeInMinutes=i,D(this,Tn,o),this.cert=nt(e),c&&"getTimeDiffMsecs"in c&&"hasSyncedTime"in c&&"syncTime"in c&&D(this,Je,c)}static async create(e){const n=er.createUnverified(e);return await n.verify(),n}static createUnverified(e){return new er(e.certificate,e.rootKey,e.canisterId,e.blsVerify??dd,e.maxAgeInMinutes,e.disableTimeVerification,e.agent)}lookup_path(e){return Mr(e,this.cert.tree)}lookup_subtree(e){return Wi(e,this.cert.tree)}async verify(){var c,a;const e=await Kr(this.cert.tree),n=await this._checkDelegationAndGetKey(this.cert.delegation),r=this.cert.signature,s=_d(n),i=z(Wn("ic-state-root"),e),o=$e(this.lookup_path(["time"]));if(!o)throw re.fromCode(new _n("Certificate does not contain a time"));if(!E(this,Tn)){const u=((c=E(this,Je))==null?void 0:c.getTimeDiffMsecs())??0,l=this._maxAgeInMinutes*Do,d=new Date,f=d.getTime()+u,h=f-l,y=f+md*Do,b=Xi(o),g=b.getTime()<h,p=b.getTime()>y;if((g||p)&&E(this,Je)&&!E(this,Je).hasSyncedTime())return await E(this,Je).syncTime(this._canisterId),await this.verify();if(g)throw qe.fromCode(new ir(this._maxAgeInMinutes,b,d,u,"past"));if(p)throw(a=E(this,Je))!=null&&a.hasSyncedTime()?Be.fromCode(new Ke("System time has been synced with the IC network, but certificate is still too far in the future.")):qe.fromCode(new ir(5,b,d,u,"future"))}try{if(!await this._blsVerify(s,r,i))throw qe.fromCode(new _n("Invalid signature"))}catch(u){throw qe.fromCode(new _n("Signature verification failed",u))}}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const n=er.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,disableTimeVerification:E(this,Tn),maxAgeInMinutes:gd,agent:E(this,Je)});if(n.cert.delegation)throw re.fromCode(new _i);await n.verify();const r=e.subnet_id,s=X.fromUint8Array(r);if(!Bc({canisterId:this._canisterId,subnetId:s,tree:n.cert.tree}))throw qe.fromCode(new gs(this._canisterId,s));const o=$e(n.lookup_path(["subnet",r,"public_key"]));if(!o)throw qe.fromCode(new Ei(`Could not find subnet key for subnet ID ${s.toText()}`));return o}};Tn=new WeakMap,Je=new WeakMap;let gr=er;const Xn=$r("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),xd=96;function _d(t){const e=Xn.byteLength+xd;if(t.byteLength!==e)throw re.fromCode(new xs(e,t.byteLength));const n=t.slice(0,Xn.byteLength);if(!Bs(n,Xn))throw re.fromCode(new vi(Xn,n));return t.slice(Xn.byteLength)}function $e(t){if(t.status===Me.Found&&t.value instanceof Uint8Array)return t.value}async function Kr(t){switch(t[0]){case me.Empty:return Oe(Wn("ic-hashtree-empty"));case me.Pruned:return t[1];case me.Leaf:return Oe(z(Wn("ic-hashtree-leaf"),t[1]));case me.Labeled:return Oe(z(Wn("ic-hashtree-labeled"),t[1],await Kr(t[2])));case me.Fork:return Oe(z(Wn("ic-hashtree-fork"),await Kr(t[1]),await Kr(t[2])));default:throw En}}function Wn(t){const e=new Uint8Array([t.length]),n=new TextEncoder().encode(t);return z(e,n)}function Ac(t){return typeof t[0]=="string"?ne(t[0]):t[0]}var Me;(function(t){t.Unknown="Unknown",t.Absent="Absent",t.Found="Found",t.Error="Error"})(Me||(Me={}));var Bn;(function(t){t.Absent="Absent",t.Unknown="Unknown",t.Found="Found"})(Bn||(Bn={}));var ee;(function(t){t.Absent="Absent",t.Unknown="Unknown",t.Found="Found",t.Less="Less",t.Greater="Greater"})(ee||(ee={}));function Mr(t,e){if(t.length===0)switch(e[0]){case me.Empty:return{status:Me.Absent};case me.Leaf:{if(!e[1])throw Be.fromCode(new Nr("Invalid tree structure for leaf"));if(e[1]instanceof Uint8Array)return{status:Me.Found,value:e[1].slice(e[1].byteOffset,e[1].byteLength+e[1].byteOffset)};throw En}case me.Pruned:return{status:Me.Unknown};case me.Labeled:case me.Fork:return{status:Me.Error};default:throw En}const n=Ac(t),r=Jn(n,e);switch(r.status){case ee.Found:return Mr(t.slice(1),r.value);case ee.Absent:case ee.Greater:case ee.Less:return{status:Me.Absent};case ee.Unknown:return{status:Me.Unknown};default:throw En}}function Wi(t,e){if(t.length===0)return{status:Bn.Found,value:e};const n=Ac(t),r=Jn(n,e);switch(r.status){case ee.Found:return Wi(t.slice(1),r.value);case ee.Unknown:return{status:Bn.Unknown};case ee.Absent:case ee.Greater:case ee.Less:return{status:Bn.Absent};default:throw En}}function li(t){switch(t[0]){case me.Empty:return[];case me.Fork:return li(t[1]).concat(li(t[2]));default:return[t]}}function Jn(t,e){switch(e[0]){case me.Labeled:return wd(t,e[1])?{status:ee.Greater}:Bs(t,e[1])?{status:ee.Found,value:e[2]}:{status:ee.Less};case me.Fork:{const n=Jn(t,e[1]);switch(n.status){case ee.Greater:{const r=Jn(t,e[2]);return r.status===ee.Less?{status:ee.Absent}:r}case ee.Unknown:{const r=Jn(t,e[2]);return r.status===ee.Less?{status:ee.Unknown}:r}default:return n}}case me.Pruned:return{status:ee.Unknown};default:return{status:ee.Absent}}}function Bc(t){const{canisterId:e,subnetId:n,tree:r}=t,s=Mr(["subnet",n.toUint8Array(),"canister_ranges"],r);if(s.status!==Me.Found)throw re.fromCode(new Ln(`Could not find canister ranges for subnet ${n.toText()}`,s.status));if(!(s.value instanceof Uint8Array))throw re.fromCode(new ws(`Could not find canister ranges for subnet ${n.toText()}`));return nt(s.value).map(a=>[X.fromUint8Array(a[0]),X.fromUint8Array(a[1])]).some(a=>a[0].ltEq(e)&&a[1].gtEq(e))}const Lo=async t=>{const{agent:e,paths:n,disableCertificateTimeVerification:r=!1}=t,s=X.from(t.canisterId),i=[...new Set(n)],o=new Map,c=i.map((a,u)=>{const l=vd(a,s);return(async()=>{try{if(e.rootKey===null)throw Ae.fromCode(new Fn);const d=e.rootKey,f=await e.readState(s,{paths:[l]}),h=await gr.create({certificate:f.certificate,rootKey:d,canisterId:s,disableTimeVerification:r,agent:e}),y=(p,_)=>{if(_==="subnet"){const m=Ed(f.certificate,s,d);return{path:_,data:m}}else return{path:_,data:$e(p.lookup_path(l))}},{path:b,data:g}=y(h,i[u]);if(!g)console.warn(`Expected to find result for path ${b}, but instead found nothing.`),typeof b=="string"?o.set(b,null):o.set(b.key,null);else switch(b){case"time":{o.set(b,Xi(g));break}case"controllers":{o.set(b,Id(g));break}case"module_hash":{o.set(b,J(g));break}case"subnet":{o.set(b,g);break}case"candid":{o.set(b,new TextDecoder().decode(g));break}default:if(typeof b!="string"&&"key"in b&&"path"in b)switch(b.decodeStrategy){case"raw":o.set(b.key,g);break;case"leb128":{o.set(b.key,Ic(g));break}case"cbor":{o.set(b.key,nt(g));break}case"hex":{o.set(b.key,J(g));break}case"utf-8":o.set(b.key,new TextDecoder().decode(g))}}}catch(d){if(d instanceof ut&&(d.hasCode(_n)||d.hasCode(ir)))throw d;typeof a!="string"&&"key"in a&&"path"in a?o.set(a.key,null):o.set(a,null),console.group(),console.warn(`Expected to find result for path ${a}, but instead found nothing.`),console.warn(d),console.groupEnd()}})()});return await Promise.all(c),o},Ed=(t,e,n)=>{if(!e._isPrincipal)throw Q.fromCode(new Ke("Invalid canisterId"));const r=nt(t),s=r.tree;let i=r.delegation,o;if(i&&i.subnet_id?o=X.fromUint8Array(new Uint8Array(i.subnet_id)):!i&&typeof n<"u"?(o=X.selfAuthenticating(new Uint8Array(n)),i={subnet_id:o.toUint8Array(),certificate:new Uint8Array(0)}):(o=X.selfAuthenticating(X.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),i={subnet_id:o.toUint8Array(),certificate:new Uint8Array(0)}),!Bc({canisterId:e,subnetId:o,tree:s}))throw qe.fromCode(new gs(e,o));const a=Wi(["subnet",i.subnet_id,"node"],s);if(a.status!==Bn.Found)throw re.fromCode(new Ln("Node not found",a.status));if(a.value instanceof Uint8Array)throw Be.fromCode(new Nr("Invalid node tree"));const u=li(a.value),l=new Map;return u.forEach(d=>{const f=X.from(d[1]).toText(),h=Mr(["public_key"],d[2]);if(h.status!==Me.Found)throw re.fromCode(new Ln("Public key not found",h.status));const y=h.value;if(y.byteLength!==44)throw re.fromCode(new xs(44,y.byteLength));l.set(f,y)}),{subnetId:X.fromUint8Array(new Uint8Array(i.subnet_id)).toText(),nodeKeys:l}},vd=(t,e)=>{const n=e.toUint8Array();switch(t){case"time":return[ne("time")];case"controllers":return[ne("canister"),n,ne("controllers")];case"module_hash":return[ne("canister"),n,ne("module_hash")];case"subnet":return[ne("subnet")];case"candid":return[ne("canister"),n,ne("metadata"),ne("candid:service")];default:if("key"in t&&"path"in t)if(typeof t.path=="string"||t.path instanceof Uint8Array){const r=t.path,s=typeof r=="string"?ne(r):r;return[ne("canister"),n,ne("metadata"),s]}else return t.path}throw Be.fromCode(new Ke(`Error while encoding your path for canister status. Please ensure that your path ${t} was formatted correctly.`))},Id=t=>nt(t).map(n=>X.fromUint8Array(n));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _t=BigInt(0),de=BigInt(1),Xs=BigInt(2),Ad=BigInt(8);function Bd(t,e,n,r){const s=t.sqr(n),i=t.sqr(r),o=t.add(t.mul(e.a,s),i),c=t.add(t.ONE,t.mul(e.d,t.mul(s,i)));return t.eql(o,c)}function Td(t,e={}){const n=xc("edwards",t,e,e.FpFnLE),{Fp:r,Fn:s}=n;let i=n.CURVE;const{h:o}=i;Ur(e,{},{uvRatio:"function"});const c=Xs<<BigInt(s.BYTES*8)-de,a=g=>r.create(g),u=e.uvRatio||((g,p)=>{try{return{isValid:!0,value:r.sqrt(r.div(g,p))}}catch{return{isValid:!1,value:_t}}});if(!Bd(r,i,i.Gx,i.Gy))throw new Error("bad curve params: generator point");function l(g,p,_=!1){const m=_?de:_t;return Eo("coordinate "+g,p,m,c),p}function d(g){if(!(g instanceof y))throw new Error("ExtendedPoint expected")}const f=br((g,p)=>{const{X:_,Y:m,Z:v}=g,A=g.is0();p==null&&(p=A?Ad:r.inv(v));const T=a(_*p),S=a(m*p),R=r.mul(v,p);if(A)return{x:_t,y:de};if(R!==de)throw new Error("invZ was invalid");return{x:T,y:S}}),h=br(g=>{const{a:p,d:_}=i;if(g.is0())throw new Error("bad point: ZERO");const{X:m,Y:v,Z:A,T}=g,S=a(m*m),R=a(v*v),w=a(A*A),B=a(w*w),U=a(S*p),C=a(w*a(U+R)),x=a(B+a(_*a(S*R)));if(C!==x)throw new Error("bad point: equation left != right (1)");const I=a(m*v),$=a(A*T);if(I!==$)throw new Error("bad point: equation left != right (2)");return!0});class y{constructor(p,_,m,v){this.X=l("x",p),this.Y=l("y",_),this.Z=l("z",m,!0),this.T=l("t",v),Object.freeze(this)}static CURVE(){return i}static fromAffine(p){if(p instanceof y)throw new Error("extended point not allowed");const{x:_,y:m}=p||{};return l("x",_),l("y",m),new y(_,m,de,a(_*m))}static fromBytes(p,_=!1){const m=r.BYTES,{a:v,d:A}=i;p=_o(An(p,m,"point")),lr(_,"zip215");const T=_o(p),S=p[m-1];T[m-1]=S&-129;const R=hr(T),w=_?c:r.ORDER;Eo("point.y",R,_t,w);const B=a(R*R),U=a(B-de),C=a(A*B-v);let{isValid:x,value:I}=u(U,C);if(!x)throw new Error("bad point: invalid y coordinate");const $=(I&de)===de,M=(S&128)!==0;if(!_&&I===_t&&M)throw new Error("bad point: x=0 and x_0=1");return M!==$&&(I=a(-I)),y.fromAffine({x:I,y:R})}static fromHex(p,_=!1){return y.fromBytes(Ie("point",p),_)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(p=8,_=!0){return b.createCache(this,p),_||this.multiply(Xs),this}assertValidity(){h(this)}equals(p){d(p);const{X:_,Y:m,Z:v}=this,{X:A,Y:T,Z:S}=p,R=a(_*S),w=a(A*v),B=a(m*S),U=a(T*v);return R===w&&B===U}is0(){return this.equals(y.ZERO)}negate(){return new y(a(-this.X),this.Y,this.Z,a(-this.T))}double(){const{a:p}=i,{X:_,Y:m,Z:v}=this,A=a(_*_),T=a(m*m),S=a(Xs*a(v*v)),R=a(p*A),w=_+m,B=a(a(w*w)-A-T),U=R+T,C=U-S,x=R-T,I=a(B*C),$=a(U*x),M=a(B*x),F=a(C*U);return new y(I,$,F,M)}add(p){d(p);const{a:_,d:m}=i,{X:v,Y:A,Z:T,T:S}=this,{X:R,Y:w,Z:B,T:U}=p,C=a(v*R),x=a(A*w),I=a(S*m*U),$=a(T*B),M=a((v+A)*(R+w)-C-x),F=$-I,O=$+I,N=a(x-_*C),q=a(M*F),L=a(O*N),V=a(M*N),ye=a(F*O);return new y(q,L,ye,V)}subtract(p){return this.add(p.negate())}multiply(p){if(!s.isValidNot0(p))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:_,f:m}=b.cached(this,p,v=>dt(y,v));return dt(y,[_,m])[0]}multiplyUnsafe(p,_=y.ZERO){if(!s.isValid(p))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return p===_t?y.ZERO:this.is0()||p===de?this:b.unsafe(this,p,m=>dt(y,m),_)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}isTorsionFree(){return b.unsafe(this,i.n).is0()}toAffine(p){return f(this,p)}clearCofactor(){return o===de?this:this.multiplyUnsafe(o)}toBytes(){const{x:p,y:_}=this.toAffine(),m=r.toBytes(_);return m[m.length-1]|=p&de?128:0,m}toHex(){return J(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(p){return dt(y,p)}static msm(p,_){return wc(y,s,p,_)}_setWindowSize(p){this.precompute(p)}toRawBytes(){return this.toBytes()}}y.BASE=new y(i.Gx,i.Gy,de,a(i.Gx*i.Gy)),y.ZERO=new y(_t,de,de,_t),y.Fp=r,y.Fn=s;const b=new gc(y,s.BITS);return y.BASE.precompute(8),y}function Sd(t,e,n={}){if(typeof e!="function")throw new Error('"hash" function param is required');Ur(n,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r}=n,{BASE:s,Fp:i,Fn:o}=t,c=n.randomBytes||ca,a=n.adjustScalarBytes||(w=>w),u=n.domain||((w,B,U)=>{if(lr(U,"phflag"),B.length||U)throw new Error("Contexts/pre-hash are not supported");return w});function l(w){return o.create(hr(w))}function d(w){const B=m.secretKey;w=Ie("private key",w,B);const U=Ie("hashed private key",e(w),2*B),C=a(U.slice(0,B)),x=U.slice(B,2*B),I=l(C);return{head:C,prefix:x,scalar:I}}function f(w){const{head:B,prefix:U,scalar:C}=d(w),x=s.multiply(C),I=x.toBytes();return{head:B,prefix:U,scalar:C,point:x,pointBytes:I}}function h(w){return f(w).pointBytes}function y(w=Uint8Array.of(),...B){const U=z(...B);return l(e(u(U,Ie("context",w),!!r)))}function b(w,B,U={}){w=Ie("message",w),r&&(w=r(w));const{prefix:C,scalar:x,pointBytes:I}=f(B),$=y(U.context,C,w),M=s.multiply($).toBytes(),F=y(U.context,M,I,w),O=o.create($+F*x);if(!o.isValid(O))throw new Error("sign failed: invalid s");const N=z(M,o.toBytes(O));return An(N,m.signature,"result")}const g={zip215:!0};function p(w,B,U,C=g){const{context:x,zip215:I}=C,$=m.signature;w=Ie("signature",w,$),B=Ie("message",B),U=Ie("publicKey",U,m.publicKey),I!==void 0&&lr(I,"zip215"),r&&(B=r(B));const M=$/2,F=w.subarray(0,M),O=hr(w.subarray(M,$));let N,q,L;try{N=t.fromBytes(U,I),q=t.fromBytes(F,I),L=s.multiplyUnsafe(O)}catch{return!1}if(!I&&N.isSmallOrder())return!1;const V=y(x,q.toBytes(),N.toBytes(),B);return q.add(N.multiplyUnsafe(V)).subtract(L).clearCofactor().is0()}const _=i.BYTES,m={secretKey:_,publicKey:_,signature:2*_,seed:_};function v(w=c(m.seed)){return An(w,m.seed,"seed")}function A(w){const B=R.randomSecretKey(w);return{secretKey:B,publicKey:h(B)}}function T(w){return Or(w)&&w.length===o.BYTES}function S(w,B){try{return!!t.fromBytes(w,B)}catch{return!1}}const R={getExtendedPublicKey:f,randomSecretKey:v,isValidSecretKey:T,isValidPublicKey:S,toMontgomery(w){const{y:B}=t.fromBytes(w),U=m.publicKey,C=U===32;if(!C&&U!==57)throw new Error("only defined for 25519 and 448");const x=C?i.div(de+B,de-B):i.div(B-de,B+de);return i.toBytes(x)},toMontgomerySecret(w){const B=m.secretKey;An(w,B);const U=e(w.subarray(0,B));return a(U).subarray(0,B)},randomPrivateKey:v,precompute(w=8,B=t.BASE){return B.precompute(w,!1)}};return Object.freeze({keygen:A,getPublicKey:h,sign:b,verify:p,utils:R,Point:t,lengths:m})}function Cd(t){const e={a:t.a,d:t.d,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp,r=Lt(e.n,t.nBitLength,!0),s={Fp:n,Fn:r,uvRatio:t.uvRatio},i={randomBytes:t.randomBytes,adjustScalarBytes:t.adjustScalarBytes,domain:t.domain,prehash:t.prehash,mapToCurve:t.mapToCurve};return{CURVE:e,curveOpts:s,hash:t.hash,eddsaOpts:i}}function Od(t,e){const n=e.Point;return Object.assign({},e,{ExtendedPoint:n,CURVE:t,nBitLength:n.Fn.BITS,nByteLength:n.Fn.BYTES})}function $d(t){const{CURVE:e,curveOpts:n,hash:r,eddsaOpts:s}=Cd(t),i=Td(e,n),o=Sd(i,r,s);return Od(t,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Nd=BigInt(1),Vo=BigInt(2);BigInt(3);const Rd=BigInt(5),Ud=BigInt(8),Qi=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Tc=(()=>({p:Qi,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Ud,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")}))();function qd(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=Qi,c=t*t%i*t%i,a=Qe(c,Vo,i)*c%i,u=Qe(a,Nd,i)*t%i,l=Qe(u,Rd,i)*u%i,d=Qe(l,e,i)*l%i,f=Qe(d,n,i)*d%i,h=Qe(f,r,i)*f%i,y=Qe(h,s,i)*h%i,b=Qe(y,s,i)*h%i,g=Qe(b,e,i)*l%i;return{pow_p_5_8:Qe(g,Vo,i)*t%i,b2:c}}function Md(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const ko=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Pd(t,e){const n=Qi,r=se(e*e*e,n),s=se(r*r*e,n),i=qd(t*s).pow_p_5_8;let o=se(t*r*i,n);const c=se(e*o*o,n),a=o,u=se(o*ko,n),l=c===t,d=c===se(-t,n),f=c===se(-t*ko,n);return l&&(o=a),(d||f)&&(o=u),Eu(o,n)&&(o=se(-o,n)),{isValid:l||d,value:o}}const Dd=(()=>Lt(Tc.p,{isLE:!0}))(),Ld=(()=>({...Tc,Fp:Dd,hash:Ef,adjustScalarBytes:Md,uvRatio:Pd}))(),Vd=(()=>$d(Ld))();var jo,Fo,be,Sn;class kd{constructor(e={}){k(this,be,void 0);k(this,Sn,void 0);this[jo]=this.entries.bind(this),this[Fo]="ExpirableMap";const{source:n=[],expirationTime:r=10*60*1e3}=e,s=Date.now();D(this,be,new Map([...n].map(([i,o])=>[i,{value:o,timestamp:s}]))),D(this,Sn,r)}prune(){const e=Date.now();for(const[n,r]of E(this,be).entries())e-r.timestamp>E(this,Sn)&&E(this,be).delete(n);return this}set(e,n){this.prune();const r={value:n,timestamp:Date.now()};return E(this,be).set(e,r),this}get(e){const n=E(this,be).get(e);if(n!==void 0){if(Date.now()-n.timestamp>E(this,Sn)){E(this,be).delete(e);return}return n.value}}clear(){E(this,be).clear()}entries(){const e=E(this,be).entries();return function*(){for(const[r,s]of e)yield[r,s.value]}()}values(){const e=E(this,be).values();return function*(){for(const r of e)yield r.value}()}keys(){return E(this,be).keys()}forEach(e,n){for(const[r,s]of E(this,be).entries())e.call(n,s.value,r,this)}has(e){return E(this,be).has(e)}delete(e){return E(this,be).delete(e)}get size(){return E(this,be).size}}be=new WeakMap,Sn=new WeakMap,jo=Symbol.iterator,Fo=Symbol.toStringTag;const Ho=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw Q.fromCode(new _s("Length too long (> 4 bytes)"))},Go=(t,e,n)=>{if(n<=127)return t[e]=n,1;if(n<=255)return t[e]=129,t[e+1]=n,2;if(n<=65535)return t[e]=130,t[e+1]=n>>8,t[e+2]=n,3;if(n<=16777215)return t[e]=131,t[e+1]=n>>16,t[e+2]=n>>8,t[e+3]=n,4;throw Q.fromCode(new _s("Length too long (> 4 bytes)"))},hi=(t,e)=>{if(t[e]<128)return 1;if(t[e]===128)throw Q.fromCode(new yt("Invalid length 0"));if(t[e]===129)return 2;if(t[e]===130)return 3;if(t[e]===131)return 4;throw Q.fromCode(new yt("Length too long (> 4 bytes)"))},jd=(t,e)=>{const n=hi(t,e);if(n===1)return t[e];if(n===2)return t[e+1];if(n===3)return(t[e+1]<<8)+t[e+2];if(n===4)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw Q.fromCode(new yt("Length too long (> 4 bytes)"))};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Zo=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);Uint8Array.from([48,29,6,13,43,6,1,4,1,130,220,124,5,3,1,2,1,6,12,43,6,1,4,1,130,220,124,5,3,2,1]);function Fd(t,e){const n=2+Ho(t.byteLength+1),r=e.byteLength+n+t.byteLength;let s=0;const i=new Uint8Array(1+Ho(r)+r);return i[s++]=48,s+=Go(i,s,r),i.set(e,s),s+=e.byteLength,i[s++]=3,s+=Go(i,s,t.byteLength+1),i[s++]=0,i.set(new Uint8Array(t),s),i}const Hd=(t,e)=>{let n=0;const r=(c,a)=>{if(s[n++]!==c)throw Q.fromCode(new yt(`Expected ${a} at offset ${n}`))},s=new Uint8Array(t);if(r(48,"sequence"),n+=hi(s,n),!Bs(s.slice(n,n+e.byteLength),e))throw Q.fromCode(new yt("Not the expected OID."));n+=e.byteLength,r(3,"bit string");const i=jd(s,n)-1;n+=hi(s,n),r(0,"0 padding");const o=s.slice(n);if(i!==o.length)throw Q.fromCode(new Ii(i,o.length));return o};var xr,_r;const jt=class jt{constructor(e){k(this,xr,void 0);k(this,_r,void 0);if(e.byteLength!==jt.RAW_KEY_LENGTH)throw Q.fromCode(new yt("An Ed25519 public key must be exactly 32 bytes long"));D(this,xr,e),D(this,_r,jt.derEncode(e))}static from(e){return this.fromDer(e.toDer())}static fromRaw(e){return new jt(e)}static fromDer(e){return new jt(this.derDecode(e))}static derEncode(e){return Fd(e,Zo)}static derDecode(e){const n=Hd(e,Zo);if(n.length!==this.RAW_KEY_LENGTH)throw Q.fromCode(new yt("An Ed25519 public key must be exactly 32 bytes long"));return n}get rawKey(){return E(this,xr)}get derKey(){return E(this,_r)}toDer(){return this.derKey}toRaw(){return this.rawKey}};xr=new WeakMap,_r=new WeakMap,jt.RAW_KEY_LENGTH=32;let yi=jt;class Gd{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(n=>n!==e)}notify(e,...n){this.observers.forEach(r=>r(e,...n))}}class Zd extends Gd{constructor(){super()}print(e,...n){this.notify({message:e,level:"info"},...n)}warn(e,...n){this.notify({message:e,level:"warn"},...n)}error(e,n,...r){this.notify({message:e,level:"error",error:n},...r)}}const Ko=.5,Yo=1.5,zo=500,Xo=6e4,Wo=9e5,Qo=10;var He,Er,vr,Ir,Ar,Br,Tr,Sr,Cn;const hs=class hs{constructor(e=hs.default){k(this,He,void 0);k(this,Er,void 0);k(this,vr,void 0);k(this,Ir,void 0);k(this,Ar,void 0);k(this,Br,void 0);k(this,Tr,void 0);k(this,Sr,void 0);k(this,Cn,0);const{initialInterval:n=zo,randomizationFactor:r=Ko,multiplier:s=Yo,maxInterval:i=Xo,maxElapsedTime:o=Wo,maxIterations:c=Qo,date:a=Date}=e;D(this,He,n),D(this,Er,r),D(this,vr,s),D(this,Ir,i),D(this,Sr,a),D(this,Ar,a.now()),D(this,Br,o),D(this,Tr,c)}get ellapsedTimeInMsec(){return E(this,Sr).now()-E(this,Ar)}get currentInterval(){return E(this,He)}get count(){return E(this,Cn)}get randomValueFromInterval(){const e=E(this,Er)*E(this,He),n=E(this,He)-e,r=E(this,He)+e;return Math.random()*(r-n)+n}incrementCurrentInterval(){return D(this,He,Math.min(E(this,He)*E(this,vr),E(this,Ir))),to(this,Cn)._++,E(this,He)}next(){return this.ellapsedTimeInMsec>=E(this,Br)||E(this,Cn)>=E(this,Tr)?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}};He=new WeakMap,Er=new WeakMap,vr=new WeakMap,Ir=new WeakMap,Ar=new WeakMap,Br=new WeakMap,Tr=new WeakMap,Sr=new WeakMap,Cn=new WeakMap,hs.default={initialInterval:zo,randomizationFactor:Ko,multiplier:Yo,maxInterval:Xo,maxElapsedTime:Wo,maxIterations:Qo,date:Date};let bi=hs;var ct;(function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"})(ct||(ct={}));const pi=60*1e3,Kd=1e6,Yd=0,zd="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",Xd="ic0.app",Wd=".ic0.app",Qd="icp0.io",Jd=".icp0.io",el="icp-api.io",tl=".icp-api.io",Ws=200,nl=202,rl=404;function sl(){let t;if(typeof window<"u")if(window.fetch)t=window.fetch.bind(window);else throw Ae.fromCode(new Qn("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present."));else if(typeof global<"u")if(global.fetch)t=global.fetch.bind(global);else throw Ae.fromCode(new Qn("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available."));else typeof self<"u"&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw Ae.fromCode(new Qn("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context."))}function il(t){let e;if(t!==void 0)!t.match(/^[a-z]+:/)&&typeof window<"u"?e=new URL(window.location.protocol+"//"+t):e=new URL(t);else{const n=["ic0.app","icp0.io","127.0.0.1","localhost"],r=[".github.dev",".gitpod.io"],s=typeof window<"u"?window.location:void 0,i=s==null?void 0:s.hostname;let o;i&&typeof i=="string"&&(r.some(c=>i.endsWith(c))?o=i:o=n.find(c=>i.endsWith(c))),s&&o?e=new URL(`${s.protocol}//${o}${s.port?":"+s.port:""}`):e=new URL("https://icp-api.io")}return e.toString()}var Bt,Tt,Ge,Yt,St,On,Ne,et,zt,$n,Re,ft,Ct,tt,ys,Sc,Ot,$t,Nt,Rt,Nn,Yr,Ut,yn,Rn,qt,bn,Un,zr,bs,Cc;const wn=class wn{constructor(e={}){k(this,ys);k(this,Nn);k(this,Ut);k(this,qt);k(this,Un);k(this,bs);k(this,Bt,void 0);k(this,Tt,void 0);k(this,Ge,void 0);k(this,Yt,void 0);k(this,St,void 0);k(this,On,void 0);k(this,Ne,void 0);k(this,et,void 0);k(this,zt,void 0);k(this,$n,void 0);k(this,Re,void 0);k(this,ft,void 0);k(this,Ct,void 0);k(this,tt,void 0);k(this,Ot,void 0);k(this,$t,void 0);k(this,Nt,void 0);k(this,Rt,void 0);k(this,Rn,void 0);D(this,Bt,null),D(this,Tt,!1),D(this,Ge,Yd),D(this,Yt,!1),D(this,St,null),D(this,On,!1),this._isAgent=!0,this.config={},this.log=new Zd,D(this,Ot,[]),D(this,$t,[]),D(this,Nt,new kd({expirationTime:5*pi})),D(this,Rt,!0),D(this,Rn,(s,i)=>{if(E(this,Rt)===!1)return s;const{status:o,signatures:c=[],requestId:a}=s;for(const u of c){const{timestamp:l,identity:d}=u,f=X.fromUint8Array(d).toText();let h;if(o===Pn.Replied){const{reply:_}=s;h=os({status:o,reply:_,timestamp:BigInt(l),request_id:a})}else if(o===Pn.Rejected){const{reject_code:_,reject_message:m,error_code:v}=s;h=os({status:o,reject_code:_,reject_message:m,error_code:v,timestamp:BigInt(l),request_id:a})}else throw Be.fromCode(new Ke(`Unknown status: ${o}`));const y=z(qf,h),b=i.nodeKeys.get(f);if(!b)throw re.fromCode(new qi);const g=yi.fromDer(b).rawKey;if(Vd.verify(u.signature,y,g))return s;throw qe.fromCode(new Mi(f))}return s}),this.config=e,D(this,et,e.fetch||sl()||fetch.bind(global)),D(this,zt,e.fetchOptions),D(this,$n,e.callOptions),D(this,Tt,e.shouldFetchRootKey??!1),D(this,On,e.shouldSyncTime??!1),e.rootKey?this.rootKey=e.rootKey:E(this,Tt)?this.rootKey=null:this.rootKey=$r(zd);const n=il(e.host);this.host=new URL(n),e.verifyQuerySignatures!==void 0&&D(this,Rt,e.verifyQuerySignatures),D(this,ft,e.retryTimes??3);const r=()=>new bi({maxIterations:E(this,ft)});if(D(this,Ct,e.backoffStrategy||r),this.host.hostname.endsWith(Wd)?this.host.hostname=Xd:this.host.hostname.endsWith(Jd)?this.host.hostname=Qd:this.host.hostname.endsWith(tl)&&(this.host.hostname=el),e.credentials){const{name:s,password:i}=e.credentials;D(this,Re,`${s}${i?":"+i:""}`)}if(D(this,Ne,Promise.resolve(e.identity||new go)),e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes>5)throw Q.fromCode(new pn("The maximum ingress expiry time is 5 minutes.",e.ingressExpiryInMinutes));if(e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes<=0)throw Q.fromCode(new pn("Ingress expiry time must be greater than 0.",e.ingressExpiryInMinutes));D(this,tt,e.ingressExpiryInMinutes||5),this.addTransform("update",xo(ci)),e.useQueryNonces&&this.addTransform("query",xo(ci)),e.logToConsole&&this.log.subscribe(s=>{s.level==="error"?console.error(s.message):s.level==="warn"?console.warn(s.message):console.log(s.message)})}static createSync(e={}){return new this({...e})}static async create(e={}){var r;const n=wn.createSync(e);return await oe(r=n,qt,bn).call(r),n}static async from(e){try{return"config"in e?await wn.create(e.config):await wn.create({fetch:e._fetch,fetchOptions:e._fetchOptions,callOptions:e._callOptions,host:e._host.toString(),identity:e._identity??void 0})}catch{throw Q.fromCode(new Ni)}}isLocal(){const e=this.host.hostname;return e==="127.0.0.1"||e.endsWith("127.0.0.1")}addTransform(e,n,r=n.priority||0){if(e==="update"){const s=E(this,$t).findIndex(i=>(i.priority||0)<r);E(this,$t).splice(s>=0?s:E(this,$t).length,0,Object.assign(n,{priority:r}))}else if(e==="query"){const s=E(this,Ot).findIndex(i=>(i.priority||0)<r);E(this,Ot).splice(s>=0?s:E(this,Ot).length,0,Object.assign(n,{priority:r}))}}async getPrincipal(){if(!E(this,Ne))throw Ae.fromCode(new kt);return(await E(this,Ne)).getPrincipal()}async call(e,n,r){const s=n.callSync??!0,i=await(r??E(this,Ne));if(!i)throw Ae.fromCode(new kt);const o=X.from(e),c=n.effectiveCanisterId?X.from(n.effectiveCanisterId):o;await oe(this,qt,bn).call(this,c);const a=i.getPrincipal(),u=Qs(E(this,tt),E(this,Ge)),l={request_type:ai.Call,canister_id:o,method_name:n.methodName,arg:n.arg,sender:a,ingress_expiry:u};let d=await this._transform({request:{body:null,method:"POST",headers:{"Content-Type":"application/cbor",...E(this,Re)?{Authorization:"Basic "+btoa(E(this,Re))}:{}}},endpoint:Ht.Call,body:l}),f;n!=null&&n.nonce?f=h(n.nonce):d.body.nonce?f=h(d.body.nonce):f=void 0,l.nonce=f;function h(p){return Object.assign(p,{__nonce__:void 0})}d=await i.transformRequest(d);const y=Ls(d.body),b=E(this,Ct).call(this),g=Ps(l);try{const m=s?()=>(this.log.print(`fetching "/api/v3/canister/${c.toText()}/call" with request:`,d),E(this,et).call(this,""+new URL(`/api/v3/canister/${c.toText()}/call`,this.host),{...E(this,$n),...d.request,body:y})):()=>(this.log.print(`fetching "/api/v2/canister/${c.toText()}/call" with request:`,d),E(this,et).call(this,""+new URL(`/api/v2/canister/${c.toText()}/call`,this.host),{...E(this,$n),...d.request,body:y})),{responseBodyBytes:v,...A}=await oe(this,Ut,yn).call(this,{requestFn:m,backoff:b,tries:0}),T=v.byteLength>0?nt(v):null;return{requestId:g,response:{...A,body:T},requestDetails:l}}catch(p){let _;if(p instanceof ut){if(p.hasCode(es))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(e,{...n,callSync:!1},r);if(p.hasCode(pn)&&!E(this,Yt))return await this.syncTime(o),this.call(o,n,r);p.code.requestContext={requestId:g,senderPubKey:d.body.sender_pubkey,senderSignature:d.body.sender_sig,ingressExpiry:d.body.content.ingress_expiry},_=p}else _=Be.fromCode(new Ke(p));throw this.log.error(`Error while making call: ${_.message}`,_),_}}async query(e,n,r){const s=E(this,Ct).call(this),i=n.effectiveCanisterId?X.from(n.effectiveCanisterId):X.from(e);await oe(this,qt,bn).call(this,i),this.log.print(`ecid ${i.toString()}`),this.log.print(`canisterId ${e.toString()}`);let o;const c=await(r??E(this,Ne));if(!c)throw Ae.fromCode(new kt);const a=X.from(e),u=c.getPrincipal(),l=Qs(E(this,tt),E(this,Ge)),d={request_type:dr.Query,canister_id:a,method_name:n.methodName,arg:n.arg,sender:u,ingress_expiry:l},f=Ps(d);o=await this._transform({request:{method:"POST",headers:{"Content-Type":"application/cbor",...E(this,Re)?{Authorization:"Basic "+btoa(E(this,Re))}:{}}},endpoint:Ht.Query,body:d}),o=await c.transformRequest(o);const h=Ls(o.body),y={canister:a.toText(),ecid:i,transformedRequest:o,body:h,requestId:f,backoff:s,tries:0},b=async()=>{const p=await oe(this,Nn,Yr).call(this,y);return{requestDetails:d,...p}},g=async()=>{const p=E(this,Nt).get(i.toString());if(p)return p;await this.fetchSubnetKeys(i.toString());const _=E(this,Nt).get(i.toString());if(!_)throw qe.fromCode(new Ui);return _};try{if(!E(this,Rt))return await b();const[p,_]=await Promise.all([b(),g()]);try{return E(this,Rn).call(this,p,_)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),E(this,Nt).delete(i.toString());const m=await g();return E(this,Rn).call(this,p,m)}}catch(p){let _;throw p instanceof ut?(p.code.requestContext={requestId:f,senderPubKey:o.body.sender_pubkey,senderSignature:o.body.sender_sig,ingressExpiry:o.body.content.ingress_expiry},_=p):_=Be.fromCode(new Ke(p)),this.log.error(`Error while making query: ${_.message}`,_),_}}async createReadStateRequest(e,n){await oe(this,qt,bn).call(this);const r=await(n??E(this,Ne));if(!r)throw Ae.fromCode(new kt);const s=r.getPrincipal(),i=await this._transform({request:{method:"POST",headers:{"Content-Type":"application/cbor",...E(this,Re)?{Authorization:"Basic "+btoa(E(this,Re))}:{}}},endpoint:Ht.ReadState,body:{request_type:dr.ReadState,paths:e.paths,sender:s,ingress_expiry:Qs(E(this,tt),E(this,Ge))}});return r.transformRequest(i)}async readState(e,n,r,s){await oe(this,Un,zr).call(this);const i=X.from(e);function o(l){for(const d of l.paths){const[f,h]=d,y=new TextEncoder().encode("request_status");if(Bs(f,y))return h}}let c,a;if(s)c=s,a=Ps(c);else{a=o(n);const l=await E(this,Ne);if(!l)throw Ae.fromCode(new kt);c=await this.createReadStateRequest(n,l)}this.log.print(`fetching "/api/v2/canister/${i}/read_state" with request:`,c);const u=E(this,Ct).call(this);try{const{responseBodyBytes:l}=await oe(this,Ut,yn).call(this,{requestFn:()=>E(this,et).call(this,""+new URL(`/api/v2/canister/${i.toString()}/read_state`,this.host),{...E(this,zt),...c.request,body:Ls(c.body)}),backoff:u,tries:0}),d=nt(l);return this.log.print("Read state response:",d),d}catch(l){let d;throw l instanceof ut?(l.code.requestContext={requestId:a,senderPubKey:c.body.sender_pubkey,senderSignature:c.body.sender_sig,ingressExpiry:c.body.content.ingress_expiry},d=l):d=Be.fromCode(new Ke(l)),this.log.error(`Error while making read state: ${d.message}`,d),d}}parseTimeFromResponse(e){let n;if(e.certificate){const r=nt(e.certificate);if(r&&"tree"in r)n=r.tree;else throw re.fromCode(new Nr("Could not decode time from response"));const s=Mr(["time"],n);if(s.status!==Me.Found)throw re.fromCode(new Ln("Time was not found in the response or was not in its expected format.",s.status));if(!(s.value instanceof Uint8Array)&&!ArrayBuffer.isView(s))throw re.fromCode(new ws("Time was not in its expected format."));const i=Xi(s.value);return this.log.print("Time from response:",i),this.log.print("Time from response in milliseconds:",i.getTime()),i.getTime()}else this.log.warn("No certificate found in response");return 0}async syncTime(e){D(this,St,E(this,St)??(async()=>{await oe(this,Un,zr).call(this);const n=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const r=e??X.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),s=wn.createSync({identity:new go,host:this.host.toString(),fetch:E(this,et),retryTimes:0,rootKey:this.rootKey??void 0,shouldSyncTime:!1}),o=(await Promise.all(Array(3).fill(null).map(async()=>{const a=(await Lo({canisterId:r,agent:s,paths:["time"],disableCertificateTimeVerification:!0})).get("time");if(a instanceof Date)return a.getTime()},[]))).reduce((c,a)=>typeof a=="number"&&a>c?a:c,0);o>0&&(D(this,Ge,o-n),D(this,Yt,!0),this.log.notify({message:`Syncing time: offset of ${E(this,Ge)}`,level:"info"}))}catch(r){const s=r instanceof ut?r:Be.fromCode(new Ke(r));throw this.log.error("Caught exception while attempting to sync time",s),s}})()),await E(this,St).finally(()=>{D(this,St,null)})}async status(){const e=E(this,Re)?{Authorization:"Basic "+btoa(E(this,Re))}:{};this.log.print('fetching "/api/v2/status"');const n=E(this,Ct).call(this),{responseBodyBytes:r}=await oe(this,Ut,yn).call(this,{backoff:n,requestFn:()=>E(this,et).call(this,""+new URL("/api/v2/status",this.host),{headers:e,...E(this,zt)}),tries:0});return nt(r)}async fetchRootKey(){return D(this,Bt,E(this,Bt)??(async()=>{const e=await this.status();return this.rootKey=e.root_key,this.rootKey})()),await E(this,Bt).finally(()=>{D(this,Bt,null)})}invalidateIdentity(){D(this,Ne,null)}replaceIdentity(e){D(this,Ne,Promise.resolve(e))}async fetchSubnetKeys(e){const n=X.from(e);await oe(this,qt,bn).call(this,n);const s=(await Lo({canisterId:n,paths:["subnet"],agent:this})).get("subnet");if(s&&typeof s=="object"&&"nodeKeys"in s)return E(this,Nt).set(n.toText(),s),s}_transform(e){let n=Promise.resolve(e);if(e.endpoint===Ht.Call)for(const r of E(this,$t))n=n.then(s=>r(s).then(i=>i||s));else for(const r of E(this,Ot))n=n.then(s=>r(s).then(i=>i||s));return n}getTimeDiffMsecs(){return E(this,Ge)}hasSyncedTime(){return E(this,Yt)}};Bt=new WeakMap,Tt=new WeakMap,Ge=new WeakMap,Yt=new WeakMap,St=new WeakMap,On=new WeakMap,Ne=new WeakMap,et=new WeakMap,zt=new WeakMap,$n=new WeakMap,Re=new WeakMap,ft=new WeakMap,Ct=new WeakMap,tt=new WeakMap,ys=new WeakSet,Sc=function(){return E(this,tt)*pi},Ot=new WeakMap,$t=new WeakMap,Nt=new WeakMap,Rt=new WeakMap,Nn=new WeakSet,Yr=async function(e){var h,y;const{ecid:n,transformedRequest:r,body:s,requestId:i,backoff:o,tries:c}=e,a=c===0?0:o.next();if(this.log.print(`fetching "/api/v2/canister/${n.toString()}/query" with tries:`,{tries:c,backoff:o,delay:a}),a===null)throw Be.fromCode(new or(`Backoff strategy exhausted after ${c} attempts.`,i));a>0&&await new Promise(b=>setTimeout(b,a));let u;try{this.log.print(`fetching "/api/v2/canister/${n.toString()}/query" with request:`,r);const b=await E(this,et).call(this,""+new URL(`/api/v2/canister/${n.toString()}/query`,this.host),{...E(this,zt),...r.request,body:s});if(b.status===Ws)u={...nt(is(await b.arrayBuffer())),httpDetails:{ok:b.ok,status:b.status,statusText:b.statusText,headers:Vs(b.headers)},requestId:i};else throw re.fromCode(new Jr(b.status,b.statusText,Vs(b.headers),await b.text()))}catch(b){if(c<E(this,ft))return this.log.warn(`Caught exception while attempting to make query:
  ${b}
  Retrying query.`),await oe(this,Nn,Yr).call(this,{...e,tries:c+1});throw b instanceof ut?b:Qr.fromCode(new ts(b))}if(!E(this,Rt))return u;const l=(y=(h=u.signatures)==null?void 0:h[0])==null?void 0:y.timestamp;if(!l)throw re.fromCode(new Ri("Timestamp not found in query response. This suggests a malformed or malicious response."));const d=Number(BigInt(l)/BigInt(Kd));if(Date.now()+E(this,Ge)-d>E(this,ys,Sc)){if(c<E(this,ft))return this.log.warn("Timestamp is older than the max ingress expiry. Retrying query.",{requestId:i,signatureTimestampMs:d}),await oe(this,Nn,Yr).call(this,{...e,tries:c+1});throw qe.fromCode(new Ti(E(this,tt),i,c))}return u},Ut=new WeakSet,yn=async function(e){const{requestFn:n,backoff:r,tries:s}=e,i=s===0?0:r.next();if(i===null)throw re.fromCode(new or(`Retry strategy exhausted after ${s} attempts.`));i>0&&await new Promise(l=>setTimeout(l,i));let o,c=new Uint8Array;try{o=await n(),o.status===Ws&&(c=is(await o.clone().arrayBuffer()))}catch(l){if(s<E(this,ft))return this.log.warn(`Caught exception while attempting to make request:
  ${l}
  Retrying request.`),await oe(this,Ut,yn).call(this,{requestFn:n,backoff:r,tries:s+1});throw Qr.fromCode(new ts(l))}const a=Vs(o.headers);if(o.status===Ws||o.status===nl)return{ok:o.ok,status:o.status,statusText:o.statusText,responseBodyBytes:c,headers:a};const u=await o.text();if(o.status===rl&&o.url.includes("api/v3"))throw re.fromCode(new es);if(u.startsWith("Invalid request expiry: "))throw Q.fromCode(new pn(u,E(this,tt)));if(s<E(this,ft))return await oe(this,Ut,yn).call(this,{requestFn:n,backoff:r,tries:s+1});throw re.fromCode(new Jr(o.status,o.statusText,a,u))},Rn=new WeakMap,qt=new WeakSet,bn=async function(e){await Promise.all([oe(this,Un,zr).call(this),oe(this,bs,Cc).call(this,e)])},Un=new WeakSet,zr=async function(){if(!this.rootKey)if(this.rootKey===null&&this.host.toString()!=="https://icp-api.io"&&E(this,Tt))await this.fetchRootKey();else throw Ae.fromCode(new Fn(E(this,Tt)))},bs=new WeakSet,Cc=async function(e){E(this,On)&&!this.hasSyncedTime()&&await this.syncTime(e)};let wr=wn;function Qs(t,e){const n=t*pi;return In.fromDeltaInMilliseconds(n,e)}const ol=5*60*1e3;function al(){return ll(fl(cl(),1e3),dl(1e3,1.2),ul(ol))}function cl(){let t=!0;return async()=>t?(t=!1,!0):!1}function fl(t,e){return async(n,r,s)=>{if(await t(n,r,s))return new Promise(i=>setTimeout(i,e))}}function ul(t){const e=Date.now()+t;return async(n,r,s)=>{if(Date.now()>e)throw re.fromCode(new or(`Request timed out after ${t} msec`,r,s))}}function dl(t,e){let n=t;return()=>new Promise(r=>setTimeout(()=>{n*=e,r()},n))}function ll(...t){return async(e,n,r)=>{for(const s of t)await s(e,n,r)}}const hl={preSignReadStateRequest:!1};function Oc(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Js(t,e){return t!==null&&typeof t=="object"&&Oc(t,e)}function yl(t,e){return Oc(t,e)&&typeof t[e]=="function"}function Jo(t){return Js(t,"body")&&Js(t.body,"content")&&t.body.content.request_type===dr.ReadState&&Js(t.body.content,"ingress_expiry")&&typeof t.body.content.ingress_expiry=="object"&&t.body.content.ingress_expiry!==null&&yl(t.body.content.ingress_expiry,"toHash")}async function $c(t,e,n,r={}){const s=[ne("request_status"),n];let i,o;if(r.preSignReadStateRequest??!1?(o=await bl({paths:[s],agent:t,pollingOptions:r}),i=await t.readState(e,{paths:[s]},void 0,o)):i=await t.readState(e,{paths:[s]}),t.rootKey==null)throw Ae.fromCode(new Fn);const a=await gr.create({certificate:i.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:r.blsVerify,agent:t}),u=$e(a.lookup_path([...s,ne("status")]));let l;switch(typeof u>"u"?l=ct.Unknown:l=new TextDecoder().decode(u),l){case ct.Replied:return{reply:$e(a.lookup_path([...s,"reply"])),certificate:a};case ct.Received:case ct.Unknown:case ct.Processing:{const d=r.strategy??al();return await d(e,n,l),$c(t,e,n,{...r,strategy:d,request:o})}case ct.Rejected:{const d=new Uint8Array($e(a.lookup_path([...s,"reject_code"])))[0],f=new TextDecoder().decode($e(a.lookup_path([...s,"reject_message"]))),h=$e(a.lookup_path([...s,"error_code"])),y=h?new TextDecoder().decode(h):void 0;throw xn.fromCode(new Es(n,d,f,y))}case ct.Done:throw Be.fromCode(new Oi(n))}throw En}async function bl(t){var i;const{paths:e,agent:n,pollingOptions:r}=t;if(r.request&&Jo(r.request))return r.request;const s=await((i=n.createReadStateRequest)==null?void 0:i.call(n,{paths:e},void 0));if(!Jo(s))throw Q.fromCode(new Pi(s));return s}const Ue=Symbol.for("ic-agent-metadata");class Ji{static agentOf(e){return e[Ue].config.agent}static interfaceOf(e){return e[Ue].service}static canisterIdOf(e){return X.from(e[Ue].config.canisterId)}static createActorClass(e,n){const r=e({IDL:Uf});class s extends Ji{constructor(o){if(!o.canisterId)throw Q.fromCode(new ns(o.canisterId));const c=typeof o.canisterId=="string"?X.fromText(o.canisterId):o.canisterId;super({config:{...Nc,...o,canisterId:c},service:r});for(const[a,u]of r._fields)n!=null&&n.httpDetails&&u.annotations.push(mi),n!=null&&n.certificate&&u.annotations.push(Rc),this[a]=pl(this,a,u,o.blsVerify)}}return s}static createActor(e,n){if(!n.canisterId)throw Q.fromCode(new ns(n.canisterId));return new(this.createActorClass(e))(n)}static createActorWithHttpDetails(e,n){return new(this.createActorClass(e,{httpDetails:!0}))(n)}static createActorWithExtendedDetails(e,n,r={httpDetails:!0,certificate:!0}){return new(this.createActorClass(e,r))(n)}constructor(e){this[Ue]=Object.freeze(e)}}function ln(t,e){const n=_a(t,e);switch(n.length){case 0:return;case 1:return n[0];default:return n}}const Nc={pollingOptions:hl},mi="http-details",Rc="certificate";function pl(t,e,n,r){let s;n.annotations.includes("query")||n.annotations.includes("composite_query")?s=async(o,...c)=>{var h,y;o={...o,...(y=(h=t[Ue].config).queryTransform)==null?void 0:y.call(h,e,c,{...t[Ue].config,...o})};const a=o.agent||t[Ue].config.agent||new wr,u=X.from(o.canisterId||t[Ue].config.canisterId),l=ri(n.argTypes,c),d=await a.query(u,{methodName:e,arg:l,effectiveCanisterId:o.effectiveCanisterId}),f={...d.httpDetails,requestDetails:d.requestDetails};switch(d.status){case Pn.Rejected:{const b=new Si(d.requestId,d.reject_code,d.reject_message,d.error_code,d.signatures);throw b.callContext={canisterId:u,methodName:e,httpDetails:f},xn.fromCode(b)}case Pn.Replied:return n.annotations.includes(mi)?{httpDetails:f,result:ln(n.retTypes,d.reply.arg)}:ln(n.retTypes,d.reply.arg)}}:s=async(o,...c)=>{var S,R;o={...o,...(R=(S=t[Ue].config).callTransform)==null?void 0:R.call(S,e,c,{...t[Ue].config,...o})};const a=o.agent||t[Ue].config.agent||wr.createSync(),{canisterId:u,effectiveCanisterId:l,pollingOptions:d}={...Nc,...t[Ue].config,...o},f=X.from(u),h=l!==void 0?X.from(l):f,y=ri(n.argTypes,c),{requestId:b,response:g,requestDetails:p}=await a.call(f,{methodName:e,arg:y,effectiveCanisterId:h,nonce:o.nonce});let _,m;if(zc(g.body)){if(a.rootKey==null)throw Ae.fromCode(new Fn);const w=g.body.certificate;m=await gr.create({certificate:w,rootKey:a.rootKey,canisterId:h,blsVerify:r,agent:a});const B=[ne("request_status"),b];switch(new TextDecoder().decode($e(m.lookup_path([...B,"status"])))){case"replied":_=$e(m.lookup_path([...B,"reply"]));break;case"rejected":{const C=new Uint8Array($e(m.lookup_path([...B,"reject_code"])))[0],x=new TextDecoder().decode($e(m.lookup_path([...B,"reject_message"]))),I=$e(m.lookup_path([...B,"error_code"])),$=I?new TextDecoder().decode(I):void 0,M=new Es(b,C,x,$);throw M.callContext={canisterId:f,methodName:e,httpDetails:g},xn.fromCode(M)}}}else if(Yc(g.body)){const{reject_code:w,reject_message:B,error_code:U}=g.body,C=new Ci(b,w,B,U);throw C.callContext={canisterId:f,methodName:e,httpDetails:g},xn.fromCode(C)}if(g.status===202){const w={...d,blsVerify:r},B=await $c(a,h,b,w);m=B.certificate,_=B.reply}const v=n.annotations.includes(mi),A=n.annotations.includes(Rc),T={...g,requestDetails:p};if(_!==void 0)return v&&A?{httpDetails:T,certificate:m,result:ln(n.retTypes,_)}:A?{certificate:m,result:ln(n.retTypes,_)}:v?{httpDetails:T,result:ln(n.retTypes,_)}:ln(n.retTypes,_);{const w=new Ke(`Call was returned undefined. We cannot determine if the call was successful or not. Return types: [${n.retTypes.map(B=>B.display()).join(",")}].`);throw w.callContext={canisterId:f,methodName:e,httpDetails:T},Be.fromCode(w)}};const i=(...o)=>s({},...o);return i.withOptions=o=>(...c)=>s(o,...c),i}const ml=({IDL:t})=>t.Service({greet:t.Func([t.Text],[t.Text],["query"])}),gl="uxrrr-q7777-77774-qaaaq-cai",wl=(t,e={})=>{const n=e.agent||new wr({...e.agentOptions});return e.agent&&e.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),n.fetchRootKey().catch(r=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(r)}),Ji.createActor(ml,{agent:n,canisterId:t,...e.actorOptions})},xl=wl(gl),_l="/assets/logo2-037eb7ae.svg";var ps,Cr,gi;class El{constructor(){k(this,Cr);eo(this,"greeting","");k(this,ps,async e=>{e.preventDefault();const n=document.getElementById("name").value;this.greeting=await xl.greet(n),oe(this,Cr,gi).call(this)});oe(this,Cr,gi).call(this)}}ps=new WeakMap,Cr=new WeakSet,gi=function(){let e=Lc`
      <main>
        <img src="${_l}" alt="DFINITY logo" />
        <br />
        <br />
        <form action="#">
          <label for="name">Enter your name: &nbsp;</label>
          <input id="name" alt="Name" type="text" />
          <button type="submit">Click Me!</button>
        </form>
        <section id="greeting">${this.greeting}</section>
      </main>
    `;Kc(e,document.getElementById("root")),document.querySelector("form").addEventListener("submit",E(this,ps))};new El;
